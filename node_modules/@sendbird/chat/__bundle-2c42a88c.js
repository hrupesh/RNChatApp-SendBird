/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function i(e,t,n,r){return new(n||(n=Promise))((function(i,s){function a(e){try{u(r.next(e))}catch(e){s(e)}}function o(e){try{u(r.throw(e))}catch(e){s(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,r=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return a}function u(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var l,c="4.5.0",d=function(){function e(){}return Object.defineProperty(e,"OS_VERSION",{get:function(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.replace(/,/g,"."):"noAgent"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_VERSION",{get:function(){return"4.5.0"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SDK_MAJOR_VERSION",{get:function(){return e.SDK_VERSION.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL",{get:function(){return 100},enumerable:!1,configurable:!0}),Object.defineProperty(e,"INTERNAL_CALL",{get:function(){return"ic"},enumerable:!1,configurable:!0}),e}();!function(e){e[e.NON_AUTHORIZED=400108]="NON_AUTHORIZED",e[e.INVALID_TOKEN=400111]="INVALID_TOKEN",e[e.NOT_FOUND_IN_DATABASE=400201]="NOT_FOUND_IN_DATABASE",e[e.SESSION_TOKEN_EXPIRED=400302]="SESSION_TOKEN_EXPIRED",e[e.SESSION_KEY_EXPIRED=400309]="SESSION_KEY_EXPIRED",e[e.INTERNAL_SERVER_ERROR=500901]="INTERNAL_SERVER_ERROR",e[e.RATE_LIMIT_EXCEEDED=500910]="RATE_LIMIT_EXCEEDED",e[e.UNKNOWN_SERVER_ERROR=900200]="UNKNOWN_SERVER_ERROR",e[e.DEBUG_MODE_REQUIRED=7e5]="DEBUG_MODE_REQUIRED",e[e.LOST_INSTANCE=700100]="LOST_INSTANCE",e[e.CONNECTION_RENEW=700102]="CONNECTION_RENEW",e[e.INVALID_CONNECTION_STATE_TRANSITION=700200]="INVALID_CONNECTION_STATE_TRANSITION",e[e.INVALID_INITIALIZATION=800100]="INVALID_INITIALIZATION",e[e.CONNECTION_REQUIRED=800101]="CONNECTION_REQUIRED",e[e.CONNECTION_CANCELED=800102]="CONNECTION_CANCELED",e[e.INVALID_PARAMETER=800110]="INVALID_PARAMETER",e[e.NOT_SUPPORTED_ERROR=800111]="NOT_SUPPORTED_ERROR",e[e.NETWORK_ERROR=800120]="NETWORK_ERROR",e[e.NETWORK_ROUTING_ERROR=800121]="NETWORK_ROUTING_ERROR",e[e.MALFORMED_DATA=800130]="MALFORMED_DATA",e[e.MALFORMED_ERROR_DATA=800140]="MALFORMED_ERROR_DATA",e[e.WRONG_CHANNEL_TYPE=800150]="WRONG_CHANNEL_TYPE",e[e.MARK_AS_READ_RATE_LIMIT_EXCEEDED=800160]="MARK_AS_READ_RATE_LIMIT_EXCEEDED",e[e.QUERY_IN_PROGRESS=800170]="QUERY_IN_PROGRESS",e[e.ACK_TIMEOUT=800180]="ACK_TIMEOUT",e[e.LOGIN_TIMEOUT=800190]="LOGIN_TIMEOUT",e[e.WEBSOCKET_CONNECTION_CLOSED=800200]="WEBSOCKET_CONNECTION_CLOSED",e[e.WEBSOCKET_CONNECTION_FAILED=800210]="WEBSOCKET_CONNECTION_FAILED",e[e.REQUEST_FAILED=800220]="REQUEST_FAILED",e[e.FILE_UPLOAD_CANCEL_FAILED=800230]="FILE_UPLOAD_CANCEL_FAILED",e[e.REQUEST_CANCELED=800240]="REQUEST_CANCELED",e[e.REQUEST_DUPLICATED=800250]="REQUEST_DUPLICATED",e[e.FILE_SIZE_LIMIT_EXCEEDED=800260]="FILE_SIZE_LIMIT_EXCEEDED",e[e.SESSION_TOKEN_REQUEST_FAILED=800500]="SESSION_TOKEN_REQUEST_FAILED",e[e.SESSION_TOKEN_REFRESHED=800501]="SESSION_TOKEN_REFRESHED",e[e.SESSION_TOKEN_REFRESH_FAILED=800502]="SESSION_TOKEN_REFRESH_FAILED"}(l||(l={}));var h,p=function(e){return!(e instanceof f&&!e.shouldThrowOutside)},f=function(e){function n(t){var r=t.code,i=void 0===r?0:r,s=t.message,a=e.call(this,s)||this;return a.shouldThrowOutside=!1,a.name="SendbirdError",a.code=i,Object.setPrototypeOf(a,n.prototype),a}return t(n,e),Object.defineProperty(n.prototype,"isInvalidTokenError",{get:function(){return this.code===l.INVALID_TOKEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionTokenExpiredError",{get:function(){return this.code===l.SESSION_TOKEN_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isSessionKeyExpiredError",{get:function(){return this.code===l.SESSION_KEY_EXPIRED},enumerable:!1,configurable:!0}),Object.defineProperty(n,"debugModeRequired",{get:function(){return new n({code:l.DEBUG_MODE_REQUIRED,message:"Cannot run this operation in production mode."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"lostInstance",{get:function(){return new n({code:l.LOST_INSTANCE,message:"Instance ID is missing. It should belong to an instance."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRenew",{get:function(){return new n({code:l.CONNECTION_RENEW,message:"Connection restarts."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidConnectionStateTransition",{get:function(){return new n({code:l.INVALID_CONNECTION_STATE_TRANSITION,message:"Invalid connection state transition."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionRequired",{get:function(){return new n({code:l.CONNECTION_REQUIRED,message:"Connection is required."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionCanceled",{get:function(){return new n({code:l.CONNECTION_CANCELED,message:"Connection is canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"invalidParameters",{get:function(){return new n({code:l.INVALID_PARAMETER,message:"Invalid parameters."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"notSupportedError",{get:function(){return new n({code:l.NOT_SUPPORTED_ERROR,message:"Given parameters are not supported."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"networkError",{get:function(){return new n({code:l.NETWORK_ERROR,message:"There was a network error."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"markAsReadAllRateLimitExceeded",{get:function(){return new n({code:l.MARK_AS_READ_RATE_LIMIT_EXCEEDED,message:"markAsRead rate limit exceeded."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"queryInProgress",{get:function(){return new n({code:l.QUERY_IN_PROGRESS,message:"Query in progress."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"noAckTimeout",{get:function(){return new n({code:l.ACK_TIMEOUT,message:"Command received no ack."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"loginTimeout",{get:function(){return new n({code:l.LOGIN_TIMEOUT,message:"Connection timeout."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"connectionClosed",{get:function(){return new n({code:l.WEBSOCKET_CONNECTION_CLOSED,message:"Connection is closed. Please reconnect."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestFailed",{get:function(){return new n({code:l.REQUEST_FAILED,message:"Request failed."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"fileUploadCanceled",{get:function(){return new n({code:l.FILE_UPLOAD_CANCEL_FAILED,message:"File upload has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"requestCanceled",{get:function(){return new n({code:l.REQUEST_CANCELED,message:"Request has been canceled."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRefreshFailed",{get:function(){return new n({code:l.SESSION_TOKEN_REFRESH_FAILED,message:"Failed to refresh the session key."})},enumerable:!1,configurable:!0}),Object.defineProperty(n,"sessionTokenRequestFailed",{get:function(){return new n({code:l.SESSION_TOKEN_REQUEST_FAILED,message:"Failed to get the session token."})},enumerable:!1,configurable:!0}),n.prototype.throwOutside=function(){throw this.shouldThrowOutside=!0,this},n}(Error),_=[l.CONNECTION_REQUIRED,l.NETWORK_ERROR,l.ACK_TIMEOUT,l.WEBSOCKET_CONNECTION_CLOSED,l.WEBSOCKET_CONNECTION_FAILED,l.FILE_UPLOAD_CANCEL_FAILED,l.REQUEST_CANCELED,l.INTERNAL_SERVER_ERROR,l.RATE_LIMIT_EXCEEDED,l.UNKNOWN_SERVER_ERROR],g=[l.WEBSOCKET_CONNECTION_CLOSED,l.WEBSOCKET_CONNECTION_FAILED,l.CONNECTION_REQUIRED],m=function(e,t){if(e!==t){var r=n({},e),i=n({},t);return(!r.hasOwnProperty("messageId")||!i.hasOwnProperty("messageId")||r.messageId===i.messageId)&&((!r.hasOwnProperty("reqId")||!i.hasOwnProperty("reqId")||r.reqId===i.reqId)&&(r.hasOwnProperty("messageId")&&delete r.messageId,r.hasOwnProperty("reqId")&&delete r.reqId,i.hasOwnProperty("messageId")&&delete i.messageId,i.hasOwnProperty("reqId")&&delete i.reqId,JSON.stringify(r)===JSON.stringify(i)))}return!0},v=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||("string"!=typeof e?"object"==typeof e?y(e,t):E(e,t):typeof t===e)},y=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Object.values(e).includes(t)},E=function(e,t){return t instanceof e},b=function(e,t,n){return void 0===n&&(n=!1),!(!n||null!=t)||Array.isArray(t)&&t.every((function(t){return v(e,t)}))},w=function(e){return e>0&&g.indexOf(e)>=0},S=function(e,t){if(void 0===t&&(t=!1),t&&null===e)return!0;var n=v("object",e)&&null!==e&&e.hasOwnProperty("name")&&"string"==typeof e.name&&e.hasOwnProperty("uri")&&"string"==typeof e.uri&&e.hasOwnProperty("type")&&"string"==typeof e.type;if(!n){if("undefined"!=typeof Blob)return e instanceof Blob;if("undefined"!=typeof File)return e instanceof File}return n},T=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=u([],o(e),!1).sort(),r=u([],o(t),!1).sort(),i=0;i<n.length;++i)if(n[i]!==r[i])return!1;return!0},I=function(){function e(e){var t=void 0===e?{}:e,n=t.useMemberInfoInMessage,r=void 0===n||n,i=t.typingIndicatorInvalidateTime,s=void 0===i?1e4:i,a=t.typingIndicatorThrottle,o=void 0===a?1e3:a,u=t.websocketResponseTimeout,l=void 0===u?1e4:u,c=t.websocketPayloadDecompression,d=void 0===c||c,h=t.sessionTokenRefreshTimeout,p=void 0===h?60:h;this._useMemberInfoInMessage=!0,this._typingIndicatorInvalidateTime=1e4,this._typingIndicatorThrottle=1e3,this._websocketResponseTimeout=1e4,this._sessionTokenRefreshTimeout=60,this._useMemberInfoInMessage=r,this._typingIndicatorInvalidateTime=s,this._typingIndicatorThrottle=o,this._websocketResponseTimeout=l,this._sessionTokenRefreshTimeout=p,this.websocketPayloadDecompression=d}return Object.defineProperty(e.prototype,"useMemberInfoInMessage",{get:function(){return this._useMemberInfoInMessage},set:function(e){v("boolean",e)&&(this._useMemberInfoInMessage=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorInvalidateTime",{get:function(){return this._typingIndicatorInvalidateTime},set:function(e){v("number",e)&&(this._typingIndicatorInvalidateTime=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typingIndicatorThrottle",{get:function(){return this._typingIndicatorThrottle},set:function(e){v("number",e)&&e>=1e3&&e<=9e3&&(this._typingIndicatorThrottle=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"websocketResponseTimeout",{get:function(){return this._websocketResponseTimeout},set:function(e){v("number",e)&&e>=5e3&&e<=3e4&&(this._websocketResponseTimeout=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sessionTokenRefreshTimeout",{get:function(){return this._sessionTokenRefreshTimeout},set:function(e){v("number",e)&&(e<60?e=60:e>1800&&(e=1800),this._sessionTokenRefreshTimeout=e)},enumerable:!1,configurable:!0}),e}(),k={encrypt:function(e){return e},decrypt:function(e){return e}},A=function(){function e(e){var t=e.store;this._preference=new Map,this._store=t}return e.prototype._savePreferenceKeys=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._store.set({key:this._keysAddress,value:u([],o(this._preference.keys()),!1),generation:1})];case 1:return e.sent(),[2]}}))}))},e.prototype.init=function(e){var t;return i(this,void 0,void 0,(function(){var n,r,i,o,u,l,c,d;return s(this,(function(s){switch(s.label){case 0:return this._keysAddress=e,[4,this._store.get(e)];case 1:n=null!==(t=s.sent())&&void 0!==t?t:[],s.label=2;case 2:s.trys.push([2,7,8,9]),r=a(n),i=r.next(),s.label=3;case 3:return i.done?[3,6]:(o=i.value,[4,this._store.get(o)]);case 4:(u=s.sent())&&this._preference.set(o,u),s.label=5;case 5:return i=r.next(),[3,3];case 6:return[3,9];case 7:return l=s.sent(),c={error:l},[3,9];case 8:try{i&&!i.done&&(d=r.return)&&d.call(r)}finally{if(c)throw c.error}return[7];case 9:return[2]}}))}))},e.prototype.get=function(e){var t;return i(this,void 0,void 0,(function(){return s(this,(function(n){return[2,null!==(t=this._preference.get(e))&&void 0!==t?t:null]}))}))},e.prototype.set=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=!this._preference.has(e),[4,this._store.set({key:e,value:t,generation:1})];case 1:return r.sent(),this._preference.set(e,t),n?[4,this._savePreferenceKeys()]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._store.remove(e)];case 1:return t.sent(),this._preference.delete(e),[4,this._savePreferenceKeys()];case 2:return t.sent(),[2]}}))}))},e.prototype.clear=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._store.removeMany(u([],o(this._preference.keys()),!1))];case 1:return e.sent(),this._preference.clear(),[4,this._savePreferenceKeys()];case 2:return e.sent(),[2]}}))}))},e}(),N=function(e){var t=e.encryption,n=void 0===t?null:t,r=e.store,i=void 0===r?null:r,s=e.localCacheEnabled,a=void 0===s||s;this.nestdb=null,this.store=i,this.preference=new A({store:i}),this.encryption=null!=n?n:k,this.localCacheEnabled=a},R=function(){function e(){this.sessionKey=null,this.authToken=null}return Object.defineProperty(e.prototype,"hasSession",{get:function(){return!!this.sessionKey},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.authToken=null,this.sessionKey=null},e}(),O=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))},C=function(){function e(e){var t=e.container;this._container={},this._container=t,this.key=O()}return e.prototype._register=function(e,t,n){return e in this._container||(this._container[e]=new Map),this._container[e].set(this.key,{occurence:t,handler:n}),this},e.prototype.on=function(e,t){return this._register(e,-1,t)},e.prototype.once=function(e,t){return this._register(e,1,t)},e.prototype.close=function(){for(var e in this._container)this._container[e].delete(this.key)},e}(),D=function(){function e(){this._container={}}return e.prototype.on=function(e,t){return new C({container:this._container}).on(e,t)},e.prototype.once=function(e,t){return new C({container:this._container}).once(e,t)},e.prototype.dispatch=function(e,t){var n,r,i=this._container[e];if(i){var s=[];try{for(var o=a(i.keys()),u=o.next();!u.done;u=o.next()){var l=u.value,c=i.get(l);c.handler(t),c.occurence>0&&(c.occurence--,0===c.occurence&&s.push(l))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}s.forEach((function(e){return i.delete(e)}))}},e}(),M=function(){function e(){this._dispatcher=new D}return e.prototype.on=function(e){return this._dispatcher.on("event",e)},e.prototype.once=function(e){return this._dispatcher.once("event",e)},e.prototype.dispatch=function(e){this._dispatcher.dispatch("event",e)},e}(),x=function(){},L=function(e){var t={};return e&&Object.keys(e).forEach((function(n){void 0!==e[n]&&NaN!==e[n]&&null!==e[n]&&(t[n]=e[n])})),t};!function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(h||(h={}));var U,P=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.params={},t.requireAuth=!0,t.headers={},t.requestId=O(),t}return t(n,e),n.prototype.stringifyParams=function(e){return"object"!=typeof e||Array.isArray(e)?String(e):e?JSON.stringify(e):""},n.prototype.encodeParams=function(e){var t=this;return null==e||""===e?encodeURIComponent(""):Array.isArray(e)?e.map((function(e){return t.encodeParams(e)})).join(","):"object"==typeof e?encodeURIComponent(JSON.stringify(e)):encodeURIComponent(String(e))},Object.defineProperty(n.prototype,"query",{get:function(){var e=this,t=L(this.params);return"?".concat(Object.keys(t).map((function(n){return"".concat(encodeURIComponent(n),"=").concat(e.encodeParams(t[n]))})).join("&"))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"payload",{get:function(){var e=this,t=L(this.params);if(Object.keys(t).some((function(e){return S(t[e])}))){var n=new FormData;return Object.keys(t).forEach((function(r){var i,s=t[r];if(S(s)){var a=s;n.append(r,a,null!==(i=a.name)&&void 0!==i?i:"filename")}else n.append(r,e.stringifyParams(s))})),n}return JSON.stringify(t)},enumerable:!1,configurable:!0}),n}(x),q=function(e){function r(t,n){var r=e.call(this)||this;return r._iid=t,r._payload=n,r}return t(r,e),Object.defineProperty(r.prototype,"payload",{get:function(){return n({},this._payload)},enumerable:!1,configurable:!0}),r.prototype.as=function(e){return new e(this._iid,this.payload)},r}(x),F=function(e){function n(t){var n=e.call(this)||this;return n.requestId=t,n}return t(n,e),n}(x),z=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(x),G=function(e){function n(t){var n=e.call(this)||this;return n.statLog=t,n}return t(n,e),n}(x);!function(e){e.WEBSOCKET_CONNECT="ws:connect",e.API_RESULT="api:result"}(U||(U={}));var j=function(){function e(e){var t=e.type,n=e.data,r=e.ts,i=void 0===r?Date.now():r;this.type=t,this.createdAt=i,this.data=n}return e.payloadify=function(e){return L({stat_type:e.type,ts:e.createdAt,data:L(e.data)})},e}(),Q=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,a=this;this._abortControl=new Map,this._iid=e,this._auth=n,this._sdkState=r,this._dispatcher=i,this._dispatcher.on((function(e){e instanceof F&&a.cancel(e.requestId)})),this._logger=s}return Object.defineProperty(e.prototype,"_userAgentWithExtension",{get:function(){var e=this._sdkState.extensions,t="undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"==navigator.product?"reactnative":"JS",n=e.sb_syncmanager?"s".concat(e.sb_syncmanager):"",r=e.sb_uikit?"u".concat(e.sb_uikit):"",i=e["device-os-platform"]?"o".concat(e["device-os-platform"]):"";return"".concat(t,"/c").concat(d.SDK_VERSION,"/").concat(n,"/").concat(r,"/").concat(i)},enumerable:!1,configurable:!0}),e.prototype._createHeader=function(e,t){void 0===t&&(t=null);var r=this._sdkState,i=r.appId,s=r.appVersion,a=n(n({},e.headers),{SendBird:"JS,".concat(d.OS_VERSION,",").concat(d.SDK_VERSION,",").concat(i).concat(s?",".concat(s):""),"SB-User-Agent":encodeURIComponent(this._userAgentWithExtension),"Request-Sent-Timestamp":Date.now().toString()});return t||(a["Content-Type"]="application/json; charset=utf-8"),e.requireAuth&&this._auth.hasSession&&(a["Session-Key"]=this._auth.sessionKey),this._auth&&this._auth.authToken&&(a["App-Id"]=i,a["Access-Token"]=this._auth.authToken),a},e.prototype._statLogApiResult=function(e,t,n){this._dispatcher.dispatch(new G(new j({type:U.API_RESULT,data:{endpoint:e.path,method:e.method,success:!n,latency:Date.now()-t,error_code:null==n?void 0:n.code,error_description:null==n?void 0:n.message}})))},e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a,o,u,l,c,d,p,_,g,m,v;return s(this,(function(s){switch(s.label){case 0:t=e.path,n=e.method,r=![h.GET,h.DELETE].includes(n),i=this._sdkState.api,a="".concat(i.host).concat(t).concat(r?"":e.query),o=r?e.payload:null,u=this._createHeader(e,o instanceof FormData?o:null),l=new AbortController,c=l.signal,this._abortControl.set(e.requestId,l),d=Date.now(),s.label=1;case 1:return s.trys.push([1,4,,5]),[4,fetch(a,{method:n,body:o,headers:u,signal:c})];case 2:return[4,(p=s.sent()).json()];case 3:if(_=s.sent(),p.ok||p.redirected)return this._logger.debug("receive api response",e.requestId),this._statLogApiResult(e,d,null),[2,new q(this._iid,_)];throw _?(g=new f(_),!e.requireAuth&&g.isSessionKeyExpiredError&&this._dispatcher.dispatch(new z),this._statLogApiResult(e,d,g),g):(g=f.requestFailed,this._statLogApiResult(e,d,g),g);case 4:throw m=s.sent(),this._statLogApiResult(e,d,m),m instanceof f?(this._logger.debug("fail api request",m),m):"AbortError"===m.name?f.requestCanceled:(v=f.networkError,this._logger.debug("fail api request",v),v);case 5:return[2]}}))}))},e.prototype.cancel=function(e){this._abortControl.has(e)&&(this._abortControl.get(e).abort(),this._abortControl.delete(e))},e.prototype.cancelAll=function(){var e,t;try{for(var n=a(this._abortControl.values()),r=n.next();!r.done;r=n.next()){r.value.abort()}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this._abortControl.clear()},e}(),B=function(e){function n(t,n,r,i){void 0===i&&(i="");var s=e.call(this)||this;return s._iid=t,s.code=n,s.payload=r,s.requestId=r?r.req_id:i,s}return t(n,e),n.createFromRawMessage=function(e,t){var r=t.substring(0,4),i=null;try{i=JSON.parse(t.substring(4))}catch(e){r="NOOP"}finally{return new n(e,r,i)}},n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},n.prototype.as=function(e){return new e(this._iid,this.code,this.payload)},n}(x),K=function(){};function H(e){let t=e.length;for(;--t>=0;)e[t]=0}const Z=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),V=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),W=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),X=new Array(576);H(X);const J=new Array(60);H(J);const $=new Array(512);H($);const ee=new Array(256);H(ee);const te=new Array(29);H(te);const ne=new Array(30);function re(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}let ie,se,ae;function oe(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}H(ne);const ue=e=>e<256?$[e]:$[256+(e>>>7)],le=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},ce=(e,t,n)=>{e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,le(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},de=(e,t,n)=>{ce(e,n[2*t],n[2*t+1])},he=(e,t)=>{let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},pe=(e,t,n)=>{const r=new Array(16);let i,s,a=0;for(i=1;i<=15;i++)a=a+n[i-1]<<1,r[i]=a;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=he(r[t]++,t))}},fe=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},_e=e=>{e.bi_valid>8?le(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},ge=(e,t,n,r)=>{const i=2*t,s=2*n;return e[i]<e[s]||e[i]===e[s]&&r[t]<=r[n]},me=(e,t,n)=>{const r=e.heap[n];let i=n<<1;for(;i<=e.heap_len&&(i<e.heap_len&&ge(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!ge(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r},ve=(e,t,n)=>{let r,i,s,a,o=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+o++],r+=(255&e.pending_buf[e.sym_buf+o++])<<8,i=e.pending_buf[e.sym_buf+o++],0===r?de(e,i,t):(s=ee[i],de(e,s+256+1,t),a=Z[s],0!==a&&(i-=te[s],ce(e,i,a)),r--,s=ue(r),de(e,s,n),a=V[s],0!==a&&(r-=ne[s],ce(e,r,a)))}while(o<e.sym_next);de(e,256,t)},ye=(e,t)=>{const n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let a,o,u,l=-1;for(e.heap_len=0,e.heap_max=573,a=0;a<s;a++)0!==n[2*a]?(e.heap[++e.heap_len]=l=a,e.depth[a]=0):n[2*a+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=l<2?++l:0,n[2*u]=1,e.depth[u]=0,e.opt_len--,i&&(e.static_len-=r[2*u+1]);for(t.max_code=l,a=e.heap_len>>1;a>=1;a--)me(e,n,a);u=s;do{a=e.heap[1],e.heap[1]=e.heap[e.heap_len--],me(e,n,1),o=e.heap[1],e.heap[--e.heap_max]=a,e.heap[--e.heap_max]=o,n[2*u]=n[2*a]+n[2*o],e.depth[u]=(e.depth[a]>=e.depth[o]?e.depth[a]:e.depth[o])+1,n[2*a+1]=n[2*o+1]=u,e.heap[1]=u++,me(e,n,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,u=t.stat_desc.max_length;let l,c,d,h,p,f,_=0;for(h=0;h<=15;h++)e.bl_count[h]=0;for(n[2*e.heap[e.heap_max]+1]=0,l=e.heap_max+1;l<573;l++)c=e.heap[l],h=n[2*n[2*c+1]+1]+1,h>u&&(h=u,_++),n[2*c+1]=h,c>r||(e.bl_count[h]++,p=0,c>=o&&(p=a[c-o]),f=n[2*c],e.opt_len+=f*(h+p),s&&(e.static_len+=f*(i[2*c+1]+p)));if(0!==_){do{for(h=u-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[u]--,_-=2}while(_>0);for(h=u;0!==h;h--)for(c=e.bl_count[h];0!==c;)d=e.heap[--l],d>r||(n[2*d+1]!==h&&(e.opt_len+=(h-n[2*d+1])*n[2*d],n[2*d+1]=h),c--)}})(e,t),pe(n,l,e.bl_count)},Ee=(e,t,n)=>{let r,i,s=-1,a=t[1],o=0,u=7,l=4;for(0===a&&(u=138,l=3),t[2*(n+1)+1]=65535,r=0;r<=n;r++)i=a,a=t[2*(r+1)+1],++o<u&&i===a||(o<l?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4))},be=(e,t,n)=>{let r,i,s=-1,a=t[1],o=0,u=7,l=4;for(0===a&&(u=138,l=3),r=0;r<=n;r++)if(i=a,a=t[2*(r+1)+1],!(++o<u&&i===a)){if(o<l)do{de(e,i,e.bl_tree)}while(0!=--o);else 0!==i?(i!==s&&(de(e,i,e.bl_tree),o--),de(e,16,e.bl_tree),ce(e,o-3,2)):o<=10?(de(e,17,e.bl_tree),ce(e,o-3,3)):(de(e,18,e.bl_tree),ce(e,o-11,7));o=0,s=i,0===a?(u=138,l=3):i===a?(u=6,l=3):(u=7,l=4)}};let we=!1;const Se=(e,t,n,r)=>{ce(e,0+(r?1:0),3),_e(e),le(e,n),le(e,~n),n&&e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n};var Te=(e,t,n,r)=>{let i,s,a=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),ye(e,e.l_desc),ye(e,e.d_desc),a=(e=>{let t;for(Ee(e,e.dyn_ltree,e.l_desc.max_code),Ee(e,e.dyn_dtree,e.d_desc.max_code),ye(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Y[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),i=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=i&&(i=s)):i=s=n+5,n+4<=i&&-1!==t?Se(e,t,n,r):4===e.strategy||s===i?(ce(e,2+(r?1:0),3),ve(e,X,J)):(ce(e,4+(r?1:0),3),((e,t,n,r)=>{let i;for(ce(e,t-257,5),ce(e,n-1,5),ce(e,r-4,4),i=0;i<r;i++)ce(e,e.bl_tree[2*Y[i]+1],3);be(e,e.dyn_ltree,t-1),be(e,e.dyn_dtree,n-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),ve(e,e.dyn_ltree,e.dyn_dtree)),fe(e),r&&_e(e)},Ie={_tr_init:e=>{we||((()=>{let e,t,n,r,i;const s=new Array(16);for(n=0,r=0;r<28;r++)for(te[r]=n,e=0;e<1<<Z[r];e++)ee[n++]=r;for(ee[n-1]=r,i=0,r=0;r<16;r++)for(ne[r]=i,e=0;e<1<<V[r];e++)$[i++]=r;for(i>>=7;r<30;r++)for(ne[r]=i<<7,e=0;e<1<<V[r]-7;e++)$[256+i++]=r;for(t=0;t<=15;t++)s[t]=0;for(e=0;e<=143;)X[2*e+1]=8,e++,s[8]++;for(;e<=255;)X[2*e+1]=9,e++,s[9]++;for(;e<=279;)X[2*e+1]=7,e++,s[7]++;for(;e<=287;)X[2*e+1]=8,e++,s[8]++;for(pe(X,287,s),e=0;e<30;e++)J[2*e+1]=5,J[2*e]=he(e,5);ie=new re(X,Z,257,286,15),se=new re(J,V,0,30,15),ae=new re(new Array(0),W,0,19,7)})(),we=!0),e.l_desc=new oe(e.dyn_ltree,ie),e.d_desc=new oe(e.dyn_dtree,se),e.bl_desc=new oe(e.bl_tree,ae),e.bi_buf=0,e.bi_valid=0,fe(e)},_tr_stored_block:Se,_tr_flush_block:Te,_tr_tally:(e,t,n)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=n,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(ee[n]+256+1)]++,e.dyn_dtree[2*ue(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{ce(e,2,3),de(e,256,X),(e=>{16===e.bi_valid?(le(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var ke=(e,t,n,r)=>{let i=65535&e|0,s=e>>>16&65535|0,a=0;for(;0!==n;){a=n>2e3?2e3:n,n-=a;do{i=i+t[r++]|0,s=s+i|0}while(--a);i%=65521,s%=65521}return i|s<<16|0};const Ae=new Uint32Array((()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t})());var Ne=(e,t,n,r)=>{const i=Ae,s=r+n;e^=-1;for(let n=r;n<s;n++)e=e>>>8^i[255&(e^t[n])];return-1^e},Re={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Oe={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ce,_tr_stored_block:De,_tr_flush_block:Me,_tr_tally:xe,_tr_align:Le}=Ie,{Z_NO_FLUSH:Ue,Z_PARTIAL_FLUSH:Pe,Z_FULL_FLUSH:qe,Z_FINISH:Fe,Z_BLOCK:ze,Z_OK:Ge,Z_STREAM_END:je,Z_STREAM_ERROR:Qe,Z_DATA_ERROR:Be,Z_BUF_ERROR:Ke,Z_DEFAULT_COMPRESSION:He,Z_FILTERED:Ze,Z_HUFFMAN_ONLY:Ve,Z_RLE:We,Z_FIXED:Ye,Z_DEFAULT_STRATEGY:Xe,Z_UNKNOWN:Je,Z_DEFLATED:$e}=Oe,et=(e,t)=>(e.msg=Re[t],t),tt=e=>2*e-(e>4?9:0),nt=e=>{let t=e.length;for(;--t>=0;)e[t]=0},rt=e=>{let t,n,r,i=e.w_size;t=e.hash_size,r=t;do{n=e.head[--r],e.head[r]=n>=i?n-i:0}while(--t);t=i,r=t;do{n=e.prev[--r],e.prev[r]=n>=i?n-i:0}while(--t)};let it=(e,t,n)=>(t<<e.hash_shift^n)&e.hash_mask;const st=e=>{const t=e.state;let n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},at=(e,t)=>{Me(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,st(e.strm)},ot=(e,t)=>{e.pending_buf[e.pending++]=t},ut=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},lt=(e,t,n,r)=>{let i=e.avail_in;return i>r&&(i=r),0===i?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),n),1===e.state.wrap?e.adler=ke(e.adler,t,i,n):2===e.state.wrap&&(e.adler=Ne(e.adler,t,i,n)),e.next_in+=i,e.total_in+=i,i)},ct=(e,t)=>{let n,r,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match;const u=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,l=e.window,c=e.w_mask,d=e.prev,h=e.strstart+258;let p=l[s+a-1],f=l[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(n=t,l[n+a]===f&&l[n+a-1]===p&&l[n]===l[s]&&l[++n]===l[s+1]){s+=2,n++;do{}while(l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&l[++s]===l[++n]&&s<h);if(r=258-(h-s),s=h-258,r>a){if(e.match_start=t,a=r,r>=o)break;p=l[s+a-1],f=l[s+a]}}}while((t=d[t&c])>u&&0!=--i);return a<=e.lookahead?a:e.lookahead},dt=e=>{const t=e.w_size;let n,r,i;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-262)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),rt(e),r+=t),0===e.strm.avail_in)break;if(n=lt(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=it(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=it(e,e.ins_h,e.window[i+3-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},ht=(e,t)=>{let n,r,i,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,a=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i)break;if(i=e.strm.avail_out-i,r=e.strstart-e.block_start,n>r+e.strm.avail_in&&(n=r+e.strm.avail_in),n>i&&(n=i),n<s&&(0===n&&t!==Fe||t===Ue||n!==r+e.strm.avail_in))break;a=t===Fe&&n===r+e.strm.avail_in?1:0,De(e,0,0,a),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,st(e.strm),r&&(r>n&&(r=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,n-=r),n&&(lt(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(0===a);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),a?4:t!==Ue&&t!==Fe&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(lt(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,s=i>e.w_size?e.w_size:i,r=e.strstart-e.block_start,(r>=s||(r||t===Fe)&&t!==Ue&&0===e.strm.avail_in&&r<=i)&&(n=r>i?i:r,a=t===Fe&&0===e.strm.avail_in&&n===r?1:0,De(e,e.block_start,n,a),e.block_start+=n,st(e.strm)),a?3:1)},pt=(e,t)=>{let n,r;for(;;){if(e.lookahead<262){if(dt(e),e.lookahead<262&&t===Ue)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=it(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=ct(e,n)),e.match_length>=3)if(r=xe(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=it(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=it(e,e.ins_h,e.window[e.strstart+1]);else r=xe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(at(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Fe?(at(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(at(e,!1),0===e.strm.avail_out)?1:2},ft=(e,t)=>{let n,r,i;for(;;){if(e.lookahead<262){if(dt(e),e.lookahead<262&&t===Ue)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=it(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=ct(e,n),e.match_length<=5&&(e.strategy===Ze||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-3,r=xe(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=it(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(at(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=xe(e,0,e.window[e.strstart-1]),r&&at(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=xe(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Fe?(at(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(at(e,!1),0===e.strm.avail_out)?1:2};function _t(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}const gt=[new _t(0,0,0,0,ht),new _t(4,4,8,4,pt),new _t(4,5,16,8,pt),new _t(4,6,32,32,pt),new _t(4,4,16,16,ft),new _t(8,16,32,32,ft),new _t(8,16,128,128,ft),new _t(8,32,128,256,ft),new _t(32,128,258,1024,ft),new _t(32,258,258,4096,ft)];function mt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=$e,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),nt(this.dyn_ltree),nt(this.dyn_dtree),nt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),nt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),nt(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const vt=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||42!==t.status&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&113!==t.status&&666!==t.status?1:0},yt=e=>{if(vt(e))return et(e,Qe);e.total_in=e.total_out=0,e.data_type=Je;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=-2,Ce(t),Ge},Et=e=>{const t=yt(e);var n;return t===Ge&&((n=e.state).window_size=2*n.w_size,nt(n.head),n.max_lazy_match=gt[n.level].max_lazy,n.good_match=gt[n.level].good_length,n.nice_match=gt[n.level].nice_length,n.max_chain_length=gt[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=2,n.match_available=0,n.ins_h=0),t},bt=(e,t,n,r,i,s)=>{if(!e)return Qe;let a=1;if(t===He&&(t=6),r<0?(a=0,r=-r):r>15&&(a=2,r-=16),i<1||i>9||n!==$e||r<8||r>15||t<0||t>9||s<0||s>Ye||8===r&&1!==a)return et(e,Qe);8===r&&(r=9);const o=new mt;return e.state=o,o.strm=e,o.status=42,o.wrap=a,o.gzhead=null,o.w_bits=r,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=n,Et(e)};var wt={deflateInit:(e,t)=>bt(e,t,$e,15,8,Xe),deflateInit2:bt,deflateReset:Et,deflateResetKeep:yt,deflateSetHeader:(e,t)=>vt(e)||2!==e.state.wrap?Qe:(e.state.gzhead=t,Ge),deflate:(e,t)=>{if(vt(e)||t>ze||t<0)return e?et(e,Qe):Qe;const n=e.state;if(!e.output||0!==e.avail_in&&!e.input||666===n.status&&t!==Fe)return et(e,0===e.avail_out?Ke:Qe);const r=n.last_flush;if(n.last_flush=t,0!==n.pending){if(st(e),0===e.avail_out)return n.last_flush=-1,Ge}else if(0===e.avail_in&&tt(t)<=tt(r)&&t!==Fe)return et(e,Ke);if(666===n.status&&0!==e.avail_in)return et(e,Ke);if(42===n.status&&0===n.wrap&&(n.status=113),42===n.status){let t=$e+(n.w_bits-8<<4)<<8,r=-1;if(r=n.strategy>=Ve||n.level<2?0:n.level<6?1:6===n.level?2:3,t|=r<<6,0!==n.strstart&&(t|=32),t+=31-t%31,ut(n,t),0!==n.strstart&&(ut(n,e.adler>>>16),ut(n,65535&e.adler)),e.adler=1,n.status=113,st(e),0!==n.pending)return n.last_flush=-1,Ge}if(57===n.status)if(e.adler=0,ot(n,31),ot(n,139),ot(n,8),n.gzhead)ot(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ot(n,255&n.gzhead.time),ot(n,n.gzhead.time>>8&255),ot(n,n.gzhead.time>>16&255),ot(n,n.gzhead.time>>24&255),ot(n,9===n.level?2:n.strategy>=Ve||n.level<2?4:0),ot(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(ot(n,255&n.gzhead.extra.length),ot(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=Ne(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69;else if(ot(n,0),ot(n,0),ot(n,0),ot(n,0),ot(n,0),ot(n,9===n.level?2:n.strategy>=Ve||n.level<2?4:0),ot(n,3),n.status=113,st(e),0!==n.pending)return n.last_flush=-1,Ge;if(69===n.status){if(n.gzhead.extra){let t=n.pending,r=(65535&n.gzhead.extra.length)-n.gzindex;for(;n.pending+r>n.pending_buf_size;){let i=n.pending_buf_size-n.pending;if(n.pending_buf.set(n.gzhead.extra.subarray(n.gzindex,n.gzindex+i),n.pending),n.pending=n.pending_buf_size,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex+=i,st(e),0!==n.pending)return n.last_flush=-1,Ge;t=0,r-=i}let i=new Uint8Array(n.gzhead.extra);n.pending_buf.set(i.subarray(n.gzindex,n.gzindex+r),n.pending),n.pending+=r,n.gzhead.hcrc&&n.pending>t&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-t,t)),n.gzindex=0}n.status=73}if(73===n.status){if(n.gzhead.name){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-r,r)),st(e),0!==n.pending)return n.last_flush=-1,Ge;r=0}t=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,ot(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-r,r)),n.gzindex=0}n.status=91}if(91===n.status){if(n.gzhead.comment){let t,r=n.pending;do{if(n.pending===n.pending_buf_size){if(n.gzhead.hcrc&&n.pending>r&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-r,r)),st(e),0!==n.pending)return n.last_flush=-1,Ge;r=0}t=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,ot(n,t)}while(0!==t);n.gzhead.hcrc&&n.pending>r&&(e.adler=Ne(e.adler,n.pending_buf,n.pending-r,r))}n.status=103}if(103===n.status){if(n.gzhead.hcrc){if(n.pending+2>n.pending_buf_size&&(st(e),0!==n.pending))return n.last_flush=-1,Ge;ot(n,255&e.adler),ot(n,e.adler>>8&255),e.adler=0}if(n.status=113,st(e),0!==n.pending)return n.last_flush=-1,Ge}if(0!==e.avail_in||0!==n.lookahead||t!==Ue&&666!==n.status){let r=0===n.level?ht(n,t):n.strategy===Ve?((e,t)=>{let n;for(;;){if(0===e.lookahead&&(dt(e),0===e.lookahead)){if(t===Ue)return 1;break}if(e.match_length=0,n=xe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(at(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Fe?(at(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(at(e,!1),0===e.strm.avail_out)?1:2})(n,t):n.strategy===We?((e,t)=>{let n,r,i,s;const a=e.window;for(;;){if(e.lookahead<=258){if(dt(e),e.lookahead<=258&&t===Ue)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(i=e.strstart-1,r=a[i],r===a[++i]&&r===a[++i]&&r===a[++i])){s=e.strstart+258;do{}while(r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&r===a[++i]&&i<s);e.match_length=258-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=xe(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=xe(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(at(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Fe?(at(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(at(e,!1),0===e.strm.avail_out)?1:2})(n,t):gt[n.level].func(n,t);if(3!==r&&4!==r||(n.status=666),1===r||3===r)return 0===e.avail_out&&(n.last_flush=-1),Ge;if(2===r&&(t===Pe?Le(n):t!==ze&&(De(n,0,0,!1),t===qe&&(nt(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),st(e),0===e.avail_out))return n.last_flush=-1,Ge}return t!==Fe?Ge:n.wrap<=0?je:(2===n.wrap?(ot(n,255&e.adler),ot(n,e.adler>>8&255),ot(n,e.adler>>16&255),ot(n,e.adler>>24&255),ot(n,255&e.total_in),ot(n,e.total_in>>8&255),ot(n,e.total_in>>16&255),ot(n,e.total_in>>24&255)):(ut(n,e.adler>>>16),ut(n,65535&e.adler)),st(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?Ge:je)},deflateEnd:e=>{if(vt(e))return Qe;const t=e.state.status;return e.state=null,113===t?et(e,Be):Ge},deflateSetDictionary:(e,t)=>{let n=t.length;if(vt(e))return Qe;const r=e.state,i=r.wrap;if(2===i||1===i&&42!==r.status||r.lookahead)return Qe;if(1===i&&(e.adler=ke(e.adler,t,n,0)),r.wrap=0,n>=r.w_size){0===i&&(nt(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(n-r.w_size,n),0),t=e,n=r.w_size}const s=e.avail_in,a=e.next_in,o=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,dt(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=it(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,dt(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=a,e.input=o,e.avail_in=s,r.wrap=i,Ge},deflateInfo:"pako deflate (from Nodeca project)"};const St=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Tt=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const t in n)St(n,t)&&(e[t]=n[t])}}return e},It=e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const n=new Uint8Array(t);for(let t=0,r=0,i=e.length;t<i;t++){let i=e[t];n.set(i,r),r+=i.length}return n};let kt=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){kt=!1}const At=new Uint8Array(256);for(let e=0;e<256;e++)At[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;At[254]=At[254]=1;var Nt=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,n,r,i,s,a=e.length,o=0;for(i=0;i<a;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),s=0,i=0;s<o;i++)n=e.charCodeAt(i),55296==(64512&n)&&i+1<a&&(r=e.charCodeAt(i+1),56320==(64512&r)&&(n=65536+(n-55296<<10)+(r-56320),i++)),n<128?t[s++]=n:n<2048?(t[s++]=192|n>>>6,t[s++]=128|63&n):n<65536?(t[s++]=224|n>>>12,t[s++]=128|n>>>6&63,t[s++]=128|63&n):(t[s++]=240|n>>>18,t[s++]=128|n>>>12&63,t[s++]=128|n>>>6&63,t[s++]=128|63&n);return t},Rt=(e,t)=>{const n=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,i;const s=new Array(2*n);for(i=0,r=0;r<n;){let t=e[r++];if(t<128){s[i++]=t;continue}let a=At[t];if(a>4)s[i++]=65533,r+=a-1;else{for(t&=2===a?31:3===a?15:7;a>1&&r<n;)t=t<<6|63&e[r++],a--;a>1?s[i++]=65533:t<65536?s[i++]=t:(t-=65536,s[i++]=55296|t>>10&1023,s[i++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&kt)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n})(s,i)},Ot=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+At[e[n]]>t?n:t};var Ct=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Dt=Object.prototype.toString,{Z_NO_FLUSH:Mt,Z_SYNC_FLUSH:xt,Z_FULL_FLUSH:Lt,Z_FINISH:Ut,Z_OK:Pt,Z_STREAM_END:qt,Z_DEFAULT_COMPRESSION:Ft,Z_DEFAULT_STRATEGY:zt,Z_DEFLATED:Gt}=Oe;function jt(e){this.options=Tt({level:Ft,method:Gt,chunkSize:16384,windowBits:15,memLevel:8,strategy:zt},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let n=wt.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==Pt)throw new Error(Re[n]);if(t.header&&wt.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?Nt(t.dictionary):"[object ArrayBuffer]"===Dt.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,n=wt.deflateSetDictionary(this.strm,e),n!==Pt)throw new Error(Re[n]);this._dict_set=!0}}function Qt(e,t){const n=new jt(t);if(n.push(e,!0),n.err)throw n.msg||Re[n.err];return n.result}jt.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Ut:Mt,"string"==typeof e?n.input=Nt(e):"[object ArrayBuffer]"===Dt.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;)if(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),(s===xt||s===Lt)&&n.avail_out<=6)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(i=wt.deflate(n,s),i===qt)return n.next_out>0&&this.onData(n.output.subarray(0,n.next_out)),i=wt.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Pt;if(0!==n.avail_out){if(s>0&&n.next_out>0)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(0===n.avail_in)break}else this.onData(n.output)}return!0},jt.prototype.onData=function(e){this.chunks.push(e)},jt.prototype.onEnd=function(e){e===Pt&&(this.result=It(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Bt={Deflate:jt,deflate:Qt,deflateRaw:function(e,t){return(t=t||{}).raw=!0,Qt(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,Qt(e,t)},constants:Oe};var Kt=function(e,t){let n,r,i,s,a,o,u,l,c,d,h,p,f,_,g,m,v,y,E,b,w,S,T,I;const k=e.state;n=e.next_in,T=e.input,r=n+(e.avail_in-5),i=e.next_out,I=e.output,s=i-(t-e.avail_out),a=i+(e.avail_out-257),o=k.dmax,u=k.wsize,l=k.whave,c=k.wnext,d=k.window,h=k.hold,p=k.bits,f=k.lencode,_=k.distcode,g=(1<<k.lenbits)-1,m=(1<<k.distbits)-1;e:do{p<15&&(h+=T[n++]<<p,p+=8,h+=T[n++]<<p,p+=8),v=f[h&g];t:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,0===y)I[i++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=f[(65535&v)+(h&(1<<y)-1)];continue t}if(32&y){k.mode=16191;break e}e.msg="invalid literal/length code",k.mode=16209;break e}E=65535&v,y&=15,y&&(p<y&&(h+=T[n++]<<p,p+=8),E+=h&(1<<y)-1,h>>>=y,p-=y),p<15&&(h+=T[n++]<<p,p+=8,h+=T[n++]<<p,p+=8),v=_[h&m];n:for(;;){if(y=v>>>24,h>>>=y,p-=y,y=v>>>16&255,!(16&y)){if(0==(64&y)){v=_[(65535&v)+(h&(1<<y)-1)];continue n}e.msg="invalid distance code",k.mode=16209;break e}if(b=65535&v,y&=15,p<y&&(h+=T[n++]<<p,p+=8,p<y&&(h+=T[n++]<<p,p+=8)),b+=h&(1<<y)-1,b>o){e.msg="invalid distance too far back",k.mode=16209;break e}if(h>>>=y,p-=y,y=i-s,b>y){if(y=b-y,y>l&&k.sane){e.msg="invalid distance too far back",k.mode=16209;break e}if(w=0,S=d,0===c){if(w+=u-y,y<E){E-=y;do{I[i++]=d[w++]}while(--y);w=i-b,S=I}}else if(c<y){if(w+=u+c-y,y-=c,y<E){E-=y;do{I[i++]=d[w++]}while(--y);if(w=0,c<E){y=c,E-=y;do{I[i++]=d[w++]}while(--y);w=i-b,S=I}}}else if(w+=c-y,y<E){E-=y;do{I[i++]=d[w++]}while(--y);w=i-b,S=I}for(;E>2;)I[i++]=S[w++],I[i++]=S[w++],I[i++]=S[w++],E-=3;E&&(I[i++]=S[w++],E>1&&(I[i++]=S[w++]))}else{w=i-b;do{I[i++]=I[w++],I[i++]=I[w++],I[i++]=I[w++],E-=3}while(E>2);E&&(I[i++]=I[w++],E>1&&(I[i++]=I[w++]))}break}}break}}while(n<r&&i<a);E=p>>3,n-=E,p-=E<<3,h&=(1<<p)-1,e.next_in=n,e.next_out=i,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=i<a?a-i+257:257-(i-a),k.hold=h,k.bits=p};const Ht=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Vt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Wt=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Yt=(e,t,n,r,i,s,a,o)=>{const u=o.bits;let l,c,d,h,p,f,_=0,g=0,m=0,v=0,y=0,E=0,b=0,w=0,S=0,T=0,I=null;const k=new Uint16Array(16),A=new Uint16Array(16);let N,R,O,C=null;for(_=0;_<=15;_++)k[_]=0;for(g=0;g<r;g++)k[t[n+g]]++;for(y=u,v=15;v>=1&&0===k[v];v--);if(y>v&&(y=v),0===v)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(m=1;m<v&&0===k[m];m++);for(y<m&&(y=m),w=1,_=1;_<=15;_++)if(w<<=1,w-=k[_],w<0)return-1;if(w>0&&(0===e||1!==v))return-1;for(A[1]=0,_=1;_<15;_++)A[_+1]=A[_]+k[_];for(g=0;g<r;g++)0!==t[n+g]&&(a[A[t[n+g]]++]=g);if(0===e?(I=C=a,f=20):1===e?(I=Ht,C=Zt,f=257):(I=Vt,C=Wt,f=0),T=0,g=0,_=m,p=s,E=y,b=0,d=-1,S=1<<y,h=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){N=_-b,a[g]+1<f?(R=0,O=a[g]):a[g]>=f?(R=C[a[g]-f],O=I[a[g]-f]):(R=96,O=0),l=1<<_-b,c=1<<E,m=c;do{c-=l,i[p+(T>>b)+c]=N<<24|R<<16|O|0}while(0!==c);for(l=1<<_-1;T&l;)l>>=1;if(0!==l?(T&=l-1,T+=l):T=0,g++,0==--k[_]){if(_===v)break;_=t[n+a[g]]}if(_>y&&(T&h)!==d){for(0===b&&(b=y),p+=m,E=_-b,w=1<<E;E+b<v&&(w-=k[E+b],!(w<=0));)E++,w<<=1;if(S+=1<<E,1===e&&S>852||2===e&&S>592)return 1;d=T&h,i[d]=y<<24|E<<16|p-s|0}}return 0!==T&&(i[p+T]=_-b<<24|64<<16|0),o.bits=y,0};const{Z_FINISH:Xt,Z_BLOCK:Jt,Z_TREES:$t,Z_OK:en,Z_STREAM_END:tn,Z_NEED_DICT:nn,Z_STREAM_ERROR:rn,Z_DATA_ERROR:sn,Z_MEM_ERROR:an,Z_BUF_ERROR:on,Z_DEFLATED:un}=Oe,ln=16209,cn=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function dn(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const hn=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<16180||t.mode>16211?1:0},pn=e=>{if(hn(e))return rn;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=16180,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,en},fn=e=>{if(hn(e))return rn;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,pn(e)},_n=(e,t)=>{let n;if(hn(e))return rn;const r=e.state;return t<0?(n=0,t=-t):(n=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?rn:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,fn(e))},gn=(e,t)=>{if(!e)return rn;const n=new dn;e.state=n,n.strm=e,n.window=null,n.mode=16180;const r=_n(e,t);return r!==en&&(e.state=null),r};let mn,vn,yn=!0;const En=e=>{if(yn){mn=new Int32Array(512),vn=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Yt(1,e.lens,0,288,mn,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Yt(2,e.lens,0,32,vn,0,e.work,{bits:5}),yn=!1}e.lencode=mn,e.lenbits=9,e.distcode=vn,e.distbits=5},bn=(e,t,n,r)=>{let i;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(n-s.wsize,n),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(n-r,n-r+i),s.wnext),(r-=i)?(s.window.set(t.subarray(n-r,n),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0};var wn={inflateReset:fn,inflateReset2:_n,inflateResetKeep:pn,inflateInit:e=>gn(e,15),inflateInit2:gn,inflate:(e,t)=>{let n,r,i,s,a,o,u,l,c,d,h,p,f,_,g,m,v,y,E,b,w,S,T=0;const I=new Uint8Array(4);let k,A;const N=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(hn(e)||!e.output||!e.input&&0!==e.avail_in)return rn;n=e.state,16191===n.mode&&(n.mode=16192),a=e.next_out,i=e.output,u=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,d=o,h=u,S=en;e:for(;;)switch(n.mode){case 16180:if(0===n.wrap){n.mode=16192;break}for(;c<16;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(2&n.wrap&&35615===l){0===n.wbits&&(n.wbits=15),n.check=0,I[0]=255&l,I[1]=l>>>8&255,n.check=Ne(n.check,I,2,0),l=0,c=0,n.mode=16181;break}if(n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",n.mode=ln;break}if((15&l)!==un){e.msg="unknown compression method",n.mode=ln;break}if(l>>>=4,c-=4,w=8+(15&l),0===n.wbits&&(n.wbits=w),w>15||w>n.wbits){e.msg="invalid window size",n.mode=ln;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=512&l?16189:16191,l=0,c=0;break;case 16181:for(;c<16;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(n.flags=l,(255&n.flags)!==un){e.msg="unknown compression method",n.mode=ln;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=ln;break}n.head&&(n.head.text=l>>8&1),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=Ne(n.check,I,2,0)),l=0,c=0,n.mode=16182;case 16182:for(;c<32;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.head&&(n.head.time=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,I[2]=l>>>16&255,I[3]=l>>>24&255,n.check=Ne(n.check,I,4,0)),l=0,c=0,n.mode=16183;case 16183:for(;c<16;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.head&&(n.head.xflags=255&l,n.head.os=l>>8),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=Ne(n.check,I,2,0)),l=0,c=0,n.mode=16184;case 16184:if(1024&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.length=l,n.head&&(n.head.extra_len=l),512&n.flags&&4&n.wrap&&(I[0]=255&l,I[1]=l>>>8&255,n.check=Ne(n.check,I,2,0)),l=0,c=0}else n.head&&(n.head.extra=null);n.mode=16185;case 16185:if(1024&n.flags&&(p=n.length,p>o&&(p=o),p&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(s,s+p),w)),512&n.flags&&4&n.wrap&&(n.check=Ne(n.check,r,p,s)),o-=p,s+=p,n.length-=p),n.length))break e;n.length=0,n.mode=16186;case 16186:if(2048&n.flags){if(0===o)break e;p=0;do{w=r[s+p++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&p<o);if(512&n.flags&&4&n.wrap&&(n.check=Ne(n.check,r,p,s)),o-=p,s+=p,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=16187;case 16187:if(4096&n.flags){if(0===o)break e;p=0;do{w=r[s+p++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&p<o);if(512&n.flags&&4&n.wrap&&(n.check=Ne(n.check,r,p,s)),o-=p,s+=p,w)break e}else n.head&&(n.head.comment=null);n.mode=16188;case 16188:if(512&n.flags){for(;c<16;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(4&n.wrap&&l!==(65535&n.check)){e.msg="header crc mismatch",n.mode=ln;break}l=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=16191;break;case 16189:for(;c<32;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}e.adler=n.check=cn(l),l=0,c=0,n.mode=16190;case 16190:if(0===n.havedict)return e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=l,n.bits=c,nn;e.adler=n.check=1,n.mode=16191;case 16191:if(t===Jt||t===$t)break e;case 16192:if(n.last){l>>>=7&c,c-=7&c,n.mode=16206;break}for(;c<3;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}switch(n.last=1&l,l>>>=1,c-=1,3&l){case 0:n.mode=16193;break;case 1:if(En(n),n.mode=16199,t===$t){l>>>=2,c-=2;break e}break;case 2:n.mode=16196;break;case 3:e.msg="invalid block type",n.mode=ln}l>>>=2,c-=2;break;case 16193:for(l>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ln;break}if(n.length=65535&l,l=0,c=0,n.mode=16194,t===$t)break e;case 16194:n.mode=16195;case 16195:if(p=n.length,p){if(p>o&&(p=o),p>u&&(p=u),0===p)break e;i.set(r.subarray(s,s+p),a),o-=p,s+=p,u-=p,a+=p,n.length-=p;break}n.mode=16191;break;case 16196:for(;c<14;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(n.nlen=257+(31&l),l>>>=5,c-=5,n.ndist=1+(31&l),l>>>=5,c-=5,n.ncode=4+(15&l),l>>>=4,c-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ln;break}n.have=0,n.mode=16197;case 16197:for(;n.have<n.ncode;){for(;c<3;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.lens[N[n.have++]]=7&l,l>>>=3,c-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,k={bits:n.lenbits},S=Yt(0,n.lens,0,19,n.lencode,0,n.work,k),n.lenbits=k.bits,S){e.msg="invalid code lengths set",n.mode=ln;break}n.have=0,n.mode=16198;case 16198:for(;n.have<n.nlen+n.ndist;){for(;T=n.lencode[l&(1<<n.lenbits)-1],g=T>>>24,m=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(v<16)l>>>=g,c-=g,n.lens[n.have++]=v;else{if(16===v){for(A=g+2;c<A;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(l>>>=g,c-=g,0===n.have){e.msg="invalid bit length repeat",n.mode=ln;break}w=n.lens[n.have-1],p=3+(3&l),l>>>=2,c-=2}else if(17===v){for(A=g+3;c<A;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}l>>>=g,c-=g,w=0,p=3+(7&l),l>>>=3,c-=3}else{for(A=g+7;c<A;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}l>>>=g,c-=g,w=0,p=11+(127&l),l>>>=7,c-=7}if(n.have+p>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ln;break}for(;p--;)n.lens[n.have++]=w}}if(n.mode===ln)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=ln;break}if(n.lenbits=9,k={bits:n.lenbits},S=Yt(1,n.lens,0,n.nlen,n.lencode,0,n.work,k),n.lenbits=k.bits,S){e.msg="invalid literal/lengths set",n.mode=ln;break}if(n.distbits=6,n.distcode=n.distdyn,k={bits:n.distbits},S=Yt(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,k),n.distbits=k.bits,S){e.msg="invalid distances set",n.mode=ln;break}if(n.mode=16199,t===$t)break e;case 16199:n.mode=16200;case 16200:if(o>=6&&u>=258){e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=l,n.bits=c,Kt(e,h),a=e.next_out,i=e.output,u=e.avail_out,s=e.next_in,r=e.input,o=e.avail_in,l=n.hold,c=n.bits,16191===n.mode&&(n.back=-1);break}for(n.back=0;T=n.lencode[l&(1<<n.lenbits)-1],g=T>>>24,m=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(m&&0==(240&m)){for(y=g,E=m,b=v;T=n.lencode[b+((l&(1<<y+E)-1)>>y)],g=T>>>24,m=T>>>16&255,v=65535&T,!(y+g<=c);){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}l>>>=y,c-=y,n.back+=y}if(l>>>=g,c-=g,n.back+=g,n.length=v,0===m){n.mode=16205;break}if(32&m){n.back=-1,n.mode=16191;break}if(64&m){e.msg="invalid literal/length code",n.mode=ln;break}n.extra=15&m,n.mode=16201;case 16201:if(n.extra){for(A=n.extra;c<A;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.length+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=16202;case 16202:for(;T=n.distcode[l&(1<<n.distbits)-1],g=T>>>24,m=T>>>16&255,v=65535&T,!(g<=c);){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(0==(240&m)){for(y=g,E=m,b=v;T=n.distcode[b+((l&(1<<y+E)-1)>>y)],g=T>>>24,m=T>>>16&255,v=65535&T,!(y+g<=c);){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}l>>>=y,c-=y,n.back+=y}if(l>>>=g,c-=g,n.back+=g,64&m){e.msg="invalid distance code",n.mode=ln;break}n.offset=v,n.extra=15&m,n.mode=16203;case 16203:if(n.extra){for(A=n.extra;c<A;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}n.offset+=l&(1<<n.extra)-1,l>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ln;break}n.mode=16204;case 16204:if(0===u)break e;if(p=h-u,n.offset>p){if(p=n.offset-p,p>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ln;break}p>n.wnext?(p-=n.wnext,f=n.wsize-p):f=n.wnext-p,p>n.length&&(p=n.length),_=n.window}else _=i,f=a-n.offset,p=n.length;p>u&&(p=u),u-=p,n.length-=p;do{i[a++]=_[f++]}while(--p);0===n.length&&(n.mode=16200);break;case 16205:if(0===u)break e;i[a++]=n.length,u--,n.mode=16200;break;case 16206:if(n.wrap){for(;c<32;){if(0===o)break e;o--,l|=r[s++]<<c,c+=8}if(h-=u,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Ne(n.check,i,h,a-h):ke(n.check,i,h,a-h)),h=u,4&n.wrap&&(n.flags?l:cn(l))!==n.check){e.msg="incorrect data check",n.mode=ln;break}l=0,c=0}n.mode=16207;case 16207:if(n.wrap&&n.flags){for(;c<32;){if(0===o)break e;o--,l+=r[s++]<<c,c+=8}if(4&n.wrap&&l!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=ln;break}l=0,c=0}n.mode=16208;case 16208:S=tn;break e;case ln:S=sn;break e;case 16210:return an;default:return rn}return e.next_out=a,e.avail_out=u,e.next_in=s,e.avail_in=o,n.hold=l,n.bits=c,(n.wsize||h!==e.avail_out&&n.mode<ln&&(n.mode<16206||t!==Xt))&&bn(e,e.output,e.next_out,h-e.avail_out),d-=e.avail_in,h-=e.avail_out,e.total_in+=d,e.total_out+=h,n.total+=h,4&n.wrap&&h&&(e.adler=n.check=n.flags?Ne(n.check,i,h,e.next_out-h):ke(n.check,i,h,e.next_out-h)),e.data_type=n.bits+(n.last?64:0)+(16191===n.mode?128:0)+(16199===n.mode||16194===n.mode?256:0),(0===d&&0===h||t===Xt)&&S===en&&(S=on),S},inflateEnd:e=>{if(hn(e))return rn;let t=e.state;return t.window&&(t.window=null),e.state=null,en},inflateGetHeader:(e,t)=>{if(hn(e))return rn;const n=e.state;return 0==(2&n.wrap)?rn:(n.head=t,t.done=!1,en)},inflateSetDictionary:(e,t)=>{const n=t.length;let r,i,s;return hn(e)?rn:(r=e.state,0!==r.wrap&&16190!==r.mode?rn:16190===r.mode&&(i=1,i=ke(i,t,n,0),i!==r.check)?sn:(s=bn(e,t,n,n),s?(r.mode=16210,an):(r.havedict=1,en)))},inflateInfo:"pako inflate (from Nodeca project)"};var Sn=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Tn=Object.prototype.toString,{Z_NO_FLUSH:In,Z_FINISH:kn,Z_OK:An,Z_STREAM_END:Nn,Z_NEED_DICT:Rn,Z_STREAM_ERROR:On,Z_DATA_ERROR:Cn,Z_MEM_ERROR:Dn}=Oe;function Mn(e){this.options=Tt({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ct,this.strm.avail_out=0;let n=wn.inflateInit2(this.strm,t.windowBits);if(n!==An)throw new Error(Re[n]);if(this.header=new Sn,wn.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=Nt(t.dictionary):"[object ArrayBuffer]"===Tn.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=wn.inflateSetDictionary(this.strm,t.dictionary),n!==An)))throw new Error(Re[n])}function xn(e,t){const n=new Mn(t);if(n.push(e),n.err)throw n.msg||Re[n.err];return n.result}Mn.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,a,o;if(this.ended)return!1;for(a=t===~~t?t:!0===t?kn:In,"[object ArrayBuffer]"===Tn.call(e)?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(0===n.avail_out&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),s=wn.inflate(n,a),s===Rn&&i&&(s=wn.inflateSetDictionary(n,i),s===An?s=wn.inflate(n,a):s===Cn&&(s=Rn));n.avail_in>0&&s===Nn&&n.state.wrap>0&&0!==e[n.next_in];)wn.inflateReset(n),s=wn.inflate(n,a);switch(s){case On:case Cn:case Rn:case Dn:return this.onEnd(s),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(0===n.avail_out||s===Nn))if("string"===this.options.to){let e=Ot(n.output,n.next_out),t=n.next_out-e,i=Rt(n.output,e);n.next_out=t,n.avail_out=r-t,t&&n.output.set(n.output.subarray(e,e+t),0),this.onData(i)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(s!==An||0!==o){if(s===Nn)return s=wn.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===n.avail_in)break}}return!0},Mn.prototype.onData=function(e){this.chunks.push(e)},Mn.prototype.onEnd=function(e){e===An&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=It(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ln={Inflate:Mn,inflate:xn,inflateRaw:function(e,t){return(t=t||{}).raw=!0,xn(e,t)},ungzip:xn,constants:Oe};const{Deflate:Un,deflate:Pn,deflateRaw:qn,gzip:Fn}=Bt,{Inflate:zn,inflate:Gn,inflateRaw:jn,ungzip:Qn}=Ln;var Bn,Kn={Deflate:Un,deflate:Pn,deflateRaw:qn,gzip:Fn,Inflate:zn,inflate:Gn,inflateRaw:jn,ungzip:Qn,constants:Oe};!function(e){e.CONNECTING="CONNECTING",e.OPEN="OPEN",e.CLOSED="CLOSED"}(Bn||(Bn={}));var Hn,Zn=function(e){function n(t,n){var r=n.sdkState,i=n.dispatcher,s=n.logger,a=e.call(this)||this;return a.lastActive=0,a._iid=t,a._sdkState=r,a._dispatcher=i,a._logger=s,a}return t(n,e),Object.defineProperty(n.prototype,"isOpen",{get:function(){return this.connectionState===Bn.OPEN},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connectionState",{get:function(){if(this._ws)switch(this._ws.readyState){case 0:return Bn.CONNECTING;case 1:return Bn.OPEN}return Bn.CLOSED},enumerable:!1,configurable:!0}),n.prototype._handleMessage=function(e){var t=this;e.split("\n").forEach((function(e){if(e){var n=B.createFromRawMessage(t._iid,e);t._logger.debug("receive websocket event",n),"LOGI"===n.code?t.dispatch("message",n):"PONG"===n.code?t.dispatch("pong"):"EXPR"===n.code?n.payload&&n.payload.expires_in>=0&&t._dispatcher.dispatch(new z):"NOOP"===n.code||t.dispatch("message",n)}}))},n.prototype.connect=function(e){var t=this;this._ws=new WebSocket(e),this._ws.onopen=function(){t._logger.debug("websocket open"),t.dispatch("open")},this._ws.onmessage=function(e){return i(t,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(a){return(null===(n=this._sdkState.websocket)||void 0===n?void 0:n.compression)?e.data instanceof Blob?((t=new FileReader).readAsArrayBuffer(e.data),t.onloadend=function(){return i(r,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return[4,(r=t.result,i(void 0,void 0,void 0,(function(){var e;return s(this,(function(t){return e=Kn.ungzip(r),[2,String.fromCharCode.apply(null,e)]}))})))];case 1:return e=n.sent(),this._handleMessage(e),[2]}var r}))}))}):"string"==typeof e.data&&this._handleMessage(e.data):this._handleMessage(e.data),[2]}))}))},this._ws.onerror=function(){t._logger.debug("websocket error"),t.dispatch("error",f.networkError)},this._ws.onclose=function(){t._logger.debug("websocket close"),t.dispatch("close")},this.lastActive=Date.now()},n.prototype.disconnect=function(){var e=this;return new Promise((function(t){e._logger.debug("websocket disconnect"),e._ws&&e.connectionState!==Bn.CLOSED?(e._ws.onopen=K,e._ws.onmessage=K,e._ws.onerror=K,e._ws.onclose=function(){e.dispatch("close"),t()},e._ws.close(),e._ws=null):t()}))},n.prototype.send=function(e){if(!this._ws)throw f.connectionClosed;"PING"!==e.code?this.dispatch("ping-refresh"):this._logger.debug("send ping",e),this._ws.send(e.convertToMessage())},n.prototype.error=function(e){this._logger.debug("websocket error",e),this.dispatch("error",e)},n}(D),Vn=function(e){function n(t){var n,r=t.code,i=t.ackRequired,s=t.payload,a=void 0===s?null:s,o=this;return(o=e.call(this)||this).code=r,o.payload=a,o.requestId=null!==(n=o.payload.req_id)&&void 0!==n?n:O(),o.ackRequired=i,o.payload.req_id=o.requestId,o}return t(n,e),n.prototype.convertToMessage=function(){return"".concat(this.code).concat(JSON.stringify(this.payload),"\n")},n}(x),Wn=function(e){function n(t){var n=t.all,r=t.custom_types,i=t.ts,s=e.call(this)||this;return s.all=n,s.customTypes=r,s.ts=i,s}return t(n,e),n}(x),Yn=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},Xn=function(){function e(e,t){var n=t.auth,r=t.sdkState,i=t.dispatcher,s=t.logger,a=this;this._ackStateMap=new Map,this._sdkState=r,this._dispatcher=i,this._logger=s,this.apiClient=new Q(e,{auth:n,sdkState:r,dispatcher:i,logger:s}),this.websocketClient=new Zn(e,{sdkState:r,dispatcher:i,logger:s}),this.websocketClient.on("message",(function(e){if(e.payload.unread_cnt&&a._dispatcher.dispatch(new Wn(e.payload.unread_cnt)),e.requestId){if(a._ackStateMap.has(e.requestId)){var t=a._ackStateMap.get(e.requestId);"EROR"!==e.code?t.resolve(e):t.reject(new f({code:e.payload.code,message:e.payload.message}))}}else a._dispatcher.dispatch(e)})).on("close",(function(){a._ackStateMap.forEach((function(e){e.reject(f.connectionClosed)})),a._ackStateMap.clear()}))}return e.prototype._sendApiRequest=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.apiClient.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype._sendWebsocketRequest=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i=this;return s(this,(function(s){if(t=new Yn,e.ackRequired){n=null,r=function(r,s){void 0===r&&(r=null),void 0===s&&(s=null),i._ackStateMap.has(e.requestId)&&(i._ackStateMap.delete(e.requestId),n&&(clearTimeout(n),n=null),r?(i._logger.debug("fail websocket request",r),t.reject(r)):(i._logger.debug("receive websocket ack",e.requestId),t.resolve(s)))};try{n=setTimeout((function(){return r(f.noAckTimeout)}),this._sdkState.websocket.responseTimeout),this._ackStateMap.set(e.requestId,{resolve:function(e){return r(null,e)},reject:function(e){return r(e)}}),this.websocketClient.send(e)}catch(e){r(e)}}else try{this.websocketClient.send(e),t.resolve(null)}catch(e){t.reject(e)}return[2,t.promise]}))}))},e.prototype.send=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return e instanceof P?[4,this._sendApiRequest(e)]:[3,2];case 1:case 3:return[2,t.sent()];case 2:return e instanceof Vn?[4,this._sendWebsocketRequest(e)]:[3,4];case 4:throw f.invalidParameters}}))}))},e.prototype.cancel=function(e){this.apiClient.cancel(e)},e.prototype.cancelAll=function(){this.apiClient.cancelAll()},e}();!function(e){e[e.NONE=0]="NONE",e[e.INITIALIZED=1]="INITIALIZED",e[e.CONNECTING=2]="CONNECTING",e[e.CONNECTED=3]="CONNECTED",e[e.RECONNECTING=4]="RECONNECTING",e[e.INTERNAL_DISCONNECTED=5]="INTERNAL_DISCONNECTED",e[e.EXTERNAL_DISCONNECTED=6]="EXTERNAL_DISCONNECTED",e[e.LOGOUT=7]="LOGOUT"}(Hn||(Hn={}));var Jn=function(e){function n(t){var n=t.stateType,r=e.call(this)||this;return r.stateType=n,r}return t(n,e),n}(x),$n=function(){function e(e,t){var n=t.auth,r=t.sdkState,a=t.dispatcher,o=t.logger,u=this;this._currentConnectionStateType=Hn.INITIALIZED,this._lazyCallQueue=[],this.commandRouter=new Xn(e,{auth:n,sdkState:r,dispatcher:a,logger:o}),this._auth=n,this._logger=o,this._dispatcher=a,this._dispatcher.on((function(e){if(e instanceof Jn){var t=e.stateType;switch(u._currentConnectionStateType=t,t){case Hn.CONNECTED:var n=u._lazyCallQueue;u._lazyCallQueue=[],n.forEach((function(e){return i(u,void 0,void 0,(function(){var t,n,r,i,a;return s(this,(function(s){switch(s.label){case 0:t=e.command,n=e.deferred,r=e.timeout,clearTimeout(r),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.send(t)];case 2:return i=s.sent(),n.resolve(i),[3,4];case 3:return a=s.sent(),n.reject(a),[3,4];case 4:return[2]}}))}))}));break;case Hn.INITIALIZED:case Hn.INTERNAL_DISCONNECTED:case Hn.EXTERNAL_DISCONNECTED:case Hn.LOGOUT:n=u._lazyCallQueue;u._lazyCallQueue=[],n.forEach((function(e){return i(u,void 0,void 0,(function(){var t,n;return s(this,(function(r){return t=e.deferred,n=e.timeout,clearTimeout(n),this._auth&&this._auth.hasSession?t.reject(f.connectionClosed):t.reject(f.connectionRequired),[2]}))}))}))}}}))}return Object.defineProperty(e.prototype,"isReady",{get:function(){return this._currentConnectionStateType===Hn.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLazyCallActivated",{get:function(){return this._currentConnectionStateType===Hn.CONNECTING||this._currentConnectionStateType===Hn.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype.send=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(i){switch(i.label){case 0:return e instanceof Vn?this.isReady?(this._logger.debug("send websocket request",e),[4,this.commandRouter.send(e)]):[3,2]:[3,4];case 1:case 5:return[2,i.sent()];case 2:if(this.isLazyCallActivated)return this._logger.debug("wait websocket request",e),t=new Yn,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw this._logger.debug("fail websocket request"),f.connectionRequired;case 3:return[3,7];case 4:return e instanceof P?this._auth.hasSession?(this._logger.debug("send api request",e),[4,this.commandRouter.send(e)]):[3,6]:[3,7];case 6:if(this.isLazyCallActivated)return this._logger.debug("wait api request",e),t=new Yn,this._lazyCallQueue.push({command:e,deferred:t,timeout:setTimeout((function(){return r.timeout(e.requestId)}),1e4)}),[2,t.promise];throw n=f.connectionRequired,this._logger.debug("fail api request",n),n;case 7:return[2]}}))}))},e.prototype.forceSend=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this._logger.debug("send forced request",e),[4,this.commandRouter.send(e)];case 1:return[2,t.sent()]}}))}))},e.prototype.timeout=function(e){this._logger.debug("timeout request",e);var t=this._lazyCallQueue.findIndex((function(t){return t.command.requestId===e}));t>-1&&(this._lazyCallQueue[t].deferred.reject(f.connectionRequired),this._lazyCallQueue.splice(t,1))},e.prototype.cancel=function(e){this._logger.debug("cancel api request",e),this.commandRouter.cancel(e)},e.prototype.cancelAll=function(){this._logger.debug("cancel all api requests"),this.commandRouter.cancelAll()},e}(),er=function(){function e(e){var t=e.type,n=e.token;this.type=t,this.token=n}return e.payloadify=function(e){return{type:e.type,token:e.token}},e}(),tr="/".concat("v3","/users"),nr="/".concat("v3","/storage/file"),rr="/".concat("v3","/group_channels"),ir="/".concat("v3","/sdk/group_channels"),sr="/".concat("v3","/open_channels"),ar="/".concat("v3","/sdk/open_channels"),or="/".concat("v3","/search"),ur="/".concat("v3","/report"),lr="/".concat("v3","/emojis"),cr="/".concat("v3","/emoji_categories"),dr="/".concat("v3","/polls"),hr="/".concat("v3","/scheduled_messages"),pr="/".concat("v3","/sdk/statistics"),fr=function(e){function n(t){var n=t.userId,r=t.authToken,i=t.expiringSession,s=void 0===i||i,a=e.call(this)||this;return a.path="".concat(tr,"/").concat(n,"/session_key"),a.method=h.POST,a.params={token:r,expiring_session:!!s},a.requireAuth=!1,a}return t(n,e),n}(P),_r=function(e){function n(t){var n=t.authToken,r=t.expiringSession,i=void 0===r||r,s=t.requestId,a=void 0===s?null:s;return e.call(this,{code:"LOGI",payload:{token:n,expiring_session:i?1:0,req_id:a},ackRequired:!0})||this}return t(n,e),n}(Vn),gr=function(e){function n(t,n){var r=e.call(this,t,n)||this,i=n.key;return r.key=i,r}return t(n,e),n}(q),mr=function(e){function n(t,n,r){var i=e.call(this,t,"LOGI",r)||this;return i.error=null,i.newKey=r.new_key,i.error=r.error?new f(r.error):null,i}return t(n,e),n}(B),vr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(x),yr=function(e){return i(void 0,void 0,void 0,(function(){return s(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))},Er=function(){function e(){}return e.prototype.calcTimeout=function(){return 0},e}(),br=function(e,t,n){return void 0===n&&(n=new Er),i(void 0,void 0,void 0,(function(){var r,i,a,o,u,l;return s(this,(function(s){switch(s.label){case 0:r=0,i=null,a=function(e){return void 0===e&&(e=null),i=null!=e?e:new Error("Halted")},o=function(){r=0},s.label=1;case 1:if(!(-1===t||r<t))return[3,9];s.label=2;case 2:return s.trys.push([2,4,,8]),[4,e(a,o)];case 3:if(u=s.sent(),i)throw i;return[2,u];case 4:if(l=s.sent(),i)return[3,6];if(++r===t)throw l;return[4,yr(n.calcTimeout(r))];case 5:return s.sent(),[3,7];case 6:throw i;case 7:return[3,8];case 8:return[3,1];case 9:return[2]}}))}))},wr=function(e){return i(void 0,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,e()];case 1:return n.sent(),[3,3];case 2:if(!((t=n.sent())instanceof f))throw t;return t.throwOutside(),[3,3];case 3:return[2]}}))}))},Sr=function(e){return i(void 0,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e()];case 1:case 2:return t.sent(),[3,3];case 3:return[2]}}))}))},Tr=new WeakMap,Ir=function(e){function n(t){var n=t.auth,r=t.cacheContext,i=t.sdkState,s=t.dispatcher,a=t.requestQueue,o=t.logger,u=e.call(this)||this;return u._currentConnectionStateType=Hn.INITIALIZED,u._deviceTokenCacheEnabled=!1,u._isRefreshingAuthToken=!1,u._isRefreshingSessionKey=!1,u.auth=n,u._cacheContext=r,u._sdkState=i,u._dispatcher=s,u._requestQueue=a,u._logger=o,u._deviceTokens=[],u._dispatcher.on((function(e){if(e instanceof Jn){var t=e.stateType;u._currentConnectionStateType=t}else e instanceof z&&u.handler&&(u._logger.debug("session expired"),u.handler.onSessionExpired(),u.refresh())})),u}return t(n,e),Object.defineProperty(n.prototype,"ekey",{get:function(){return Tr.get(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokens",{get:function(){return this._deviceTokens},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"deviceTokenLastDeletedAt",{get:function(){return this._deviceTokenLastDeletedAt},enumerable:!1,configurable:!0}),n.prototype.indexOfDeviceToken=function(e,t){return this._deviceTokens.findIndex((function(n){return n.type===e&&n.token===t}))},n.prototype.hasDeviceToken=function(e,t){return!1},n.prototype.createRefreshWebsocketCommand=function(e,t){return void 0===t&&(t=null),new _r({authToken:e,expiringSession:!0,requestId:t})},n.prototype._refreshSessionKeyByWebSocket=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a;return s(this,(function(s){switch(s.label){case 0:return t=this.createRefreshWebsocketCommand(e),[4,this._requestQueue.forceSend(t)];case 1:if(n=s.sent(),r=n.as(mr),i=r.newKey,a=r.error)throw a;return this.auth.sessionKey=null!=i?i:this.auth.sessionKey,[2]}}))}))},n.prototype._refreshSessionKeyByApi=function(e){return i(this,void 0,void 0,(function(){var t,n=this;return s(this,(function(r){switch(r.label){case 0:return t=new fr({userId:this._sdkState.userId,authToken:e,expiringSession:!0}),[4,br((function(e){return i(n,void 0,void 0,(function(){var n,r,i;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this._requestQueue.forceSend(t)];case 1:return n=s.sent(),r=n.as(gr).key,this.auth.sessionKey=r,[3,3];case 2:if(i=s.sent(),!this._isSessionRelatedError(i))throw i;return e(i),[3,3];case 3:return[2]}}))}))}),3)];case 1:return r.sent(),[2]}}))}))},n.prototype._refreshSessionKey=function(e,t){return void 0===t&&(t=!0),i(this,void 0,void 0,(function(){var n,r,i,a;return s(this,(function(s){switch(s.label){case 0:if(this._currentConnectionStateType!==Hn.CONNECTED)return[3,10];s.label=1;case 1:return s.trys.push([1,3,,10]),[4,this._refreshSessionKeyByWebSocket(e)];case 2:return s.sent(),this.complete(),[2];case 3:return n=s.sent(),this._isSessionRelatedError(n)?t?(r=this.auth,[4,this._receiveNewAuthToken()]):[3,9]:[3,9];case 4:return r.authToken=s.sent(),this.auth.authToken?[4,this._refreshSessionKey(this.auth.authToken,!1)]:[3,6];case 5:return s.sent(),this.complete(),[3,8];case 6:return[4,this.clear()];case 7:s.sent(),this.close(),s.label=8;case 8:return[2];case 9:return[3,10];case 10:return s.trys.push([10,12,,22]),[4,this._refreshSessionKeyByApi(e)];case 11:return s.sent(),this.complete(),[3,22];case 12:return i=s.sent(),this._isSessionRelatedError(i)?t?(a=this.auth,[4,this._receiveNewAuthToken()]):[3,18]:[3,20];case 13:return a.authToken=s.sent(),this.auth.authToken?[4,this._refreshSessionKeyByApi(this.auth.authToken)]:[3,15];case 14:return s.sent(),this.complete(),[3,17];case 15:return[4,this.clear()];case 16:s.sent(),this.close(),s.label=17;case 17:return[3,19];case 18:throw i;case 19:return[3,21];case 20:throw i;case 21:return[3,22];case 22:return[2]}}))}))},n.prototype._receiveNewAuthToken=function(){var e=this,t=new Yn;return wr((function(){return i(e,void 0,void 0,(function(){var e,n,r=this;return s(this,(function(i){return this._isRefreshingAuthToken=!0,this.auth.clear(),e=null,n=function(){e&&(clearTimeout(e),e=null)},e=setTimeout((function(){r._isRefreshingAuthToken=!1,t.reject()}),1e3*this._sdkState.sessionTokenRefreshTimeout),this.handler.onSessionTokenRequired((function(e){n(),r._isRefreshingAuthToken&&(r._isRefreshingAuthToken=!1,r.dispatch("refresh-authtoken"),t.resolve(e))}),(function(e){n(),r._isRefreshingAuthToken=!1,t.reject(e)})),[2]}))}))})),t.promise},n.prototype._isSessionRelatedError=function(e){return e instanceof f&&(e.isSessionKeyExpiredError||e.isSessionTokenExpiredError)},Object.defineProperty(n.prototype,"isSessionKeyRefreshing",{get:function(){return this._isRefreshingSessionKey},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isRefreshingAuthToken",{get:function(){return this._isRefreshingAuthToken},enumerable:!1,configurable:!0}),n.prototype.login=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return this.auth.sessionKey=e.key,Tr.set(this,e.ekey),t=this._cacheContext.preference,this._deviceTokenCacheEnabled?[4,t.get("sendbird@devicetokens")]:[3,4];case 1:return!(n=r.sent())||n.lastDeletedAt<e.deviceTokenLastDeletedAt?(this._deviceTokens=[],this._deviceTokenLastDeletedAt=e.deviceTokenLastDeletedAt,[4,this.saveDeviceToken()]):[3,3];case 2:return r.sent(),[3,4];case 3:this._deviceTokens=n.tokens.map((function(e){return new er(er.payloadify(e))})),this._deviceTokenLastDeletedAt=n.lastDeletedAt,r.label=4;case 4:return[2]}}))}))},n.prototype.complete=function(){var e=this;this.dispatch("refresh"),wr((function(){return i(e,void 0,void 0,(function(){return s(this,(function(e){return this._logger.debug("session refreshed"),this.handler.onSessionRefreshed(),[2]}))}))}))},n.prototype.error=function(e){var t=this;wr((function(){return i(t,void 0,void 0,(function(){return s(this,(function(t){return this.handler.onSessionError(e),[2]}))}))}))},n.prototype.close=function(){var e=this;this.dispatch("close"),wr((function(){return i(e,void 0,void 0,(function(){return s(this,(function(e){return this._logger.debug("session closed"),this.handler.onSessionClosed(),[2]}))}))}))},n.prototype.refresh=function(){return i(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:if(!this.handler)return[3,10];if(this._isRefreshingSessionKey)return[3,10];if(this._isRefreshingSessionKey=!0,this.auth.authToken)return[3,7];n.label=1;case 1:return n.trys.push([1,6,,7]),[4,this._receiveNewAuthToken()];case 2:return(e=n.sent())?(this._logger.debug("session refreshing.."),this.auth.authToken=e,[3,5]):[3,3];case 3:return[4,this.clear()];case 4:return n.sent(),this.close(),this._isRefreshingSessionKey=!1,[2];case 5:return[3,7];case 6:throw n.sent(),t=f.sessionTokenRequestFailed,this._dispatcher.dispatch(new vr),this.error(t),this._isRefreshingSessionKey=!1,t;case 7:return n.trys.push([7,9,,10]),[4,this._refreshSessionKey(this.auth.authToken)];case 8:return n.sent(),this._isRefreshingSessionKey=!1,[3,10];case 9:throw n.sent(),t=f.sessionTokenRefreshFailed,this._dispatcher.dispatch(new vr),this.error(t),this._isRefreshingSessionKey=!1,t;case 10:return[2]}}))}))},n.prototype.setDeviceToken=function(e,t){return this.indexOfDeviceToken(e,t)<0&&(this._deviceTokens.push(new er({type:e,token:t})),!0)},n.prototype.unsetDeviceToken=function(e,t){var n=this.indexOfDeviceToken(e,t);n>=0&&this._deviceTokens.splice(n,1)},n.prototype.unsetDeviceTokens=function(e){this._deviceTokens=this._deviceTokens.filter((function(t){return t.type!==e}))},n.prototype.setDeviceTokenDeletedAt=function(e){e>0&&(this._deviceTokenLastDeletedAt=e)},n.prototype.saveDeviceToken=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this._deviceTokenCacheEnabled?[4,this._cacheContext.preference.set("sendbird@devicetokens",{tokens:this._deviceTokens,lastDeletedAt:this._deviceTokenLastDeletedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},n.prototype.clear=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.currentUser=null,this.auth.clear(),Tr.delete(this),this._deviceTokens=[],this._deviceTokenLastDeletedAt=0,[4,this.saveDeviceToken()];case 1:return e.sent(),[2]}}))}))},n}(D),kr=function(){function e(){this.type=Hn.NONE,this.name="none"}return e.prototype.run=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e.prototype.onReconnect=function(e,t){return t.resetReconnectCount,i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e.prototype.onDisconnect=function(e,t){return t.error,t.autoReconnect,i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(e){return[2]}))}))},e}(),Ar=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Hn.LOGOUT,t.name="logout",t}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(a){switch(a.label){case 0:return t=Date.now(),n=e.sdkState.userId,[4,e.logout()];case 1:return a.sent(),[4,e.changeState(new Mr,t)];case 2:return a.sent(),wr((function(){return i(r,void 0,void 0,(function(){return s(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onDisconnected(n)})),[2]}))}))})),[2]}}))}))},n}(kr),Nr=function(e){function n(){var t=e.call(this)||this;return t.type=Hn.EXTERNAL_DISCONNECTED,t.name="externaldisconnected",t}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,e.disconnect()];case 1:return t.sent(),[2]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Dr({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Or,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ar,t)];case 1:return n.sent(),[2]}}))}))},n}(kr),Rr=function(e){function n(t){var n=t.autoReconnect,r=e.call(this)||this;return r.type=Hn.INTERNAL_DISCONNECTED,r.name="internaldisconnected",r._autoReconnect=!1,r._autoReconnect=n,r}return t(n,e),n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),this._autoReconnect?[4,e.changeState(new Or,t)]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.disconnect()];case 1:return r.sent(),[4,e.changeState(new Dr({authToken:t}),n)];case 2:return r.sent(),[2]}}))}))},n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Or,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Nr,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ar,t)];case 1:return n.sent(),[2]}}))}))},n}(kr),Or=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Hn.RECONNECTING,t.name="reconnecting",t._haltConnect=null,t._resetConnect=null,t._callbacks=[],t}return t(n,e),n.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=null)},n.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._resetConnect=null,this._callbacks.forEach((function(t){return t(e)}))},n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r,a,o,u,c=this;return s(this,(function(d){switch(d.label){case 0:t=Date.now(),n=new Yn,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),wr((function(){return i(c,void 0,void 0,(function(){return s(this,(function(t){return e.connectionHandlers.forEach((function(e){e.onReconnectStarted()})),[2]}))}))})),d.label=1;case 1:return d.trys.push([1,4,,9]),r=e.sdkState.websocket,a=r.reconnectMaxRetry,o=r.reconnectRetryStrategy,[4,br((function(t,n){return i(c,void 0,void 0,(function(){var r;return s(this,(function(i){switch(i.label){case 0:this._haltConnect=t,this._resetConnect=n,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.connect()];case 2:return i.sent(),[3,4];case 3:if(r=i.sent(),e.clearLoginTimer(),r instanceof f&&r.code===l.CONNECTION_CANCELED)return t(r),[2];throw r;case 4:return[2]}}))}))}),a,o)];case 2:return d.sent(),[4,e.changeState(new Cr,t)];case 3:return d.sent(),wr((function(){return i(c,void 0,void 0,(function(){return s(this,(function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach((function(e){e.onReconnectSucceeded()})),[2]}))}))})),[3,9];case 4:return u=d.sent(),p(u)?[3,7]:u instanceof f?u.code===l.CONNECTION_CANCELED?[3,6]:[4,e.changeState(new Rr({autoReconnect:!1}),t)]:[3,6];case 5:d.sent(),d.label=6;case 6:return wr((function(){return i(c,void 0,void 0,(function(){return s(this,(function(t){return this._flushCallbacks(u),e.connectionHandlers.forEach((function(e){e.onReconnectFailed()})),[2]}))}))})),[3,8];case 7:throw u;case 8:return[3,9];case 9:return[2,n.promise]}}))}))},n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){return n=new Yn,this._halt(f.connectionCanceled),e.cancelConnectForRetry(),this._callbacks.push((function(){var r=Date.now();e.changeState(new Dr({authToken:t}),r).then((function(){n.resolve()})).catch((function(e){n.reject(e)}))})),[2,n.promise]}))}))},n.prototype.onReconnect=function(e,t){var n=t.resetReconnectCount,r=void 0!==n&&n;return i(this,void 0,void 0,(function(){var e;return s(this,(function(t){return e=new Yn,this._resetConnect&&r&&this._resetConnect(),this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},n.prototype.onDisconnect=function(e,t){t.error;var n=t.autoReconnect,r=void 0===n||n;return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(f.connectionCanceled),[4,e.changeState(new Rr({autoReconnect:r}),t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(f.connectionCanceled),[4,e.changeState(new Nr,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(f.connectionCanceled),[4,e.changeState(new Ar,t)];case 1:return n.sent(),[2]}}))}))},n}(kr),Cr=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Hn.CONNECTED,t.name="connected",t}return t(n,e),n.prototype.onReconnect=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.disconnect()];case 1:return n.sent(),[4,e.changeState(new Or,t)];case 2:return n.sent(),[2]}}))}))},n.prototype.onDisconnect=function(e,t){var n=t.autoReconnect;return i(this,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return t=Date.now(),[4,e.changeState(new Rr({autoReconnect:n}),t)];case 1:return r.sent(),[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Nr,t)];case 1:return n.sent(),[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),[4,e.changeState(new Ar,t)];case 1:return n.sent(),[2]}}))}))},n}(kr),Dr=function(e){function n(t){var n=t.authToken,r=e.call(this)||this;return r.type=Hn.CONNECTING,r.name="connecting",r._authToken="",r._haltConnect=null,r._callbacks=[],r._authToken=n,r}return t(n,e),n.prototype._halt=function(e){this._haltConnect&&(this._haltConnect(e),this._haltConnect=null)},n.prototype._flushCallbacks=function(e){void 0===e&&(e=null),this._haltConnect=null,this._callbacks.forEach((function(t){return t(e)}))},n.prototype.run=function(e){return i(this,void 0,void 0,(function(){var t,n,r,a=this;return s(this,(function(o){switch(o.label){case 0:t=Date.now(),n=new Yn,this._callbacks.push((function(e){return e?n.reject(e):n.resolve()})),o.label=1;case 1:return o.trys.push([1,4,,10]),[4,br((function(t){return i(a,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:this._haltConnect=t,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,e.connect(this._authToken)];case 2:return r.sent(),[3,4];case 3:if(n=r.sent(),e.clearLoginTimer(),n instanceof f&&n.code===l.CONNECTION_CANCELED)return t(n),[2];throw n;case 4:return[2]}}))}))}),e.sdkState.websocket.connectMaxRetry)];case 2:return o.sent(),[4,e.changeState(new Cr,t)];case 3:return o.sent(),wr((function(){return i(a,void 0,void 0,(function(){return s(this,(function(t){return this._flushCallbacks(null),e.connectionHandlers.forEach((function(t){t.onConnected(e.sdkState.userId)})),[2]}))}))})),[3,10];case 4:return r=o.sent(),p(r)?[3,8]:[4,e.disconnect()];case 5:return o.sent(),r instanceof f?r.code===l.CONNECTION_CANCELED?[3,7]:[4,e.changeState(new Mr,t)]:[3,7];case 6:o.sent(),o.label=7;case 7:return wr((function(){return i(a,void 0,void 0,(function(){return s(this,(function(e){return this._flushCallbacks(r),[2]}))}))})),[3,9];case 8:throw r;case 9:return[3,10];case 10:return[2,n.promise]}}))}))},n.prototype.onConnect=function(e){return i(this,void 0,void 0,(function(){var e;return s(this,(function(t){return e=new Yn,this._callbacks.push((function(t){return t?e.reject(t):e.resolve()})),[2,e.promise]}))}))},n.prototype.onDisconnect=function(e,t){var n=t.error,r=void 0===n?null:n,a=t.autoReconnect;return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(null!=r?r:f.connectionCanceled),e.hasSession?[4,e.changeState(new Rr({autoReconnect:a}),t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Ar,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},n.prototype.onDisconnectWebSocket=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(f.connectionCanceled),e.hasSession?[4,e.changeState(new Nr,t)]:[3,2];case 1:return n.sent(),[3,4];case 2:return[4,e.changeState(new Ar,t)];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},n.prototype.onLogout=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return t=Date.now(),this._halt(f.connectionCanceled),[4,e.changeState(new Ar,t)];case 1:return n.sent(),[2]}}))}))},n}(kr),Mr=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type=Hn.INITIALIZED,t.name="initialized",t}return t(n,e),n.prototype.onConnect=function(e,t){return i(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=Date.now(),[4,e.changeState(new Dr({authToken:t}),n)];case 1:return r.sent(),[2]}}))}))},n}(kr),xr=function(e){function n(){return e.call(this,{code:"PING",payload:{id:Date.now(),active:1},ackRequired:!1})||this}return t(n,e),n}(Vn),Lr=function(){function e(e){var t=e.pingDelegate,n=e.sdkState,r=e.logger;this._pingTimer=null,this._pingTimeoutTimer=null,this.pingDelegate=t,this.sdkState=n,this._logger=r}return Object.defineProperty(e.prototype,"isWaiting",{get:function(){return!!this._pingTimeoutTimer},enumerable:!1,configurable:!0}),e.prototype.ping=function(){var e,t=this,n=new xr;try{var r=null!==(e=this.sdkState.websocket.pongTimeout)&&void 0!==e?e:5e3;this._pingTimeoutTimer=setTimeout((function(){t._logger.debug("pinger.ping() timeout"),t.pingDelegate.error(null)}),r),this.pingDelegate.send(n),this._logger.debug("pinger.ping()")}catch(e){this._logger.debug("pinger.ping() error",e),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null),this.pingDelegate.error(null)}return n},e.prototype.pong=function(){this._logger.debug("pinger.pong()"),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null)},e.prototype.refreshTimer=function(){var e,t=this;this._logger.debug("pinger.refreshTimer()");var n=null!==(e=this.sdkState.websocket.pingInterval)&&void 0!==e?e:15e3;this.stop(),this._pingTimer=setInterval((function(){t.ping()}),n)},e.prototype.start=function(){this._logger.debug("pinger.start()"),this.refreshTimer(),this.ping()},e.prototype.stop=function(){this._logger.debug("pinger.stop()"),this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null),this._pingTimeoutTimer&&(clearTimeout(this._pingTimeoutTimer),this._pingTimeoutTimer=null)},e}(),Ur=function(){function e(e){void 0===e&&(e={}),this.emojiHash=e.emoji_hash||"",this.uploadSizeLimit=e.file_upload_size_limit?1048576*e.file_upload_size_limit:Number.MAX_SAFE_INTEGER,this.useReaction=!!e.use_reaction,this.applicationAttributes=e.application_attributes||[],this.premiumFeatureList=e.premium_feature_list||[],this.enabledChannelMemberShipHistory=this.applicationAttributes.includes("channel_membership_history")}return e.payloadify=function(e){return{emoji_hash:e.emojiHash,file_upload_size_limit:e.uploadSizeLimit/1048576,application_attributes:e.applicationAttributes,premium_feature_list:e.premiumFeatureList,use_reaction:e.useReaction}},e}(),Pr=function(){function e(e){this._iid="",this._iid=e}return e.payloadify=function(e){return e?{}:null},e}(),qr=function(e){function n(t){var n=t.userId,r=t.metadata,i=e.call(this)||this;return i.method=h.POST,i.path="".concat(tr,"/").concat(n,"/metadata"),i.params={metadata:r},i}return t(n,e),n}(P),Fr=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.metaData=n,r}return t(n,e),n}(q),zr=function(e){function n(t){var n=t.userId,r=t.metadata,i=t.upsert,s=e.call(this)||this;return s.method=h.PUT,s.path="".concat(tr,"/").concat(n,"/metadata"),s.params={metadata:r,upsert:i},s}return t(n,e),n}(P),Gr=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.metadata=n,r}return t(n,e),n}(q),jr=function(e){function n(t){var n=t.userId,r=t.metadataKey,i=e.call(this)||this;return i.method=h.DELETE,i.path="".concat(tr,"/").concat(n,"/metadata/").concat(r),i}return t(n,e),n}(P);!function(e){function n(){return null!==e&&e.apply(this,arguments)||this}t(n,e)}(q);var Qr=function(e){function n(t){var n=t.userId,r=e.call(this)||this;return r.method=h.DELETE,r.path="".concat(tr,"/").concat(n,"/metadata"),r}return t(n,e),n}(P);!function(e){function n(){return null!==e&&e.apply(this,arguments)||this}t(n,e)}(q);var Br,Kr=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return n._iid&&delete n._iid,t&&t(n),n},Hr=function(e,t){void 0===t&&(t=null);var n=JSON.parse(JSON.stringify(e));return t&&t(n),n},Zr=function(e){return{do:function(t){e||t()},throw:function(t){if(!e)throw t}}};!function(e){e.ONLINE="online",e.OFFLINE="offline",e.NON_AVAILABLE="nonavailable"}(Br||(Br={}));var Vr,Wr=function(e){function r(t,n){var r,i,s,a,l,c,d,h,p,f,_,g,m=this;return(m=e.call(this,t)||this).userId=null!==(i=null!==(r=n.guest_id)&&void 0!==r?r:n.user_id)&&void 0!==i?i:"",m.nickname=null!==(a=null!==(s=n.nickname)&&void 0!==s?s:n.name)&&void 0!==a?a:"",m.plainProfileUrl=null!==(c=null!==(l=n.profile_url)&&void 0!==l?l:n.image)&&void 0!==c?c:"",m.requireAuth=null!==(d=n.require_auth_for_profile_image)&&void 0!==d&&d,m.metaData=null!==(h=n.metadata)&&void 0!==h?h:{},m.connectionStatus=Br.NON_AVAILABLE,y(Br,n.is_online)?m.connectionStatus=n.is_online:v("boolean",n.is_online)&&(m.connectionStatus=n.is_online?Br.ONLINE:Br.OFFLINE),m.isActive=null===(p=n.is_active)||void 0===p||p,m.lastSeenAt=null!==(f=n.last_seen_at)&&void 0!==f?f:null,m.preferredLanguages=n.preferred_languages?u([],o(n.preferred_languages),!1):null,m.friendDiscoveryKey=null!==(_=n.friend_discovery_key)&&void 0!==_?_:null,m.friendName=null!==(g=n.friend_name)&&void 0!==g?g:null,m}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{user_id:t.userId,nickname:t.nickname,profile_url:t.plainProfileUrl,require_auth_for_profile_image:t.requireAuth,metadata:t.metaData,is_online:t.connectionStatus,is_active:t.isActive,last_seen_at:t.lastSeenAt,preferred_languages:t.preferredLanguages,friend_discovery_key:t.friendDiscoveryKey,friend_name:t.friendName})):null},Object.defineProperty(r.prototype,"profileUrl",{get:function(){var e=fi.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainProfileUrl,"?auth=").concat(e.ekey):this.plainProfileUrl},enumerable:!1,configurable:!0}),r.prototype.serialize=function(){return Kr(this)},r.prototype._isValidMetaData=function(e){return!Array.isArray(e)&&Object.keys(e).length>0&&Object.keys(e).map((function(t){return e[t]})).every((function(e){return v("string",e)}))},r.prototype._applyMetaData=function(e,t){var n=this;void 0===t&&(t=!1),Object.keys(e).forEach((function(r){t?delete n.metaData[r]:n.metaData[r]=e[r]}))},r.prototype.createMetaData=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a,o;return s(this,(function(s){switch(s.label){case 0:return Zr(this._isValidMetaData(e)).throw(f.invalidParameters),t=fi.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new qr({userId:n.userId,metadata:e}),[4,r.send(i)];case 1:return a=s.sent(),o=a.as(Fr).metaData,this._applyMetaData(o),[2,this.metaData]}}))}))},r.prototype.updateMetaData=function(e,t){return void 0===t&&(t=!1),i(this,void 0,void 0,(function(){var n,r,i,a,o,u;return s(this,(function(s){switch(s.label){case 0:return Zr(this._isValidMetaData(e)).throw(f.invalidParameters),n=fi.of(this._iid),r=n.sdkState,i=n.requestQueue,a=new zr({userId:r.userId,metadata:e,upsert:t}),[4,i.send(a)];case 1:return o=s.sent(),u=o.as(Gr).metadata,this._applyMetaData(u),[2,this.metaData]}}))}))},r.prototype.deleteMetaData=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a;return s(this,(function(s){switch(s.label){case 0:return Zr(v("string",e)).throw(f.invalidParameters),t=fi.of(this._iid),n=t.sdkState,r=t.requestQueue,i=new jr({userId:n.userId,metadataKey:e}),[4,r.send(i)];case 1:return s.sent(),this._applyMetaData(((a={})[e]=!0,a),!0),[2,this.metaData]}}))}))},r.prototype.deleteAllMetaData=function(){return i(this,void 0,void 0,(function(){var e,t,n,r;return s(this,(function(i){switch(i.label){case 0:return e=fi.of(this._iid),t=e.sdkState,n=e.requestQueue,r=new Qr({userId:t.userId}),[4,n.send(r)];case 1:return i.sent(),this.metaData={},[2]}}))}))},r}(Pr),Yr=function(e){function n(t){var n=t.userProfile,r=e.call(this)||this;return r.userProfile=n,r}return t(n,e),n}(x),Xr=function(){function e(e,t){var n,r,i,s,a,o,u,l,c,d,h,p,f,_;this._iid=e,this.appInfo=new Ur(t),this.user=new Wr(e,t),this.connectedAt=null!==(n=t.login_ts)&&void 0!==n?n:0,this.firstConnectedAt=0,this.pingInterval=null!==(r=t.ping_interval)&&void 0!==r?r:15e3,this.pongTimeout=null!==(i=t.pong_timeout)&&void 0!==i?i:5e3,this.reconnectInterval=null!==(a=null===(s=t.reconnect)||void 0===s?void 0:s.interval)&&void 0!==a?a:3e3,this.reconnectMaxInterval=null!==(u=null===(o=t.reconnect)||void 0===o?void 0:o.max_interval)&&void 0!==u?u:6e4,this.reconnectRetryCount=null!==(c=null===(l=t.reconnect)||void 0===l?void 0:l.retry_cnt)&&void 0!==c?c:5,this.reconnectIntervalMultiple=null!==(h=null===(d=t.reconnect)||void 0===d?void 0:d.mul)&&void 0!==h?h:2,this.maxUnreadCountOnSuperGroup=null!==(p=t.max_unread_cnt_on_super_group)&&void 0!==p?p:100,this.profileImageEncryption=!!t.profile_image_encryption,this.concurrentCallLimit=null!==(f=t.concurrent_call_limit)&&void 0!==f?f:5,this.backOffDelay=null!==(_=t.back_off_delay)&&void 0!==_?_:100}return e.payloadify=function(e){return n(n(n({},Wr.payloadify(e.user)),Ur.payloadify(e.appInfo)),{login_ts:e.connectedAt,ping_interval:e.pingInterval,pong_timeout:e.pongTimeout,reconnect:{interval:e.reconnectInterval,max_interval:e.reconnectMaxInterval,retry_cnt:e.reconnectRetryCount,mul:e.reconnectIntervalMultiple},max_unread_cnt_on_super_group:e.maxUnreadCountOnSuperGroup,profile_image_encryption:e.profileImageEncryption,concurrent_call_limit:e.concurrentCallLimit,back_off_delay:e.backOffDelay})},e.prototype.apply=function(){var e=this.reconnectInterval,t=this.reconnectMaxInterval,n=this.reconnectIntervalMultiple,r=fi.of(this._iid);r.sdkState.websocket.pingInterval=1e3*this.pingInterval,r.sdkState.websocket.pongTimeout=1e3*this.pongTimeout,r.sdkState.websocket.reconnectMaxRetry=this.reconnectRetryCount,r.sdkState.websocket.reconnectRetryStrategy={calcTimeout:function(r){return r>0?1e3*Math.min(e*Math.pow(n,r-1),t):10}},r.appInfo=this.appInfo,r.sessionManager.currentUser=this.user,r.connectedAt=this.connectedAt,this.firstConnectedAt||(r.firstConnectedAt=this.connectedAt),r.maxSuperGroupChannelUnreadCount=this.maxUnreadCountOnSuperGroup,r.concurrentCallLimit=this.concurrentCallLimit,r.backOffDelay=this.backOffDelay,r.dispatcher.dispatch(new Yr({userProfile:this}))},e}(),Jr=function(e){function r(t,n,r){var i,s=this;return(s=e.call(this,t,n,r)||this).error=null,s.userProfile=new Xr(t,r),s.deviceTokenLastDeletedAt=r.device_token_last_deleted_at,s.key=r.key,s.ekey=null!==(i=r.ekey)&&void 0!==i?i:"",s.error=r.error?new f(r):null,s}return t(r,e),r.asError=function(e){return new r(null,"LOGI",n({user_id:null,error:!0},e))},r.prototype.applyTo=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return this.error?[3,4]:(t=fi.of(e))?[4,t.sessionManager.login(this)]:[3,2];case 1:return n.sent(),this.userProfile.apply(),[3,3];case 2:throw f.lostInstance;case 3:return[3,5];case 4:throw this.error;case 5:return[2]}}))}))},r}(B),$r=function(e){function n(t){var n=e.call(this)||this;return n.enabled=t,n}return t(n,e),n}(x),ei=function(e){function n(t,n){var r=n.sdkState,i=n.cacheContext,s=n.connectionHandlers,a=n.sessionManager,o=n.websocketClient,u=n.dispatcher,l=n.logger,c=n.entryState,d=void 0===c?new Mr:c,h=e.call(this)||this;return h._currentState=null,h._loginTimer=null,h._unresolvedLogi=null,h._stateUpdatedAt=0,h._connectingAt=0,h._connectionRequestQueue=[],h._iid=t,h.sdkState=r,h.cacheContext=i,h.connectionHandlers=s,h._sessionManager=a,h._websocketClient=o,h._dispatcher=u,h._logger=l,h._currentState=d,h.sdkState.websocket.pingerDisabled||(h._pinger=new Lr({pingDelegate:{send:function(e){return h._websocketClient.send(e)},error:function(e){return h._websocketClient.error(e)}},sdkState:h.sdkState,logger:l})),h._websocketClient.on("open",(function(){h._tryResolveConnectionRequest()})).on("message",(function(e){if("LOGI"===e.code)h.clearLoginTimer(),h._dispatcher.dispatch(e.as(Jr))})).on("ping-refresh",(function(){var e;return null===(e=h._pinger)||void 0===e?void 0:e.refreshTimer()})).on("pong",(function(){var e;return null===(e=h._pinger)||void 0===e?void 0:e.pong()})).on("error",(function(){var e;return null===(e=h._pinger)||void 0===e?void 0:e.stop()})).on("close",(function(){return h._rejectConnectionRequest(f.networkError)})),h._dispatcher.on((function(e){e instanceof Jr&&(h._unresolvedLogi=e,h._tryResolveConnectionRequest())})),h}return t(n,e),Object.defineProperty(n.prototype,"currentState",{get:function(){return this._currentState},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hasSession",{get:function(){return this._sessionManager.auth.hasSession},enumerable:!1,configurable:!0}),n.prototype.changeState=function(e,t){return i(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return t>=this._stateUpdatedAt?(this._currentState=e,this._stateUpdatedAt=t,this._dispatcher.dispatch(new Jn({stateType:e.type})),this._logger.debug("connection state changes to ".concat(e.name)),[4,this._currentState.run(this)]):[3,2];case 1:return n.sent(),[2,!0];case 2:return[2,!1]}}))}))},n.prototype._tryResolveConnectionRequest=function(){var e;return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=this._unresolvedLogi,this._websocketClient.isOpen&&t?(this._unresolvedLogi=null,t.error?[3,2]:[4,t.applyTo(this._iid)]):[3,3];case 1:return r.sent(),n=t.userProfile,this._enableStatLog(n.appInfo.applicationAttributes.includes("allow_sdk_request_log_publish")),this._statLogConnection(null),null===(e=this._pinger)||void 0===e||e.start(),this._connectionRequestQueue.forEach((function(e){return e.resolve()})),this._connectionRequestQueue=[],this.sdkState.appState="foreground",[3,3];case 2:this._sessionManager.auth.authToken=null,(t.error.isSessionKeyExpiredError||t.error.isSessionTokenExpiredError)&&this._dispatcher.dispatch(new z),this._rejectConnectionRequest(t.error),r.label=3;case 3:return[2]}}))}))},n.prototype._rejectConnectionRequest=function(e){var t;null===(t=this._pinger)||void 0===t||t.stop(),this.clearLoginTimer(),this._connectionRequestQueue.length>0&&(this._connectionRequestQueue.forEach((function(t){return t.reject(e)})),this._connectionRequestQueue=[],this._statLogConnection(e))},n.prototype._url=function(e){var t;void 0===e&&(e="");var n=this.sdkState,r=n.appId,i=n.appVersion,s=n.userId,a=n.extensions,o=this.cacheContext.localCacheEnabled,u=this._sessionManager.auth,l=null===(t=this.sdkState.websocket)||void 0===t?void 0:t.compression,c=a.sb_syncmanager?"s".concat(a.sb_syncmanager):"",h=a.sb_uikit?"u".concat(a.sb_uikit):"",p="JS/c".concat(d.SDK_VERSION,"/").concat(c,"/").concat(h);return"".concat(this.sdkState.websocket.host,"/?p=JS&pv=").concat(encodeURIComponent(d.OS_VERSION),"&sv=").concat(encodeURIComponent(d.SDK_VERSION),"&ai=").concat(r).concat(i?"&av=".concat(i):"").concat(u.hasSession?"&key=".concat(encodeURIComponent(u.sessionKey)):"&user_id=".concat(encodeURIComponent(s),"&access_token=").concat(encodeURIComponent(e)),"&pmce=").concat(l?1:0,"&active=1&device_token_types=").concat(encodeURIComponent(["gcm","huawei","apns"].join(",")),"&SB-User-Agent=").concat(p,"&Request-Sent-Timestamp=").concat(Date.now().toString(),"&include_extra_data=").concat(encodeURIComponent(String(["premium_feature_list","file_upload_size_limit","application_attributes","emoji_hash"]))).concat(this._sessionManager.handler?"&expiring_session=1":"","&use_local_cache=").concat(o?1:0,"&include_poll_details=1")},n.prototype._enableStatLog=function(e){this._dispatcher.dispatch(new $r(e))},n.prototype._statLogConnection=function(e){this._dispatcher.dispatch(new G(new j({type:U.WEBSOCKET_CONNECT,data:{host_url:this.sdkState.websocket.host,success:!e,latency:Date.now()-this._connectingAt,error_code:null==e?void 0:e.code,error_description:null==e?void 0:e.message}})))},n.prototype.connect=function(e){return void 0===e&&(e=""),i(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(i){return t=this._url(e),n=new Yn,this._connectionRequestQueue.push(n),1===this._connectionRequestQueue.length&&(this._connectingAt=Date.now(),this._loginTimer=setTimeout((function(){r._loginTimer=null,r._dispatcher.dispatch(Jr.asError(f.loginTimeout))}),this.sdkState.websocket.responseTimeout),this._sessionManager.auth.authToken=e,this._websocketClient.connect(t)),[2,n.promise]}))}))},n.prototype.cancelConnectForRetry=function(){this._dispatcher.dispatch(Jr.asError(f.connectionRenew))},n.prototype.disconnect=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._websocketClient.disconnect()];case 1:return e.sent(),[2]}}))}))},n.prototype.logout=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.sdkState.userId=null,this._unresolvedLogi=null,[4,this._sessionManager.clear()];case 1:return e.sent(),[4,this.disconnect()];case 2:return e.sent(),[2]}}))}))},n.prototype.clearLoginTimer=function(){this._loginTimer&&(clearTimeout(this._loginTimer),this._loginTimer=null)},n}(D),ti=function(){function e(e,t){var n=t.sdkState,r=t.cacheContext,i=t.connectionHandlers,s=t.sessionManager,a=t.websocketClient,o=t.dispatcher,u=t.logger,l=t.disableWebSocketCloseEventHandling,c=void 0!==l&&l;this._context=null,this._disableWebSocketCloseEventHandling=!1,this._logger=u,this._disableWebSocketCloseEventHandling=c,this._context=new ei(e,{sdkState:n,cacheContext:r,connectionHandlers:i,sessionManager:s,websocketClient:a,dispatcher:o,logger:u}),this._sdkState=n,this._sessionManager=s,this._websocketClient=a}return e.prototype._registerEventDispatcher=function(){var e=this;this._disableWebSocketCloseEventHandling||(this._clearEventDispatcher(),this._sessionEventDispatcherContext=this._sessionManager.on("refresh-authtoken",(function(){e.isConnected||(e._logger.debug("try reconnect by session token refresh"),e.reconnect())})).on("refresh",(function(){e.isConnecting||e.isConnected||(e._logger.debug("try reconnect by session key refresh"),e.reconnect())})),this._websocketEventDispatcherContext=this._websocketClient.on("close",(function(){"foreground"===e._sdkState.appState&&(e._sessionManager.isRefreshingAuthToken||(e._logger.debug("try reconnect by websocket connection closed"),e.reconnect()))})))},e.prototype._clearEventDispatcher=function(){this._sessionEventDispatcherContext&&(this._sessionEventDispatcherContext.close(),this._sessionEventDispatcherContext=null),this._websocketEventDispatcherContext&&(this._websocketEventDispatcherContext.close(),this._websocketEventDispatcherContext=null)},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this._context.currentState.type===Hn.CONNECTED},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isConnecting",{get:function(){var e=this._context.currentState;return e.type===Hn.CONNECTING||e.type===Hn.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype.connect=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onConnect(this._context,e)];case 1:return t.sent(),this._registerEventDispatcher(),[2]}}))}))},e.prototype.reconnect=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._context.currentState.onReconnect(this._context,{})];case 1:return e.sent(),[2]}}))}))},e.prototype.resetAndReconnect=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._context.currentState.onReconnect(this._context,{resetReconnectCount:!0})];case 1:return e.sent(),[2]}}))}))},e.prototype.background=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{autoReconnect:!1})];case 1:return e.sent(),[2]}}))}))},e.prototype.disconnect=function(e){return void 0===e&&(e=null),i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._context.currentState.onDisconnect(this._context,{error:e,autoReconnect:!0})];case 1:return t.sent(),[2]}}))}))},e.prototype.disconnectWebSocket=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this._context.currentState.onDisconnectWebSocket(this._context)];case 1:return e.sent(),[2]}}))}))},e.prototype.logout=function(){return i(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return e=this._context.currentState,this._clearEventDispatcher(),[4,e.onLogout(this._context)];case 1:return t.sent(),[2]}}))}))},e}(),ni=function(e){function n(t){var n=t.deviceId,r=t.statLogs,i=e.call(this)||this;return i.method=h.POST,i.path="".concat(pr),i.params={device_id:n,log_entries:r.map((function(e){return j.payloadify(e)}))},i}return t(n,e),n}(P);!function(e){e[e.PENDING=0]="PENDING",e[e.ENABLED=1]="ENABLED",e[e.DISABLED=2]="DISABLED"}(Vr||(Vr={}));var ri,ii=function(){function e(e){var t=e.cacheContext,n=e.requestQueue,r=e.dispatcher,i=e.baseLimit,s=void 0===i?100:i,a=e.maxLimit,o=void 0===a?1e3:a,u=e.minLimit,l=void 0===u?10:u;this.queue=[],this.enabledstate=Vr.PENDING,this.isFlushing=!1,this.generation=1,this.lastFlushedAt=0,this.deviceId=O(),this.cacheContext=t,this.requestQueue=n,this.dispatcher=r,this.baseLimit=s,this.limit=s,this.maxLimit=o,this.minLimit=l}return Object.defineProperty(e.prototype,"isEnabled",{get:function(){return this.enabledstate===Vr.ENABLED},enumerable:!1,configurable:!0}),e.prototype._save=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.cacheContext.localCacheEnabled?[4,this.cacheContext.preference.set(this.key,{deviceId:this.deviceId,statLogs:this.queue.map((function(e){return j.payloadify(e)})),generation:this.generation++,lastFlushedAt:this.lastFlushedAt})]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype._flush=function(){return i(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:if(!this.isEnabled)return[3,7];if(this.isFlushing)return[3,7];this.isFlushing=!0,n.label=1;case 1:return n.trys.push([1,5,6,7]),(e=this.queue.slice(0,Math.min(this.limit,this.maxLimit))).length>0?(t=new ni({deviceId:this.deviceId,statLogs:e}),[4,this.requestQueue.send(t)]):[3,4];case 2:return n.sent(),this.queue=this.queue.slice(e.length),[4,this._save()];case 3:n.sent(),n.label=4;case 4:return this.limit=this.baseLimit,this.lastFlushedAt=Date.now(),[3,7];case 5:return n.sent(),this.limit=this.limit+20,[3,7];case 6:return this.isFlushing=!1,[7];case 7:return[2]}}))}))},e.prototype.init=function(e){return i(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(i){switch(i.label){case 0:return this.key=e,this.cacheContext.localCacheEnabled?[4,this.cacheContext.preference.get(this.key)]:[3,4];case 1:return(t=i.sent())?(this.deviceId=t.deviceId,this.queue=t.statLogs.map((function(e){return new j({type:e.stat_type,ts:e.ts,data:e.data})})),this.generation=t.generation,this.lastFlushedAt=t.lastFlushedAt,Date.now()-this.lastFlushedAt>=108e5&&this.queue.length>=this.minLimit?(n=Math.min(Math.floor(18e4*Math.random()),100),[4,yr(n)]):[3,4]):[3,4];case 2:return i.sent(),[4,this._flush()];case 3:i.sent(),i.label=4;case 4:return this.dispatcher.on((function(e){if(e instanceof G){var t=e.statLog;r.put(t)}else e instanceof $r&&(r.enabledstate=e.enabled?Vr.ENABLED:Vr.DISABLED,r.isEnabled?r.queue.length>=r.limit&&r._flush():r.clear())})),[2]}}))}))},e.prototype.put=function(e){return i(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.enabledstate===Vr.DISABLED?[3,3]:(this.queue.push(e),[4,this._save()]);case 1:return t.sent(),this.queue.length>=this.limit?[4,this._flush()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.clear=function(){return i(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return this.queue=[],this.generation=1,[4,this._save()];case 1:return e.sent(),[2]}}))}))},e}();!function(e){e[e.NONE=0]="NONE",e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARN=4]="WARN",e[e.ERROR=5]="ERROR"}(ri||(ri={}));var si,ai,oi,ui,li,ci,di,hi=function(){function e(){this.level=ri.WARN}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=ri.VERBOSE&&console.log.apply(console,u(["[verbose]"],o(e),!1))},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=ri.DEBUG&&console.log.apply(console,u(["[debug]"],o(e),!1))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=ri.INFO&&console.log.apply(console,u(["[info]"],o(e),!1))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=ri.WARN&&console.warn.apply(console,u(["[warn]"],o(e),!1))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.level<=ri.ERROR&&console.error.apply(console,u(["[error]"],o(e),!1))},e}(),pi={},fi=function(){function e(e,t){var n,r,i,s,a,o,u,l,c;if(this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map,!pi[e]){pi[e]=this;var h=null!==(n=t.options)&&void 0!==n?n:new I,p=this.sdkState={appId:t.appId,appVersion:null!==(r=t.appVersion)&&void 0!==r?r:"",appState:"foreground",userId:null,extensions:{},api:{host:null!==(i=t.apiHost)&&void 0!==i?i:"https://api-".concat(t.appId,".sendbird.com")},websocket:{host:null!==(s=t.websocketHost)&&void 0!==s?s:"wss://ws-".concat(t.appId,".sendbird.com"),pingerDisabled:!!t.noPingpong,pingInterval:null,pongTimeout:null,connectMaxRetry:2,compression:!0,reconnectMaxRetry:-1,reconnectRetryStrategy:new Er,responseTimeout:h.websocketResponseTimeout},sessionTokenRefreshTimeout:h.sessionTokenRefreshTimeout};this.appInfo=null,this.subscribedUnreadMessageCount={all:0,customTypes:{},ts:0};var f=this.logger=new hi;this.logger.level=null!==(a=t.logLevel)&&void 0!==a?a:ri.WARN,this.connectedAt=0,this.firstConnectedAt=0,this.connectionHandlers=new Map,this.userEventHandlers=new Map;var _=this.cacheContext=new N({encryption:t.encryption,store:t.store,localCacheEnabled:null!==(o=t.localCacheEnabled)&&void 0!==o&&o});this.debugMode=null!==(u=t.debugMode)&&void 0!==u&&u,this.maxSuperGroupChannelUnreadCount=d.DEFAULT_MAX_UNREAD_COUNT_OF_SUPER_GROUP_CHANNEL,this.useMemberInfoInMessage=h.useMemberInfoInMessage,this.typingIndicatorInvalidateTime=h.typingIndicatorInvalidateTime,this.typingIndicatorThrottle=h.typingIndicatorThrottle,this.concurrentCallLimit=null,this.backOffDelay=null;var g=this.dispatcher=new M,m=new R;this.requestQueue=new $n(e,{auth:m,sdkState:p,dispatcher:g,logger:f}),this.sessionManager=new Ir({auth:m,cacheContext:_,sdkState:p,dispatcher:g,requestQueue:this.requestQueue,logger:f}),this.connectionManager=new ti(e,{sdkState:p,cacheContext:this.cacheContext,connectionHandlers:this.connectionHandlers,dispatcher:g,sessionManager:this.sessionManager,websocketClient:this.requestQueue.commandRouter.websocketClient,disableWebSocketCloseEventHandling:null!==(l=t.disableWebSocketCloseEventHandling)&&void 0!==l&&l,logger:f}),this.statLogCollector=new ii({cacheContext:this.cacheContext,requestQueue:this.requestQueue,dispatcher:g}),this.appStateToggleEnabled=null===(c=t.appStateToggleEnabled)||void 0===c||c}return pi[e]}return e.of=function(e){if(pi[e])return pi[e];throw f.lostInstance},e.clear=function(e){pi[e]&&delete pi[e]},e}(),_i=function(){function e(){}return e.prototype.init=function(e,t){var n=t.sdkState,r=t.dispatcher,i=t.sessionManager,s=t.requestQueue,a=t.logger;t.onlineDetector;var o=t.cacheContext,u=void 0===o?null:o;this._iid=e,this._cacheContext=u,this._sdkState=n,this._dispatcher=r,this._sessionManager=i,this._requestQueue=s,this._logger=a},e}(),gi=function(e){function n(t){var n=e.call(this)||this;if(n.method=h.POST,n.path="".concat(nr),n.params=L({file:t.file,channel_url:t.channelUrl}),t.thumbnailSizes)for(var r=0;r<t.thumbnailSizes.length;r++){var i=t.thumbnailSizes[r],s=i.maxWidth,a=i.maxHeight;n.params["thumbnail".concat(r+1)]="".concat(s,",").concat(a)}return n.requestId=t.requestId,n}return t(n,e),n}(P),mi=function(e){function n(t,n){var r,i,s,a=this;return(a=e.call(this,t,n)||this).url=n.url,a.fileSize=null!==(r=n.file_size)&&void 0!==r?r:0,a.thumbnailSizes=null!==(i=n.thumbnails)&&void 0!==i?i:[],a.requireAuth=null!==(s=n.require_auth)&&void 0!==s&&s,a}return t(n,e),n}(q);!function(e){e.BASE="base",e.USER="user",e.FILE="file",e.ADMIN="admin"}(si||(si={})),function(e){e.ALL="",e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(ai||(ai={})),function(e){e.USER="MESG",e.FILE="FILE",e.ADMIN="ADMM"}(oi||(oi={})),function(e){e.USERS="users",e.CHANNEL="channel"}(ui||(ui={})),function(e){e.ALL="all",e.NONE="none",e.ONLY_REPLY_TO_CHANNEL="only_reply_to_channel"}(li||(li={})),function(e){e.DEFAULT="default",e.SUPPRESS="suppress"}(ci||(ci={})),function(e){e.PENDING="pending",e.SCHEDULED="scheduled",e.SUCCEEDED="succeeded",e.FAILED="failed",e.CANCELED="canceled"}(di||(di={}));var vi,yi=function(e){function r(t,n){var r,i,s,a=this;return(a=e.call(this,t)||this).replyCount=0,a.mostRepliedUsers=null,a.lastRepliedAt=0,a.updatedAt=0,a.replyCount=null!==(r=n.reply_count)&&void 0!==r?r:0,a.mostRepliedUsers=n.hasOwnProperty("most_replies")&&b("object",n.most_replies)?n.most_replies.map((function(e){return new Wr(a._iid,e)})):[],a.lastRepliedAt=null!==(i=n.last_replied_at)&&void 0!==i?i:0,a.updatedAt=null!==(s=n.updated_at)&&void 0!==s?s:0,a}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{reply_count:t.replyCount,most_replies:Array.isArray(t.mostRepliedUsers)?t.mostRepliedUsers.map((function(e){return Wr.payloadify(e)})):[],last_replied_at:t.lastRepliedAt,updated_at:t.updatedAt})):null},r}(Pr);!function(e){e.ADD="add",e.DELETE="delete"}(vi||(vi={}));var Ei,bi,wi,Si,Ti=function(e){this.messageId=0,this.userId=null,this.key=null,this.operation=null,this.updatedAt=0;var t=v("string",e.msg_id)?parseInt(e.msg_id):e.msg_id,n=e.user_id,r=e.operation?e.operation.toLowerCase():null,i=e.reaction,s=e.updated_at;t&&v("string",n)&&v("string",r)&&y(vi,r)&&v("string",i)&&i&&v("number",s)&&(this.messageId=t,this.userId=n,this.key=i,this.operation=r,this.updatedAt=s)},Ii=function(){function e(e){var t,n,r,i=e.key,s=null!==(r=u([],o(e.user_ids),!1))&&void 0!==r?r:[],l=e.updated_at;v("string",i)&&i&&b("string",s)&&s.length>0&&v("number",l)&&(this.key=i,this.userIds=s,this.updatedAt=l);var c={};try{for(var d=a(this.userIds),h=d.next();!h.done;h=d.next()){c[h.value]=this.updatedAt}}catch(e){t={error:e}}finally{try{h&&!h.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}this._version=c}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.userIds.length},enumerable:!1,configurable:!0}),e.payloadify=function(e){return e?L({key:e.key,user_ids:e.userIds,updated_at:e.updatedAt}):null},e.prototype.applyEvent=function(e){if(e.key===this.key&&this.updatedAt<=e.updatedAt){if(!this._version[e.userId]||this._version[e.userId]<=e.updatedAt){var t=this.userIds.indexOf(e.userId);switch(e.operation){case vi.ADD:t<0&&this.userIds.push(e.userId);break;case vi.DELETE:t>=0&&this.userIds.splice(t,1)}this._version[e.userId]=e.updatedAt}this.updatedAt=Math.max(this.updatedAt,e.updatedAt)}},e}(),ki=function(){function e(e){this.key=e.key,this.value=b("string",e.value)?u([],o(e.value),!1):[]}return e.payloadify=function(e){var t;return e?L({key:e.key,value:null!==(t=e.value)&&void 0!==t?t:[]}):null},e}(),Ai=function(){function e(e){this.url=null,this.secureUrl=null,this.type=null,this.width=0,this.height=0,this.alt=null,this.url=e.url,e.hasOwnProperty("secure_url")&&(this.secureUrl=e.secure_url),e.hasOwnProperty("type")&&(this.type=e.type),e.hasOwnProperty("width")&&(this.width=e.width),e.hasOwnProperty("height")&&(this.height=e.height),e.hasOwnProperty("alt")&&(this.alt=e.alt)}return e.payloadify=function(e){var t,n;return e?L({url:e.url,secure_url:e.secureUrl,type:e.type,width:null!==(t=e.width)&&void 0!==t?t:0,height:null!==(n=e.height)&&void 0!==n?n:0,alt:e.alt}):null},e}(),Ni=function(){function e(e){this.title=null,this.url=null,this.description=null,this.defaultImage=null,e.hasOwnProperty("og:title")&&(this.title=e["og:title"]),e.hasOwnProperty("og:url")&&(this.url=e["og:url"]),e.hasOwnProperty("og:description")&&(this.description=e["og:description"]),e.hasOwnProperty("og:image")&&(this.defaultImage=new Ai(e["og:image"]))}return e.payloadify=function(e){return e?L({"og:title":e.title,"og:url":e.url,"og:description":e.description,"og:image":e.defaultImage?Ai.payloadify(e.defaultImage):null}):null},e}(),Ri=function(){function e(e){var t,n;this.name=null,this.volume=0,this.name=null!==(t=e.name)&&void 0!==t?t:"default",this.volume=null!==(n=e.volume)&&void 0!==n?n:1}return e.prototype.serialize=function(){return{name:this.name,volume:this.volume}},e.payloadify=function(e){return e?L({name:e.name,volume:e.volume}):null},e}();!function(e){e.BASE="base",e.GROUP="group",e.OPEN="open"}(Ei||(Ei={})),function(e){e.OPERATOR="operator",e.NONE="none"}(bi||(bi={})),function(e){e.PENDING="pending",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled"}(wi||(wi={})),function(e){e.PENDING="pending",e.IN_QUEUE="in_queue",e.SENT="sent",e.FAILED="failed",e.CANCELED="canceled",e.REMOVED="removed"}(Si||(Si={}));var Oi,Ci=function(e){switch(e){case si.BASE:return"";case si.USER:return"MESG";case si.FILE:return"FILE";case si.ADMIN:return"ADMM"}},Di=function(e){function r(t,n){var r,i,s,a,o,u,l,c,d,h,p,f,_,g,m=this;(m=e.call(this,t)||this).channelUrl=null,m.channelType=Ei.BASE,m.messageId=0,m.parentMessageId=null,m.parentMessage=null,m.silent=!1,m.isOperatorMessage=!1,m.messageType=si.BASE,m.data=null,m.customType=null,m.mentionType=null,m.mentionedUsers=[],m.mentionedUserIds=[],m.mentionedMessageTemplate=null,m.threadInfo=null,m.reactions=[],m.metaArrays=[],m.ogMetaData=null,m.appleCriticalAlertOptions=null,m.createdAt=0,m.updatedAt=0,m.scheduledInfo=null,m.extendedMessage={},m._scheduledStatus=null,m.messageId=null!==(i=null!==(r=n.msg_id)&&void 0!==r?r:n.message_id)&&void 0!==i?i:0,m.channelUrl=n.channel_url,m.channelType=y(Ei,n.channel_type)?n.channel_type:Ei.GROUP,n.channel&&(n.channel.channel_url&&(m.channelUrl=n.channel.channel_url),n.channel.channel_type&&(m.channelType=n.channel.channel_type)),m.parentMessageId=null!==(s="string"==typeof n.parent_message_id?parseInt(n.parent_message_id):n.parent_message_id)&&void 0!==s?s:0,m.data=null!==(a=n.data)&&void 0!==a?a:"",m.customType=null!==(o=n.custom_type)&&void 0!==o?o:"",m.mentionType=y(ui,n.mention_type)?n.mention_type:null;var v=n.mentioned_users;m.mentionedUsers=v?v.map((function(e){return new Wr(m._iid,e)})):null;var E=n.mentioned_user_ids;m.mentionedUserIds=null!=E?E:null,m.mentionedUsers&&!m.mentionedUserIds&&(m.mentionedUserIds=m.mentionedUsers.map((function(e){return e.userId}))),m.mentionedMessageTemplate=null!==(u=n.mentioned_message_template)&&void 0!==u?u:"",m.threadInfo=n.thread_info?new yi(m._iid,n.thread_info):null,m.reactions=n.reactions?n.reactions.map((function(e){return new Ii(e)})):[];for(var b=null!==(l=n.metaarray)&&void 0!==l?l:{},w=null!==(c=n.metaarray_key_order)&&void 0!==c?c:Object.keys(b).sort((function(e,t){return e.localeCompare(t)})),S=0;S<w.length;S++){var T=w[S];m.metaArrays.push(new ki({key:T,value:b[T]||[]}))}return n.sorted_metaarray&&(m.metaArrays=n.sorted_metaarray.map((function(e){return new ki(e)}))),m.ogMetaData=n.og_tag?new Ni(n.og_tag):null,m.silent=null!==(d=n.silent)&&void 0!==d&&d,m.isOperatorMessage=null!==(h=n.is_op_msg)&&void 0!==h&&h,m.appleCriticalAlertOptions=n.apple_critical_alert_options?new Ri(n.apple_critical_alert_options):null,m.createdAt=null!==(f=null!==(p=n.created_at)&&void 0!==p?p:n.ts)&&void 0!==f?f:0,m.updatedAt=null!==(_=n.updated_at)&&void 0!==_?_:0,"number"==typeof n.scheduled_message_id&&"number"==typeof n.scheduled_at&&n.scheduled_status&&(m.scheduledInfo={scheduledMessageId:n.scheduled_message_id,scheduledAt:n.scheduled_at},m._scheduledStatus=n.scheduled_status),m.extendedMessage=null!==(g=n.extended_message)&&void 0!==g?g:{},m}return t(r,e),r.payloadify=function(t){var r,i,s,a;return t?L(n(n({},e.payloadify.call(this,t)),{channel_url:t.channelUrl,channel_type:t.channelType,message_id:t.messageId,type:Ci(t.messageType),parent_message_id:t.parentMessageId,data:t.data,custom_type:t.customType,mention_type:t.mentionType,mentioned_user_ids:t.mentionedUserIds,mentioned_users:null===(r=t.mentionedUsers)||void 0===r?void 0:r.map((function(e){return Wr.payloadify(e)})),mentioned_message_template:t.mentionedMessageTemplate,thread_info:t.threadInfo?yi.payloadify(t.threadInfo):null,reactions:t.reactions.map((function(e){return Ii.payloadify(e)})),sorted_metaarray:null===(i=t.metaArrays)||void 0===i?void 0:i.map((function(e){return ki.payloadify(e)})),og_tag:Ni.payloadify(t.ogMetaData),silent:t.silent,is_op_msg:t.isOperatorMessage,apple_critical_alert_options:Ri.payloadify(t.appleCriticalAlertOptions),created_at:t.createdAt,updated_at:t.updatedAt,scheduled_message_id:null===(s=t.scheduledInfo)||void 0===s?void 0:s.scheduledMessageId,scheduled_at:null===(a=t.scheduledInfo)||void 0===a?void 0:a.scheduledAt,scheduled_status:t._scheduledStatus,extended_message:t.extendedMessage})):null},r.prototype.isIdentical=function(e){return this.messageId===e.messageId},r.prototype.isEqual=function(e){return m(this,e)},r.prototype.isUserMessage=function(){return this.messageType===si.USER},r.prototype.isFileMessage=function(){return this.messageType===si.FILE},r.prototype.isAdminMessage=function(){return this.messageType===si.ADMIN},r.prototype.serialize=function(){return Kr(this)},r.prototype.getMetaArraysByKeys=function(e){return this.metaArrays.filter((function(t){return e.includes(t.key)}))},r.prototype.applyThreadInfoUpdateEvent=function(e){return this.messageId===e.targetMessageId&&(this.threadInfo=e.threadInfo),!1},r.prototype.applyReactionEvent=function(e){if(this.messageId===e.messageId){for(var t=!1,n=0;n<this.reactions.length;n++)if(this.reactions[n].key===e.key){this.reactions[n].applyEvent(e),this.reactions[n].isEmpty&&this.reactions.splice(n,1),t=!0;break}t||"add"!==e.operation||this.reactions.push(new Ii(Ii.payloadify({key:e.key,userIds:[e.userId],updatedAt:e.updatedAt})))}},r.prototype.applyParentMessage=function(e){if(this.parentMessageId===e.messageId){var t=this.parentMessage.updatedAt;if(e.updatedAt>=t)return this.parentMessage=e,!0}return!1},r}(Pr),Mi=function(e){function r(t,n){var r=e.call(this,t,n)||this;return r.role=null,r.isBlockedByMe=!1,r.role=y(bi,n.role)?n.role:bi.NONE,n.hasOwnProperty("is_blocked_by_me")&&(r.isBlockedByMe=n.is_blocked_by_me),r}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{role:t.role,is_blocked_by_me:t.isBlockedByMe})):null},r}(Wr),xi=function(e){function r(t,n){var r,i,s,a,o=this;if((o=e.call(this,t,n)||this).sender=null,o.reqId="",o.replyToChannel=!1,o.sendingStatus=null,o.errorCode=0,o.sender=n.user?new Mi(o._iid,n.user):n.sender_id,o.reqId=null!==(i=null!==(r=n.req_id)&&void 0!==r?r:n.request_id)&&void 0!==i?i:"",o.replyToChannel=null!==(s=n.is_reply_to_channel)&&void 0!==s&&s,n.request_state&&y(di,n.request_state)&&(o.sendingStatus=n.request_state),!o.sendingStatus)if(o.messageId>0)o.sendingStatus=di.SUCCEEDED;else if(o.scheduledInfo)switch(o._scheduledStatus=n.scheduled_status,n.scheduled_status){case Si.SENT:case Si.IN_QUEUE:o.sendingStatus=di.SUCCEEDED;break;case Si.PENDING:o.sendingStatus=di.SCHEDULED;break;case Si.FAILED:case Si.REMOVED:o.sendingStatus=di.FAILED;break;case Si.CANCELED:o.sendingStatus=di.CANCELED}else o.sendingStatus=di.PENDING;return o.errorCode=null!==(a=n.error_code)&&void 0!==a?a:0,o}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{user:Mi.payloadify(t.sender),req_id:t.reqId,is_reply_to_channel:t.replyToChannel,request_state:t.sendingStatus,error_code:t.errorCode})):null},Object.defineProperty(r.prototype,"isResendable",{get:function(){return this.sendingStatus===di.FAILED&&((e=this.errorCode)>0&&_.indexOf(e)>=0);var e},enumerable:!1,configurable:!0}),r.prototype.isIdentical=function(e){return this.messageId>0&&e.messageId>0?this.messageId===e.messageId:this.reqId===e.reqId},r}(Di),Li=function(){function e(e){var t,n;this.url=null,this.width=0,this.height=0,this.realWidth=0,this.realHeight=0,this.url=e.url,this.width=e.width,this.height=e.height,this.realWidth=null!==(t=e.real_width)&&void 0!==t?t:e.width,this.realHeight=null!==(n=e.real_height)&&void 0!==n?n:e.height}return e.payloadify=function(e){return e?L({url:"",width:e.maxWidth,height:e.maxHeight,real_width:0,real_height:0}):null},Object.defineProperty(e.prototype,"plainUrl",{get:function(){return this.url.split("?auth=")[0]},enumerable:!1,configurable:!0}),e}(),Ui={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:ai.ALL,customTypesFilter:null,senderUserIdsFilter:null,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1},Pi=function(e){return v("number",e.prevResultSize)&&v("number",e.nextResultSize)&&v("boolean",e.isInclusive)&&v("boolean",e.reverse)&&v("string",e.messageTypeFilter)&&y(ai,e.messageTypeFilter)&&b("string",e.customTypesFilter,!0)&&b("string",e.senderUserIdsFilter,!0)&&v("boolean",e.includeMetaArray)&&v("boolean",e.includeReactions)&&v("boolean",e.includeParentMessageInfo)},qi=function(e){function r(t,r){var i,s,a,o,u=this;if((u=e.call(this,t,r)||this).message=null,u.translations={},u.message=null!==(i=r.message)&&void 0!==i?i:"",u.messageType=si.ADMIN,u.translations=null!==(s=r.translations)&&void 0!==s?s:{},r.parent_message_info){var l=r.parent_message_info,c=n(n({},l),{message_id:u.parentMessageId,channel_url:u.channelUrl,channel_type:u.channelType,file:l.file,url:null===(a=l.file)||void 0===a?void 0:a.url,require_auth:null===(o=l.file)||void 0===o?void 0:o.require_auth});u.parentMessage=Wi(t,c)}return u}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,parent_message_info:Vi(t.parentMessage)})):null},r.prototype.getThreadedMessagesByTimestamp=function(e,t){return i(this,void 0,void 0,(function(){var r;return s(this,(function(i){switch(i.label){case 0:return r=n(n({},Ui),t),Zr(this.messageId>0&&v("number",e)&&Pi(r)).throw(f.invalidParameters),[4,Ns.of(this._iid).getThreadedMessagesByTimestamp(this,e,r)];case 1:return[2,i.sent()]}}))}))},r}(Di),Fi=function(){function e(e){var t,n;this.type=null,this.vendor=null,this.detail={},this.type=null!==(t=e.type)&&void 0!==t?t:"",this.vendor=null!==(n=e.vendor)&&void 0!==n?n:"",e.hasOwnProperty("detail")&&v("object",e.detail)&&!Array.isArray(e.detail)&&(this.detail=e.detail)}return e.payloadify=function(e){return e?L({type:e.type,vendor:e.vendor,detail:e.detail}):null},e}();!function(e){e.OPEN="open",e.CLOSED="closed"}(Oi||(Oi={}));var zi,Gi="removed",ji=function(e){switch(e){case Oi.OPEN:return Oi.OPEN;case Oi.CLOSED:return Oi.CLOSED}},Qi=function(e){return!e||e.text&&v("string",e.text)},Bi=function(e){return b("string",e)&&e.every((function(e){return""!==e.trim()}))},Ki=function(e){function r(t,n){var r,i,s,a,o,u,l,c=this;return(c=e.call(this,t)||this).pollId=0,c.id=0,c.text=null,c.voteCount=0,c.createdBy=null,c.createdAt=0,c.updatedAt=0,c._lastVotedAt=0,c.pollId=null!==(r=n.poll_id)&&void 0!==r?r:0,c.id=null!==(i=n.id)&&void 0!==i?i:0,c.text=null!==(s=n.text)&&void 0!==s?s:null,c.voteCount=null!==(a=n.vote_count)&&void 0!==a?a:0,c.createdBy=null!==(o=n.created_by)&&void 0!==o?o:null,c.createdAt=null!==(u=n.created_at)&&void 0!==u?u:0,c.updatedAt=null!==(l=n.updated_at)&&void 0!==l?l:0,c}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{vote_count:t.voteCount,poll_id:t.pollId,text:t.text,created_at:t.createdAt,id:t.id,created_by:t.createdBy,updated_at:t.updatedAt})):null},r}(Pr),Hi=function(e){function r(t,n){var r,i,s,a,o,u,l,c,d,h,p,f,_,g=this;return(g=e.call(this,t)||this).id=0,g.title=null,g.createdAt=0,g.updatedAt=0,g.closeAt=-1,g.status=Oi.CLOSED,g.messageId=0,g.data=null,g.voterCount=-1,g.options=[],g.createdBy=null,g.allowUserSuggestion=!1,g.allowMultipleVotes=!1,g.votedPollOptionIds=[],g.id=null!==(r=n.id)&&void 0!==r?r:0,g.title=null!==(i=n.title)&&void 0!==i?i:null,g.createdAt=null!==(s=n.created_at)&&void 0!==s?s:0,g.updatedAt=null!==(a=n.updated_at)&&void 0!==a?a:0,g.closeAt=null!==(o=n.close_at)&&void 0!==o?o:-1,g.status=null!==(u=ji(n.status))&&void 0!==u?u:Oi.CLOSED,g.messageId=null!==(l=n.message_id)&&void 0!==l?l:0,g.data=null!==(c=n.data)&&void 0!==c?c:null,g.voterCount=null!==(d=n.voter_count)&&void 0!==d?d:-1,g.options=n.options?n.options.map((function(e){return new Ki(g._iid,e)})):[],g.createdBy=null!==(h=n.created_by)&&void 0!==h?h:null,g.allowUserSuggestion=null!==(p=n.allow_user_suggestion)&&void 0!==p&&p,g.allowMultipleVotes=null!==(f=n.allow_multiple_votes)&&void 0!==f&&f,g.votedPollOptionIds=null!==(_=n.voted_option_ids)&&void 0!==_?_:[],g}return t(r,e),r.prototype._applyPollUpdatePayload=function(e){var t,n,r,i,s,a,o,u,l=this;this.title=null!==(t=e.title)&&void 0!==t?t:this.title,this.updatedAt=null!==(n=e.updated_at)&&void 0!==n?n:this.updatedAt,this.closeAt=null!==(r=e.close_at)&&void 0!==r?r:this.closeAt,this.status=null!==(i=ji(e.status))&&void 0!==i?i:this.status,this.data=null!==(s=e.data)&&void 0!==s?s:this.data,this.voterCount=null!==(a=e.voter_count)&&void 0!==a?a:this.voterCount,e.options&&(this.options=e.options.map((function(e){return new Ki(l._iid,e)})),this.votedPollOptionIds=e.options.filter((function(e){return e.vote_count>0})).map((function(e){return e.id}))),this.allowUserSuggestion=null!==(o=e.allow_user_suggestion)&&void 0!==o?o:this.allowUserSuggestion,this.allowMultipleVotes=null!==(u=e.allow_multiple_votes)&&void 0!==u?u:this.allowMultipleVotes},r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{id:t.id,title:t.title,created_at:t.createdAt,updated_at:t.updatedAt,close_at:t.closeAt,status:t.status,message_id:t.messageId,data:t.data,voter_count:t.voterCount,options:t.options.map((function(e){return Ki.payloadify(e)})),created_by:t.createdBy,allow_user_suggestion:t.allowUserSuggestion,allow_multiple_votes:t.allowMultipleVotes,voted_option_ids:t.votedPollOptionIds})):null},r.prototype.applyPollUpdateEvent=function(e){var t=e._payload.poll;return!(!t||this.id!==t.id||t.updated_at<this.updatedAt)&&(this._applyPollUpdatePayload(t),!0)},r.prototype.applyPollVoteEvent=function(e){if(this.id!==e.pollId)return!1;var t=this.options,n=t.map((function(e){return e.id})),r=e._payload,i=Math.floor(r.ts/1e3);return r.updated_vote_counts.forEach((function(e){var r=n.indexOf(e.option_id);if(r>-1){var s=t[r];i>=s._lastVotedAt&&(s.voteCount=e.vote_count,s._lastVotedAt=i)}})),r.req_id&&r.voted_option_ids&&(this.votedPollOptionIds=r.voted_option_ids),!0},r.prototype.serialize=function(){return Kr(this)},r}(Pr),Zi=function(e){function r(t,r){var i,s,o,u,l,c,d,h=this;if((h=e.call(this,t,r)||this).message="",h.messageParams=null,h.translations={},h.translationTargetLanguages=[],h.messageSurvivalSeconds=-1,h.plugins=[],h._poll=null,h.message=r.message,h.messageType=si.USER,h.translations=null!==(o=r.translations)&&void 0!==o?o:{},h.translationTargetLanguages=null!==(u=r.target_langs)&&void 0!==u?u:[],0===Object.keys(h.translations).length&&h.translationTargetLanguages.length>0)try{for(var p=a(h.translationTargetLanguages),f=p.next();!f.done;f=p.next()){var _=f.value;h.translations[_]=""}}catch(e){i={error:e}}finally{try{f&&!f.done&&(s=p.return)&&s.call(p)}finally{if(i)throw i.error}}if(h.messageSurvivalSeconds=null!==(l=r.message_survival_seconds)&&void 0!==l?l:-1,h.plugins=r.plugins?r.plugins.map((function(e){return new Fi(e)})):[],h._poll=r.poll?new Hi(h._iid,r.poll):null,r.parent_message_info){var g=r.parent_message_info,m=n(n({},g),{created_at:g.ts,message_id:h.parentMessageId,channel_url:h.channelUrl,channel_type:h.channelType,file:g.file,url:null===(c=g.file)||void 0===c?void 0:c.url,require_auth:null===(d=g.file)||void 0===d?void 0:d.require_auth});h.parentMessage=Wi(t,L(m))}return h}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{message:t.message,translations:t.translations,message_survival_seconds:t.messageSurvivalSeconds,plugins:t.plugins.map((function(e){return Fi.payloadify(e)})),poll:Hi.payloadify(t._poll),parent_message_info:Vi(t.parentMessage)})):null},r.prototype.getThreadedMessagesByTimestamp=function(e,t){return i(this,void 0,void 0,(function(){var r;return s(this,(function(i){switch(i.label){case 0:return r=n(n({},Ui),t),Zr(this.messageId>0&&v("number",e)&&Pi(r)).throw(f.invalidParameters),[4,Ns.of(this._iid).getThreadedMessagesByTimestamp(this,e,r)];case 1:return[2,i.sent()]}}))}))},r.prototype.applyPoll=function(e){return!(this._poll&&this._poll.id===e.id&&this._poll.updatedAt>e.updatedAt)&&(this._poll=e,!0)},Object.defineProperty(r.prototype,"poll",{get:function(){return this._poll},enumerable:!1,configurable:!0}),r}(xi),Vi=function(e){if(e)switch(e.messageType){case si.USER:return Zi.payloadify(e);case si.FILE:return Yi.payloadify(e);case si.ADMIN:return qi.payloadify(e)}return null},Wi=function(e,t){switch(t.type){case"MESG":return new Zi(e,t);case"FILE":return new Yi(e,t);case"ADMM":case"BRDM":return new qi(e,t)}return null},Yi=function(e){function r(t,r){var i,s,a,o,u,l,c,d,h,p,f,_,g,m,v,y=this;(y=e.call(this,t,r)||this).messageParams=null,y.plainUrl="",y.requireAuth=!1,y.name=null,y.size=0,y.type=null,y.thumbnails=[],y.messageSurvivalSeconds=-1,y.messageType=si.FILE;var E=null!==(i=r.file)&&void 0!==i?i:null;y.plainUrl=(null!==(a=null!==(s=null==E?void 0:E.url)&&void 0!==s?s:r.url)&&void 0!==a?a:"").split("?auth=")[0],y.name=null!==(u=null!==(o=null==E?void 0:E.name)&&void 0!==o?o:r.name)&&void 0!==u?u:"File",y.size=null!==(c=null!==(l=null==E?void 0:E.size)&&void 0!==l?l:r.size)&&void 0!==c?c:0,y.data=null!==(h=null!==(d=null==E?void 0:E.data)&&void 0!==d?d:r.custom)&&void 0!==h?h:"",y.type=E?null!==(p=E.type)&&void 0!==p?p:"":null!==(f=r.type)&&void 0!==f?f:"";var b=fi.of(y._iid).sessionManager;if(y.requireAuth=null!==(_=r.require_auth)&&void 0!==_&&_,y.thumbnails=r.thumbnails?r.thumbnails.map((function(e){return new Li(n(n({},e),{url:"".concat(e.url.split("?auth=")[0]).concat(y.requireAuth?"?auth=".concat(b.ekey):"")}))})):[],y.messageSurvivalSeconds=null!==(g=r.message_survival_seconds)&&void 0!==g?g:-1,r.parent_message_info){var w=r.parent_message_info,S=n(n({},w),{message_id:y.parentMessageId,channel_url:y.channelUrl,channel_type:y.channelType,file:w.file,url:null===(m=w.file)||void 0===m?void 0:m.url,require_auth:null===(v=w.file)||void 0===v?void 0:v.require_auth});y.parentMessage=Wi(t,S)}return y}return t(r,e),r.payloadify=function(t){return t?L(n(n({},e.payloadify.call(this,t)),{url:t.plainUrl,require_auth:t.requireAuth,file:{name:t.name,size:t.size,type:t.type,data:t.data},thumbnails:t.thumbnails.map((function(e){return{url:e.url,width:e.width,height:e.height,real_width:e.realWidth,real_height:e.realHeight}})),message_survival_seconds:t.messageSurvivalSeconds,parent_message_info:Vi(t.parentMessage)})):null},Object.defineProperty(r.prototype,"url",{get:function(){var e=fi.of(this._iid).sessionManager;return this.requireAuth?"".concat(this.plainUrl,"?auth=").concat(e.ekey):this.plainUrl},enumerable:!1,configurable:!0}),r.prototype.getThreadedMessagesByTimestamp=function(e,t){return i(this,void 0,void 0,(function(){var r;return s(this,(function(i){switch(i.label){case 0:return r=n(n({},Ui),t),Zr(this.messageId>0&&v("number",e)&&Pi(r)).throw(f.invalidParameters),[4,Ns.of(this._iid).getThreadedMessagesByTimestamp(this,e,r)];case 1:return[2,i.sent()]}}))}))},r}(xi),Xi=function(e){switch(e){case Ei.GROUP:return rr;case Ei.OPEN:return sr;default:return null}},Ji=function(e){switch(e){case Ei.GROUP:return"".concat(ur,"/group_channels");case Ei.OPEN:return"".concat(ur,"/open_channels");default:return null}},$i=function(e,t,n){var r,i;switch(e){case ui.CHANNEL:return!0;case ui.USERS:if(t)try{for(var s=a(t),o=s.next();!o.done;o=s.next()){if(o.value===n)return!0}}catch(e){r={error:e}}finally{try{o&&!o.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}return!1},es=function(e,t,n){var r=$i(e.mentionType,e.mentionedUserIds,n),i=$i(t.mentionType,t.mentionedUserIds,n);return!r&&i?1:r&&!i?-1:0},ts=function(e){function n(t){var n,r,i,s=[];return t.mentionType===ui.USERS&&(t.mentionedUserIds?s=t.mentionedUserIds:t.mentionedUsers&&(s=t.mentionedUsers.map((function(e){return e.userId})))),e.call(this,{code:"FILE",ackRequired:!0,payload:L({channel_url:t.channelUrl,url:t.url,name:null!==(n=t.fileName)&&void 0!==n?n:"",type:null!==(r=t.mimeType)&&void 0!==r?r:"",size:null!==(i=t.fileSize)&&void 0!==i?i:0,custom:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes,require_auth:t.requireAuth,metaarray:t.metaArrays,mention_type:t.mentionType,mentioned_user_ids:s,push_option:t.pushNotificationDeliveryOption&&t.pushNotificationDeliveryOption!==ci.DEFAULT?t.pushNotificationDeliveryOption:void 0,apple_critical_alert_options:t.appleCriticalAlertOptions,silent:t.silent,reply_to_channel:t.isReplyToChannel,parent_message_id:t.parentMessageId>0?t.parentMessageId:null,req_id:t.reqId,pin_message:t.isPinnedMessage})})||this}return t(n,e),n}(Vn),ns=function(e){function n(t){var n,r=this;r=e.call(this)||this;var i=[];return t.mentionType===ui.USERS&&(t.mentionedUserIds?i=t.mentionedUserIds:t.mentionedUsers&&(i=t.mentionedUsers.map((function(e){return e.userId})))),r.method=h.POST,r.path="".concat(Xi(t.channelType),"/").concat(encodeURIComponent(t.channelUrl),"/messages"),r.params=L({message_type:si.FILE,user_id:t.userId,url:t.fileUrl,mention_type:t.mentionType,mentioned_user_ids:i,file_name:t.fileName,file_size:t.fileSize,file_type:t.mimeType,data:t.data,custom_type:t.customType,thumbnails:t.thumbnailSizes.map((function(e){return Li.payloadify(e)})),require_auth:t.requireAuth,sorted_metaarray:null===(n=t.metaArrays)||void 0===n?void 0:n.map((function(e){return ki.payloadify(e)})),push_option:t.pushNotificationDeliveryOption,parent_message_id:t.parentMessageId>0?t.parentMessageId:null,apple_critical_alert_options:Ri.payloadify(t.appleCriticalAlertOptions),reply_to_channel:t.isReplyToChannel,req_id:t.reqId,pin_message:t.isPinnedMessage}),r}return t(n,e),n}(P),rs=function(e){function n(t,n,r){var i,s,a,o=this;(o=e.call(this,t,"FILE",r)||this).message=new Yi(t,r);var u=fi.of(t).sdkState;return o.isMentioned=$i(o.message.mentionType,null!==(i=o.message.mentionedUserIds)&&void 0!==i?i:null===(s=o.message.mentionedUsers)||void 0===s?void 0:s.map((function(e){return e.userId})),u.userId),o.forceUpdateLastMessage=null!==(a=r.force_update_last_message)&&void 0!==a&&a,o}return t(n,e),n}(B),is=function(e){function n(t,n){var r,i,s=this;(s=e.call(this,t,n)||this).message=new Yi(t,n);var a=fi.of(t).sdkState;return s.isMentioned=$i(s.message.mentionType,null!==(r=s.message.mentionedUserIds)&&void 0!==r?r:s.message.mentionedUsers.map((function(e){return e.userId})),a.userId),s.forceUpdateLastMessage=null!==(i=n.force_update_last_message)&&void 0!==i&&i,s}return t(n,e),n}(q);!function(e){e[e.PENDING=0]="PENDING",e[e.UPLOADING=1]="UPLOADING",e[e.UPLOADED=2]="UPLOADED",e[e.SENDING=3]="SENDING",e[e.FAILED=4]="FAILED"}(zi||(zi={}));var ss,as=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,a=t.cacheContext,o=this;this._queueMap=new Map,this._connectionState=null,this._onlineDetector=null,this._iid=e,this._sdkState=n,this._requestQueue=i,this._cacheContext=a,this._dispatcher=r,this._dispatcher.on((function(e){e instanceof Jn&&(o._connectionState=e.stateType)})),this._onlineDetector=s}return Object.defineProperty(e.prototype,"_shouldSendThroughWebSocket",{get:function(){return this._connectionState===Hn.CONNECTED||this._connectionState===Hn.CONNECTING||this._connectionState===Hn.RECONNECTING},enumerable:!1,configurable:!0}),e.prototype._sendFileMessage=function(e,t){return i(this,void 0,void 0,(function(){var r,i;return s(this,(function(s){switch(s.label){case 0:return this._shouldSendThroughWebSocket?(r=new ts(n(n({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(r)]):[3,2];case 1:return i=s.sent(),[2,i.as(rs).message];case 2:return r=new ns(n(n({},t.params),{channelUrl:e.url,channelType:e.channelType,url:t.params.fileUrl,userId:this._sdkState.userId,requireAuth:t.requireAuth,reqId:t.requestId})),[4,this._requestQueue.send(r)];case 3:return i=s.sent(),[2,i.as(is).message]}}))}))},e.prototype._resolveMessageQueue=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,o,u,c,d,h,p,_,g;return s(this,(function(s){switch(s.label){case 0:if(!(t=this._queueMap.get(e.url)))return[3,21];if(t.isResolving)return[3,20];t.isResolving=!0,n=[],r=!0,s.label=1;case 1:s.trys.push([1,15,16,17]),i=a(t.messageQueue),o=i.next(),s.label=2;case 2:if(o.done)return[3,14];switch(u=o.value,u.state){case zi.PENDING:case zi.UPLOADING:return[3,3];case zi.UPLOADED:return[3,4];case zi.FAILED:return[3,12]}return[3,13];case 3:return r=!1,n.push(u),[3,13];case 4:if(!r)return[3,10];s.label=5;case 5:return s.trys.push([5,8,,9]),u.state=zi.SENDING,[4,this._sendFileMessage(e,u)];case 6:return c=s.sent(),u.deferred.resolve(c),[4,yr(100)];case 7:return s.sent(),[3,9];case 8:return d=s.sent(),u.deferred.reject(d),[3,9];case 9:return[3,11];case 10:n.push(u),s.label=11;case 11:return[3,13];case 12:return u.deferred.reject(u.error.code===l.REQUEST_CANCELED?f.fileUploadCanceled:u.error),[3,13];case 13:return o=i.next(),[3,2];case 14:return[3,17];case 15:return h=s.sent(),_={error:h},[3,17];case 16:try{o&&!o.done&&(g=i.return)&&g.call(i)}finally{if(_)throw _.error}return[7];case 17:return p=t.isResolveRequestPending,t.messageQueue=n,t.isResolving=!1,t.isResolveRequestPending=!1,p?[4,this._resolveMessageQueue(e)]:[3,19];case 18:s.sent(),s.label=19;case 19:return[3,21];case 20:t.isResolveRequestPending=!0,s.label=21;case 21:return[2]}}))}))},e.prototype._uploadNextPendingItem=function(e){return i(this,void 0,void 0,(function(){var t,n,r,i,a,o,u,c,d,h,p,_,g,m;return s(this,(function(s){switch(s.label){case 0:return t=this._queueMap.get(e.url),(n=t.messageQueue.find((function(e){return e.state===zi.PENDING})))?S(n.params.file)?t.uploadQueue.length<6?(n.state=zi.UPLOADING,t.uploadQueue.push(n),[4,this._onlineDetector.isOnline()]):[3,10]:[3,11]:[3,13];case 1:if(!s.sent())return[3,8];s.label=2;case 2:return s.trys.push([2,4,5,7]),r=new gi({file:n.params.file,channelUrl:e.url,thumbnailSizes:n.params.thumbnailSizes,requestId:n.requestId}),[4,this._requestQueue.send(r)];case 3:return i=s.sent(),a=i.as(mi),o=a.url,u=a.fileSize,c=void 0===u?n.params.fileSize:u,d=a.thumbnailSizes,h=void 0===d?n.params.thumbnailSizes:d,p=a.requireAuth,_=void 0!==p&&p,n.params.fileUrl=o,n.params.fileSize=c,n.params.thumbnailSizes=h,n.params.requireAuth=_,n.requireAuth=_,n.state=zi.UPLOADED,[3,7];case 4:return(g=s.sent()).code===l.REQUEST_FAILED?n.error=new f({code:l.NETWORK_ERROR,message:"Failed to upload a file."}):n.error=g,n.state=zi.FAILED,[3,7];case 5:return(m=t.uploadQueue.findIndex((function(e){return e.requestId===n.requestId})))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 6:return s.sent(),[7];case 7:return[3,10];case 8:return n.state=zi.FAILED,n.error=f.connectionRequired,(m=t.uploadQueue.findIndex((function(e){return e.requestId===n.requestId})))>=0&&(t.uploadQueue.splice(m,1),this._uploadNextPendingItem(e)),[4,this._resolveMessageQueue(e)];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return n.params.thumbnailSizes=[],n.state=zi.UPLOADED,[4,this._resolveMessageQueue(e)];case 12:s.sent(),s.label=13;case 13:return[2]}}))}))},e.prototype.request=function(e,t,n){var r,a,o;return i(this,void 0,void 0,(function(){var i;return s(this,(function(s){return i=new Yn,S(n.file)&&(n.fileName=null!==(r=n.fileName)&&void 0!==r?r:n.file.name,n.mimeType=null!==(a=n.mimeType)&&void 0!==a?a:n.file.type,n.fileSize=null!==(o=n.fileSize)&&void 0!==o?o:n.file.size),this._queueMap.has(e.url)||this._queueMap.set(e.url,{messageQueue:[],uploadQueue:[],isResolving:!1,isResolveRequestPending:!1}),this._queueMap.get(e.url).messageQueue.push({requestId:t,params:n,state:zi.PENDING,deferred:i,requireAuth:n.requireAuth}),this._uploadNextPendingItem(e),[2,i.promise]}))}))},e.prototype.cancel=function(e,t){var n,r;void 0===t&&(t=null);var i=this._queueMap.get(e.url);if(i){var s=t?[i.messageQueue.find((function(e){return e.requestId===t}))]:u([],o(i.messageQueue),!1);try{for(var l=a(s),c=l.next();!c.done;c=l.next()){var d=c.value;if(d)switch(d.state){case zi.PENDING:d.state=zi.FAILED,d.error=f.requestCanceled,this._resolveMessageQueue(e);break;case zi.UPLOADING:this._requestQueue.cancel(d.requestId)}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}},e}(),os={prevResultSize:0,nextResultSize:0,isInclusive:!1,reverse:!1,messageTypeFilter:ai.ALL,customTypesFilter:null,senderUserIdsFilter:null,replyType:li.NONE,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1,showSubchannelMessagesOnly:!1},us=function(e){return v("number",e.prevResultSize)&&v("number",e.nextResultSize)&&v("boolean",e.isInclusive)&&v("boolean",e.reverse)&&v("string",e.messageTypeFilter)&&y(ai,e.messageTypeFilter)&&b("string",e.customTypesFilter,!0)&&b("string",e.senderUserIdsFilter,!0)&&y(li,e.replyType)&&v("boolean",e.includeMetaArray)&&v("boolean",e.includeReactions)&&v("boolean",e.includeParentMessageInfo)&&v("boolean",e.includeThreadInfo)&&v("boolean",e.showSubchannelMessagesOnly)},ls={replyType:li.NONE,includeReactions:!1,includeThreadInfo:!1,includeMetaArray:!1,includeParentMessageInfo:!1},cs=function(e){return y(li,e.replyType)&&v("boolean",e.includeReactions)&&v("boolean",e.includeMetaArray)&&v("boolean",e.includeParentMessageInfo)&&v("boolean",e.includeThreadInfo)};!function(e){e.UNKNOWN="UNKNOWN",e.EVENT_MESSAGE_SENT_SUCCESS="EVENT_MESSAGE_SENT_SUCCESS",e.EVENT_MESSAGE_SENT_FAILED="EVENT_MESSAGE_SENT_FAILED",e.EVENT_MESSAGE_SENT_PENDING="EVENT_MESSAGE_SENT_PENDING",e.EVENT_MESSAGE_RECEIVED="EVENT_MESSAGE_RECEIVED",e.EVENT_MESSAGE_UPDATED="EVENT_MESSAGE_UPDATED",e.EVENT_MESSAGE_DELETED="EVENT_MESSAGE_DELETED",e.EVENT_MESSAGE_READ="EVENT_MESSAGE_READ",e.EVENT_MESSAGE_DELIVERED="EVENT_MESSAGE_DELIVERED",e.EVENT_MESSAGE_REACTION_UPDATED="EVENT_MESSAGE_REACTION_UPDATED",e.EVENT_MESSAGE_THREADINFO_UPDATED="EVENT_MESSAGE_THREADINFO_UPDATED",e.EVENT_MESSAGE_OFFSET_UPDATED="EVENT_MESSAGE_OFFSET_UPDATED",e.REQUEST_MESSAGE="REQUEST_MESSAGE",e.EVENT_POLL_UPDATED="EVENT_POLL_UPDATED",e.EVENT_POLL_VOTED="EVENT_POLL_VOTED",e.SYNC_POLL_CHANGELOGS="SYNC_POLL_CHANGELOGS",e.REQUEST_RESEND_MESSAGE="REQUEST_RESEND_MESSAGE",e.REQUEST_THREADED_MESSAGE="REQUEST_THREADED_MESSAGE",e.REQUEST_MESSAGE_CHANGELOGS="REQUEST_MESSAGE_CHANGELOGS",e.SYNC_MESSAGE_FILL="SYNC_MESSAGE_FILL",e.SYNC_MESSAGE_BACKGROUND="SYNC_MESSAGE_BACKGROUND",e.SYNC_MESSAGE_CHANGELOGS="SYNC_MESSAGE_CHANGELOGS",e.LOCAL_MESSAGE_PENDING_CREATED="LOCAL_MESSAGE_PENDING_CREATED",e.LOCAL_MESSAGE_FAILED="LOCAL_MESSAGE_FAILED",e.LOCAL_MESSAGE_CANCELED="LOCAL_MESSAGE_CANCELED",e.LOCAL_MESSAGE_RESEND_STARTED="LOCAL_MESSAGE_RESEND_STARTED"}(ss||(ss={}));var ds,hs=function(e){return e.startsWith("EVENT_")||e===ss.SYNC_MESSAGE_FILL||e===ss.SYNC_MESSAGE_CHANGELOGS||e===ss.SYNC_POLL_CHANGELOGS},ps=function(e){function n(t){var n=t.messages,r=t.source,i=e.call(this)||this;return i.messages=n,i.source=r,i}return t(n,e),n}(x),fs=function(e){function n(t){var n=t.messageIds,r=t.source,i=e.call(this)||this;return i.messageIds=n,i.source=r,i}return t(n,e),n}(x),_s=function(e){function n(t){var n=t.reqId,r=t.source,i=e.call(this)||this;return i.reqId=n,i.source=r,i}return t(n,e),n}(x),gs=function(e){function n(t){var n=t.polls,r=t.source,i=e.call(this)||this;return i.polls=n,i.source=r,i}return t(n,e),n}(x),ms=function(e){function n(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=n,i.source=r,i}return t(n,e),n}(x),vs=function(e){function n(t){var n=t.event,r=t.source,i=e.call(this)||this;return i.event=null,i.source=null,i.event=n,i.source=r,i}return t(n,e),n}(x),ys=function(e){function n(t){var n=t.channelType,r=t.channelUrl,i=t.messageId,s=t.includeMetaArray,a=t.includeReactions,o=t.includeThreadInfo,u=t.includeParentMessageInfo,l=e.call(this)||this;return l.method=h.GET,l.path="".concat(Xi(n),"/").concat(encodeURIComponent(r),"/messages/").concat(encodeURIComponent(i)),l.params={is_sdk:!0,with_sorted_meta_array:s,include_reactions:a,include_thread_info:o,include_parent_message_info:u,include_poll_details:!0},l}return t(n,e),n}(P),Es=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.message=r?Wi(t,n({},r)):null,i}return t(r,e),r}(q),bs=function(e){function n(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=void 0===i?null:i,a=t.token,o=void 0===a?null:a,u=t.prevResultSize,l=t.nextResultSize,c=t.isInclusive,d=t.reverse,p=t.messageTypeFilter,f=t.customTypesFilter,_=t.senderUserIdsFilter,g=t.replyType,m=t.includeMetaArray,v=t.includeReactions,y=t.parentMessageId,E=t.includeThreadInfo,b=t.includeParentMessageInfo,w=t.showSubchannelMessagesOnly,S=e.call(this)||this;return S.method=h.GET,S.path="".concat(Xi(n),"/").concat(encodeURIComponent(r),"/messages"),S.params=L({is_sdk:!0,prev_limit:u,next_limit:l,include:c,reverse:d,message_ts:s,message_id:o,message_type:null!=p?p:null,custom_types:f,sender_ids:_,include_reply_type:g,with_sorted_meta_array:m,include_reactions:v,parent_message_id:y,include_thread_info:E,include_parent_message_info:b,show_subchannel_message_only:w,include_poll_details:!0}),S}return t(n,e),n}(P),ws=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.messages=n.messages.map((function(e){return Wi(t,e)})),r}return t(n,e),n}(q),Ss=function(e){function n(t){var n=t.channelType,r=t.channelUrl,i=t.timestamp,s=t.token,a=t.replyType,o=t.includeMetaArray,u=t.includeReactions,l=t.includeThreadInfo,c=t.includeParentMessageInfo,d=e.call(this)||this;return d.method=h.GET,d.path="".concat(Xi(n),"/").concat(encodeURIComponent(r),"/messages/changelogs"),d.params={change_ts:i,token:s,with_sorted_meta_array:o,include_reactions:u,include_thread_info:l,include_reply_type:a,include_parent_message_info:c,include_poll_details:!0},d}return t(n,e),n}(P),Ts=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.updatedMessages=n.updated.map((function(e){return Wi(t,e)})),r.deletedMessagesInfo=n.deleted.map((function(e){return{messageId:e.message_id,deletedAt:e.deleted_at}})),r.hasMore=n.has_more,r.nextToken=n.next,r}return t(n,e),n}(q),Is=function(e){function n(t){var n=t.channelUrl,r=t.scheduledMessageId,i=e.call(this)||this;return i.method=h.GET,i.path="".concat(rr,"/").concat(encodeURIComponent(n),"/scheduled_messages/").concat(encodeURIComponent(r)),i.params={},i}return t(n,e),n}(P),ks=function(e){function r(t,r){var i=e.call(this,t,r)||this;return i.message=r?Wi(t,n({},r)):null,i}return t(r,e),r}(q),As={},Ns=function(){function e(e,t){var n=t.sdkState,r=t.dispatcher,i=t.requestQueue,s=t.onlineDetector,a=t.cacheContext;this._iid=e,this._sdkState=n,this._requestQueue=i,this._dispatcher=r,this._cacheContext=a,this.fileMessageQueue=new as(e,{sdkState:n,dispatcher:r,requestQueue:i,onlineDetector:s,cacheContext:a}),As[e]=this}return e.of=function(e){return As[e]},e.prototype.buildMessageFromSerializedData=function(e){var t=Hr(e);switch(t.messageType){case si.USER:return new Zi(this._iid,Zi.payloadify(t));case si.FILE:return new Yi(this._iid,Yi.payloadify(t));case si.ADMIN:return new qi(this._iid,qi.payloadify(t))}return null},e.prototype.buildUserMessageCreateParamsFromSerializedData=function(e,t){return L({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,message:t.message,translationTargetLanguages:Object.keys(t.translations),pollId:e.pollId})},e.prototype.buildFileMessageCreateParamsFromSerializedData=function(e,t){return L({data:t.data,customType:t.customType,mentionType:t.mentionType,mentionedUserIds:t.mentionedUserIds,mentionedUsers:t.mentionedUsers,mentionedMessageTemplate:t.mentionedMessageTemplate,metaArrays:t.metaArrays,parentMessageId:t.parentMessageId,isReplyToChannel:e.isReplyToChannel,pushNotificationDeliveryOption:e.pushNotificationDeliveryOption,appleCriticalAlertOptions:t.appleCriticalAlertOptions,reqId:t.reqId,file:e.file,fileKey:e.fileKey,fileUrl:t.plainUrl,fileName:t.name,fileSize:t.size,mimeType:t.type,thumbnailSizes:t.thumbnails.map((function(e){return{maxWidth:e.width,maxHeight:e.height}})),fileType:e.fileType,requireAuth:t.requireAuth})},e.prototype.buildScheduledUserMessageCreateParamsFromSerializedData=function(e,t){return n(n({},this.buildUserMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildScheduledFileMessageCreateParamsFromSerializedData=function(e,t){return n(n({},this.buildFileMessageCreateParamsFromSerializedData(e,t)),{scheduledAt:e.scheduledAt})},e.prototype.buildSenderFromSerializedData=function(e){var t=Hr(e);return new Mi(this._iid,Mi.payloadify(t))},e.prototype.getMessage=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=new ys(e),[4,this._requestQueue.send(t)];case 1:return n=r.sent(),[2,n.as(Es).message]}}))}))},e.prototype.getScheduledMessage=function(e){return i(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return t=new Is(e),[4,this._requestQueue.send(t)];case 1:return n=r.sent(),[2,n.as(ks).message]}}))}))},e.prototype.getMessagesByMessageId=function(e,t,r,a,o){return void 0===o&&(o=ss.REQUEST_MESSAGE),i(this,void 0,void 0,(function(){var i,u,l;return s(this,(function(s){switch(s.label){case 0:return i=new bs(n(n({channelType:t,channelUrl:e,token:String(r)},os),a)),[4,this._requestQueue.send(i)];case 1:return u=s.sent(),l=u.as(ws).messages,this._dispatcher.dispatch(new ps({messages:l,source:o})),[2,l]}}))}))},e.prototype.getMessagesByTimestamp=function(e,t,r,a,o){return void 0===o&&(o=ss.REQUEST_MESSAGE),i(this,void 0,void 0,(function(){var i,u,l;return s(this,(function(s){switch(s.label){case 0:return i=new bs(n(n({channelType:t,channelUrl:e,timestamp:r},os),a)),[4,this._requestQueue.send(i)];case 1:return u=s.sent(),l=u.as(ws).messages,this._dispatcher.dispatch(new ps({messages:l,source:o})),[2,l]}}))}))},e.prototype.getThreadedMessagesByTimestamp=function(e,t,r,a){return void 0===a&&(a=ss.REQUEST_THREADED_MESSAGE),i(this,void 0,void 0,(function(){var i,o,u,l;return s(this,(function(s){switch(s.label){case 0:return i=new bs(n(n(n({channelUrl:e.channelUrl,channelType:e.channelType,timestamp:t},Ui),r),{replyType:li.ALL,parentMessageId:e.messageId,includeThreadInfo:!0})),[4,this._requestQueue.send(i)];case 1:return o=s.sent(),u=o.as(ws).messages,(l=u.slice(1)).forEach((function(t){t.parentMessage=e})),this._dispatcher.dispatch(new ps({messages:l,source:a})),[2,{parentMessage:u[0],threadedMessages:l}]}}))}))},e.prototype.getMessageChangelogs=function(e,t,r,a,o){return void 0===o&&(o=ss.REQUEST_MESSAGE_CHANGELOGS),i(this,void 0,void 0,(function(){var i,u,l,c,d,h,p,f;return s(this,(function(s){switch(s.label){case 0:return i=new Ss(L(n(n({channelType:t,channelUrl:e,timestamp:"number"==typeof r?r:null,token:"string"==typeof r?r:null},ls),a))),[4,this._requestQueue.send(i)];case 1:return u=s.sent(),l=u.as(Ts),c=l.updatedMessages,d=l.deletedMessagesInfo,h=l.hasMore,p=l.nextToken,f=d.map((function(e){return e.messageId})),c.length>0&&this._dispatcher.dispatch(new ps({messages:c,source:o})),f.length>0&&this._dispatcher.dispatch(new fs({messageIds:f,source:o})),[2,{updatedMessages:c,deletedMessageIds:f,hasMore:h,token:p}]}}))}))},e}(),Rs=function(){function e(){this._onPending=K,this._onFailed=K,this._onSucceeded=K}return e.prototype._trigger=function(e,t){switch(t.sendingStatus){case di.PENDING:0===t.errorCode&&this._onPending(t);break;case di.FAILED:case di.CANCELED:this._onFailed(e,t.scheduledInfo?null:t);break;case di.SCHEDULED:case di.SUCCEEDED:this._onSucceeded(t)}},e.prototype.onPending=function(e){return this._onPending=e,this},e.prototype.onFailed=function(e){return this._onFailed=e,this},e.prototype.onSucceeded=function(e){return this._onSucceeded=e,this},e}(),Os=function(e){function n(t,n){var r=e.call(this,t)||this;r.threadInfo=null,r.targetMessageId=0,r.channelUrl=null,r.channelType=null;var i=n.thread_info,s=n.parent_message_id,a=n.channel_url,o=n.channel_type;return i&&v("object",i)&&v("number",s)&&v("string",a)&&v("string",o)&&(r.threadInfo=new yi(t,i),r.targetMessageId=s,r.channelUrl=a,r.channelType=o),r}return t(n,e),n}(Pr),Cs={channelUrl:null,channelType:null,messageId:0,includeReactions:!1,includeMetaArray:!1,includeParentMessageInfo:!1,includeThreadInfo:!1},Ds=function(){function e(e,t){var n;this._iid=null,this.limit=20,this._isLoading=!1,this._hasNext=!0,this._token="",this._iid=e,this.limit=null!==(n=t.limit)&&void 0!==n?n:20}return Object.defineProperty(e.prototype,"hasNext",{get:function(){return this._hasNext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!1,configurable:!0}),e.prototype._validate=function(){return v("number",this.limit)&&this.limit>0},e}(),Ms=function(e){function n(t){var n=t.channelCustomType,r=t.keyword,i=t.limit,s=t.reverse,a=t.exactMatch,o=t.channelUrl,u=t.order,l=t.messageTimestampFrom,c=t.messageTimestampTo,d=t.advancedQuery,p=t.targetFields,f=t.nextToken,_=e.call(this)||this;return _.method=h.GET,_.path="".concat(or,"/messages"),_.params={custom_type:n,query:r,limit:i,reverse:s,exact_match:a,channel_url:o,message_ts_from:l,message_ts_to:c,sort_field:u,advanced_query:d,target_fields:p,after:f},_}return t(n,e),n}(P),xs=function(e){function n(t,n){var r=e.call(this,t,n)||this;return r.messages=n.results.map((function(e){return Wi(t,e)})),r.hasNext=n.has_next,r.nextToken=n.end_cursor,r.totalCount=n.total_count,r}return t(n,e),n}(q);!function(e){e.SCORE="score",e.TIMESTAMP="ts"}(ds||(ds={}));var Ls=function(e){function r(t,n){var r,i,s,a,o,u,l,c,d,h=this;return(h=e.call(this,t,n)||this).keyword="",h.reverse=!1,h.exactMatch=!1,h.channelUrl="",h.channelCustomType="",h.messageTimestampFrom=null,h.messageTimestampTo=null,h.order=ds.SCORE,h.advancedQuery=!1,h.targetFields=null,h._nextToken="",h.totalCount=-1,h.keyword=n.keyword,h.reverse=null!==(r=n.reverse)&&void 0!==r&&r,h.exactMatch=null!==(i=n.exactMatch)&&void 0!==i&&i,h.channelUrl=null!==(s=n.channelUrl)&&void 0!==s?s:"",h.channelCustomType=null!==(a=n.channelCustomType)&&void 0!==a?a:"",h.messageTimestampFrom=null!==(o=n.messageTimestampFrom)&&void 0!==o?o:null,h.messageTimestampTo=null!==(u=n.messageTimestampTo)&&void 0!==u?u:null,h.order=null!==(l=n.order)&&void 0!==l?l:ds.SCORE,h.advancedQuery=null!==(c=n.advancedQuery)&&void 0!==c&&c,h.targetFields=null!==(d=n.targetFields)&&void 0!==d?d:null,h}return t(r,e),r.prototype._validate=function(){return e.prototype._validate.call(this)&&v("string",this.keyword)&&this.keyword.length>0&&v("boolean",this.reverse)&&v("boolean",this.exactMatch)&&v("string",this.channelUrl)&&v("string",this.channelCustomType)&&(v("number",this.messageTimestampFrom)||null===this.messageTimestampFrom)&&(v("number",this.messageTimestampTo)||null===this.messageTimestampTo)&&y(ds,this.order)&&v("boolean",this.advancedQuery)&&b("string",this.targetFields,!0)},r.prototype.next=function(){return i(this,void 0,void 0,(function(){var e,t,r,i,a,o,u,l;return s(this,(function(s){switch(s.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,e=fi.of(this._iid).requestQueue,t=new Ms(n(n({},this),{nextToken:this._nextToken?this._nextToken:null})),[4,e.send(t)]):[3,2]:[3,5];case 1:return r=s.sent(),i=r.as(xs),a=i.messages,o=i.hasNext,u=i.nextToken,l=i.totalCount,this._nextToken=u,this._hasNext=o,this._isLoading=!1,this.totalCount=l,[2,a];case 2:return[2,[]];case 3:throw f.queryInProgress;case 4:return[3,6];case 5:throw f.invalidParameters;case 6:return[2]}}))}))},r}(Ds),Us=function(e){function n(t,n,r,i){var s=e.call(this,t,i)||this;return s.channelUrl=n,s.channelType=r,s}return t(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&v("string",this.channelUrl)&&y(Ei,this.channelType)},n}(Ds),Ps=function(e){function n(t,n,r,i){var s,a,o,u,l,c,d,h,p,f,_=this;return(_=e.call(this,t,n,r,i)||this).reverse=!1,_.messageTypeFilter=ai.ALL,_.customTypesFilter=null,_.senderUserIdsFilter=null,_.replyType=li.NONE,_.includeMetaArray=!1,_.includeReactions=!1,_.includeParentMessageInfo=!1,_.includeThreadInfo=!1,_.showSubchannelMessagesOnly=!1,_._edge=Number.MAX_SAFE_INTEGER,_.reverse=null!==(s=i.reverse)&&void 0!==s&&s,_.messageTypeFilter=null!==(a=i.messageTypeFilter)&&void 0!==a?a:ai.ALL,_.customTypesFilter=null!==(o=i.customTypesFilter)&&void 0!==o?o:null,_.senderUserIdsFilter=null!==(u=i.senderUserIdsFilter)&&void 0!==u?u:null,_.replyType=null!==(l=i.replyType)&&void 0!==l?l:li.NONE,_.includeMetaArray=null!==(c=i.includeMetaArray)&&void 0!==c&&c,_.includeReactions=null!==(d=i.includeReactions)&&void 0!==d&&d,_.includeParentMessageInfo=null!==(h=i.includeParentMessageInfo)&&void 0!==h&&h,_.includeThreadInfo=null!==(p=i.includeThreadInfo)&&void 0!==p&&p,_.showSubchannelMessagesOnly=null!==(f=i.showSubchannelMessagesOnly)&&void 0!==f&&f,_}return t(n,e),n.prototype._validate=function(){return e.prototype._validate.call(this)&&v("boolean",this.reverse)&&y(ai,this.messageTypeFilter)&&y(li,this.replyType)&&b("string",this.customTypesFilter,!0)&&b("string",this.senderUserIdsFilter,!0)&&v("boolean",this.includeMetaArray)&&v("boolean",this.includeReactions)&&v("boolean",this.includeParentMessageInfo)&&v("boolean",this.includeThreadInfo)&&v("boolean",this.showSubchannelMessagesOnly)},n.prototype.load=function(){return i(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return this._validate()?this._isLoading?[3,3]:this._hasNext?(this._isLoading=!0,[4,Ns.of(this._iid).getMessagesByTimestamp(this.channelUrl,this.channelType,this._edge,{prevResultSize:this.limit,nextResultSize:0,isInclusive:!1,reverse:this.reverse,messageTypeFilter:this.messageTypeFilter,customTypesFilter:this.customTypesFilter,replyType:this.replyType,senderUserIdsFilter:this.senderUserIdsFilter,includeReactions:this.includeReactions,includeMetaArray:this.includeMetaArray,includeParentMessageInfo:this.includeParentMessageInfo,includeThreadInfo:this.includeThreadInfo,showSubchannelMessagesOnly:this.showSubchannelMessagesOnly})]):[3,2]:[3,5];case 1:return e=t.sent(),this._edge=Math.min.apply(Math,u([Number.MAX_SAFE_INTEGER],o(e.map((function(e){return e.createdAt}))),!1)),this._hasNext=e.length>=this.limit,this._isLoading=!1,[2,e];case 2:return[2,[]];case 3:throw f.queryInProgress;case 4:return[3,6];case 5:throw f.invalidParameters;case 6:return[2]}}))}))},n}(Us),qs={channelUrl:null,scheduledMessageId:0},Fs=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="message",t}return t(r,e),r.prototype.init=function(t,n){var r=n.sdkState,i=n.dispatcher,s=n.sessionManager,a=n.requestQueue,o=n.logger,u=n.onlineDetector,l=n.cacheContext;e.prototype.init.call(this,t,{sdkState:r,dispatcher:i,sessionManager:s,requestQueue:a,logger:o,onlineDetector:u,cacheContext:l}),this._manager=new Ns(t,{sdkState:r,dispatcher:i,requestQueue:a,onlineDetector:u,cacheContext:l})},r.prototype.buildMessageFromSerializedData=function(e){return this._manager.buildMessageFromSerializedData(e)},r.prototype.buildSenderFromSerializedData=function(e){return this._manager.buildSenderFromSerializedData(e)},r.prototype.getMessage=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(r){return t=n(n({},Cs),e),Zr(function(e){return v("string",e.channelUrl)&&v("string",e.channelType)&&y(Ei,e.channelType)&&v("number",e.messageId)&&v("boolean",e.includeMetaArray)&&v("boolean",e.includeParentMessageInfo)&&v("boolean",e.includeThreadInfo)}(t)).throw(f.invalidParameters),[2,this._manager.getMessage(t)]}))}))},r.prototype.getScheduledMessage=function(e){return i(this,void 0,void 0,(function(){var t;return s(this,(function(r){return t=n(n({},qs),e),Zr(function(e){return v("string",e.channelUrl)&&v("number",e.scheduledMessageId)}(t)).throw(f.invalidParameters),[2,this._manager.getScheduledMessage(t)]}))}))},r}(_i);export{cr as $,h as A,ki as B,Ei as C,ci as D,Ri as E,a as F,Zi as G,Yi as H,Ns as I,Pr as J,D as K,x as L,ss as M,di as N,w as O,Hi as P,Jn as Q,li as R,f as S,Hn as T,Wr as U,fi as V,l as W,ps as X,B as Y,tr as Z,t as _,dr as a,ar as a$,lr as a0,Ds as a1,u as a2,o as a3,k as a4,r as a5,Ji as a6,ur as a7,Vn as a8,$i as a9,Fs as aA,Sr as aB,ri as aC,Fi as aD,bi as aE,Br as aF,T as aG,wi as aH,ms as aI,_s as aJ,fs as aK,ir as aL,rr as aM,hr as aN,Si as aO,Kr as aP,Wi as aQ,rs as aR,Gi as aS,hs as aT,br as aU,Vi as aV,mi as aW,gi as aX,qi as aY,Os as aZ,ji as a_,es as aa,Ti as ab,oi as ac,Li as ad,O as ae,m as af,Ps as ag,Mi as ah,yr as ai,wr as aj,p as ak,Rs as al,os as am,us as an,ls as ao,cs as ap,Yn as aq,Di as ar,vs as as,c as at,Bn as au,Ls as av,Wn as aw,Yr as ax,Xr as ay,I as az,P as b,sr as b0,ds as b1,Ai as b2,Ni as b3,Ii as b4,vi as b5,yi as b6,q as c,Ki as d,L as e,Qi as f,Xi as g,y as h,v as i,Hr as j,i as k,s as l,n as m,gs as n,Us as o,_i as p,Oi as q,S as r,K as s,ai as t,Zr as u,Bi as v,si as w,xi as x,ui as y,b as z};
