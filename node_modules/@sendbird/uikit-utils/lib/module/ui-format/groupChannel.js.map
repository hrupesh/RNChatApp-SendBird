{"version":3,"names":["format","isThisYear","isToday","isYesterday","truncate","getGroupChannelTitle","currentUserId","channel","EMPTY_USERNAME","NO_MEMBERS","DEFAULT_CHANNEL_NAME","name","memberCount","members","filter","userId","map","nickname","join","getGroupChannelPreviewTime","locale","timestamp","lastMessage","createdAt","joinedAt","getGroupChannelLastMessage","EMPTY_MESSAGE","MAX_LEN","message","isFileMessage","extIdx","lastIndexOf","file","slice","ext","maxLen","isUserMessage","isAdminMessage"],"sources":["groupChannel.ts"],"sourcesContent":["import type { Locale } from 'date-fns';\nimport { format, isThisYear, isToday, isYesterday } from 'date-fns';\n\nimport type { SendbirdGroupChannel } from '../types';\nimport { truncate } from './common';\n\nexport const getGroupChannelTitle = (\n  currentUserId: string,\n  channel: SendbirdGroupChannel,\n  EMPTY_USERNAME = '(No name)',\n  NO_MEMBERS = '(No members)',\n  DEFAULT_CHANNEL_NAME = 'Group Channel',\n) => {\n  if (channel.name !== DEFAULT_CHANNEL_NAME && channel.name !== '') return channel.name;\n  if (channel.memberCount === 1) return NO_MEMBERS;\n  return channel.members\n    .filter(({ userId }) => userId !== currentUserId)\n    .map(({ nickname }) => nickname || EMPTY_USERNAME)\n    .join(', ');\n};\n\nexport const getGroupChannelPreviewTime = (channel: SendbirdGroupChannel, locale?: Locale) => {\n  const timestamp = channel.lastMessage?.createdAt || channel.joinedAt * 1000 || channel.createdAt;\n\n  if (isToday(timestamp)) return format(timestamp, 'p', { locale });\n  if (isYesterday(timestamp)) return 'Yesterday';\n  if (isThisYear(timestamp)) return format(timestamp, 'MMM dd', { locale });\n\n  return format(timestamp, 'yyyy/MM/dd', { locale });\n};\n\nexport const getGroupChannelLastMessage = (channel: SendbirdGroupChannel, EMPTY_MESSAGE = '', MAX_LEN = 15) => {\n  const message = channel.lastMessage;\n  if (!message) return EMPTY_MESSAGE;\n\n  if (message.isFileMessage()) {\n    const extIdx = message.name.lastIndexOf('.');\n    if (extIdx > -1) {\n      const file = message.name.slice(0, extIdx);\n      const ext = message.name.slice(extIdx);\n      return truncate(file, { maxLen: MAX_LEN }) + ext;\n    }\n\n    return truncate(message.name, { maxLen: MAX_LEN });\n  }\n\n  if (message.isUserMessage()) {\n    return message.message ?? EMPTY_MESSAGE;\n  }\n\n  if (message.isAdminMessage()) {\n    return message.message ?? EMPTY_MESSAGE;\n  }\n\n  return EMPTY_MESSAGE;\n};\n"],"mappings":"AACA,SAASA,MAAT,EAAiBC,UAAjB,EAA6BC,OAA7B,EAAsCC,WAAtC,QAAyD,UAAzD;AAGA,SAASC,QAAT,QAAyB,UAAzB;AAEA,OAAO,MAAMC,oBAAoB,GAAG,UAClCC,aADkC,EAElCC,OAFkC,EAM/B;EAAA,IAHHC,cAGG,uEAHc,WAGd;EAAA,IAFHC,UAEG,uEAFU,cAEV;EAAA,IADHC,oBACG,uEADoB,eACpB;EACH,IAAIH,OAAO,CAACI,IAAR,KAAiBD,oBAAjB,IAAyCH,OAAO,CAACI,IAAR,KAAiB,EAA9D,EAAkE,OAAOJ,OAAO,CAACI,IAAf;EAClE,IAAIJ,OAAO,CAACK,WAAR,KAAwB,CAA5B,EAA+B,OAAOH,UAAP;EAC/B,OAAOF,OAAO,CAACM,OAAR,CACJC,MADI,CACG;IAAA,IAAC;MAAEC;IAAF,CAAD;IAAA,OAAgBA,MAAM,KAAKT,aAA3B;EAAA,CADH,EAEJU,GAFI,CAEA;IAAA,IAAC;MAAEC;IAAF,CAAD;IAAA,OAAkBA,QAAQ,IAAIT,cAA9B;EAAA,CAFA,EAGJU,IAHI,CAGC,IAHD,CAAP;AAID,CAbM;AAeP,OAAO,MAAMC,0BAA0B,GAAG,CAACZ,OAAD,EAAgCa,MAAhC,KAAoD;EAAA;;EAC5F,MAAMC,SAAS,GAAG,yBAAAd,OAAO,CAACe,WAAR,8EAAqBC,SAArB,KAAkChB,OAAO,CAACiB,QAAR,GAAmB,IAArD,IAA6DjB,OAAO,CAACgB,SAAvF;EAEA,IAAIrB,OAAO,CAACmB,SAAD,CAAX,EAAwB,OAAOrB,MAAM,CAACqB,SAAD,EAAY,GAAZ,EAAiB;IAAED;EAAF,CAAjB,CAAb;EACxB,IAAIjB,WAAW,CAACkB,SAAD,CAAf,EAA4B,OAAO,WAAP;EAC5B,IAAIpB,UAAU,CAACoB,SAAD,CAAd,EAA2B,OAAOrB,MAAM,CAACqB,SAAD,EAAY,QAAZ,EAAsB;IAAED;EAAF,CAAtB,CAAb;EAE3B,OAAOpB,MAAM,CAACqB,SAAD,EAAY,YAAZ,EAA0B;IAAED;EAAF,CAA1B,CAAb;AACD,CARM;AAUP,OAAO,MAAMK,0BAA0B,GAAG,UAAClB,OAAD,EAAqE;EAAA,IAArCmB,aAAqC,uEAArB,EAAqB;EAAA,IAAjBC,OAAiB,uEAAP,EAAO;EAC7G,MAAMC,OAAO,GAAGrB,OAAO,CAACe,WAAxB;EACA,IAAI,CAACM,OAAL,EAAc,OAAOF,aAAP;;EAEd,IAAIE,OAAO,CAACC,aAAR,EAAJ,EAA6B;IAC3B,MAAMC,MAAM,GAAGF,OAAO,CAACjB,IAAR,CAAaoB,WAAb,CAAyB,GAAzB,CAAf;;IACA,IAAID,MAAM,GAAG,CAAC,CAAd,EAAiB;MACf,MAAME,IAAI,GAAGJ,OAAO,CAACjB,IAAR,CAAasB,KAAb,CAAmB,CAAnB,EAAsBH,MAAtB,CAAb;MACA,MAAMI,GAAG,GAAGN,OAAO,CAACjB,IAAR,CAAasB,KAAb,CAAmBH,MAAnB,CAAZ;MACA,OAAO1B,QAAQ,CAAC4B,IAAD,EAAO;QAAEG,MAAM,EAAER;MAAV,CAAP,CAAR,GAAsCO,GAA7C;IACD;;IAED,OAAO9B,QAAQ,CAACwB,OAAO,CAACjB,IAAT,EAAe;MAAEwB,MAAM,EAAER;IAAV,CAAf,CAAf;EACD;;EAED,IAAIC,OAAO,CAACQ,aAAR,EAAJ,EAA6B;IAC3B,OAAOR,OAAO,CAACA,OAAR,IAAmBF,aAA1B;EACD;;EAED,IAAIE,OAAO,CAACS,cAAR,EAAJ,EAA8B;IAC5B,OAAOT,OAAO,CAACA,OAAR,IAAmBF,aAA1B;EACD;;EAED,OAAOA,aAAP;AACD,CAxBM"}