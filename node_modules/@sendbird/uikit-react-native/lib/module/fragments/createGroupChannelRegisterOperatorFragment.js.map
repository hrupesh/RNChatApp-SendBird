{"version":3,"names":["React","useCallback","TouchableOpacity","useUserList","StatusComposition","UserSelectableBar","createUserListModule","useLocalization","useSendbirdChat","createGroupChannelRegisterOperatorFragment","initModule","UserListModule","channel","onPressHeaderLeft","sortComparator","renderUser","onPressHeaderRight","sdk","currentUser","STRINGS","users","refreshing","refresh","next","error","loading","queryCreator","createMemberListQuery","limit","_renderUser","user","selectedUsers","setSelectedUsers","userIdx","findIndex","u","userId","isSelected","isOperator","role","draft","splice","push","profileUrl","nickname","LABELS","USER_NO_NAME","USER_BAR_ME_POSTFIX","GROUP_CHANNEL_REGISTER_OPERATOR","HEADER_RIGHT","HEADER_TITLE","length","addOperators","map","it","Boolean"],"sources":["createGroupChannelRegisterOperatorFragment.tsx"],"sourcesContent":["import React, { useCallback } from 'react';\nimport { TouchableOpacity } from 'react-native';\n\nimport { useUserList } from '@sendbird/uikit-chat-hooks';\nimport type { SendbirdMember } from '@sendbird/uikit-utils';\n\nimport StatusComposition from '../components/StatusComposition';\nimport UserSelectableBar from '../components/UserSelectableBar';\nimport type { GroupChannelRegisterOperatorFragment } from '../domain/groupChannelUserList/types';\nimport createUserListModule from '../domain/userList/module/createUserListModule';\nimport type { UserListModule } from '../domain/userList/types';\nimport { useLocalization, useSendbirdChat } from '../hooks/useContext';\n\nconst createGroupChannelRegisterOperatorFragment = (\n  initModule?: Partial<UserListModule<SendbirdMember>>,\n): GroupChannelRegisterOperatorFragment<SendbirdMember> => {\n  const UserListModule = createUserListModule<SendbirdMember>(initModule);\n\n  return ({ channel, onPressHeaderLeft, sortComparator, renderUser, onPressHeaderRight }) => {\n    const { sdk, currentUser } = useSendbirdChat();\n    const { STRINGS } = useLocalization();\n    const { users, refreshing, refresh, next, error, loading } = useUserList(sdk, {\n      queryCreator: () => channel.createMemberListQuery({ limit: 20 }),\n      sortComparator,\n    });\n\n    const _renderUser: NonNullable<typeof renderUser> = useCallback(\n      (user, selectedUsers, setSelectedUsers) => {\n        if (renderUser) return renderUser(user, selectedUsers, setSelectedUsers);\n\n        const userIdx = selectedUsers.findIndex((u) => u.userId === user.userId);\n        const isSelected = userIdx > -1;\n        const isOperator = user.role === 'operator';\n\n        return (\n          <TouchableOpacity\n            activeOpacity={0.7}\n            disabled={isOperator}\n            onPress={() => {\n              setSelectedUsers(([...draft]) => {\n                if (isSelected) draft.splice(userIdx, 1);\n                else draft.push(user);\n                return draft;\n              });\n            }}\n          >\n            <UserSelectableBar\n              uri={user.profileUrl}\n              name={\n                (user.nickname || STRINGS.LABELS.USER_NO_NAME) +\n                (user.userId === currentUser?.userId ? STRINGS.LABELS.USER_BAR_ME_POSTFIX : '')\n              }\n              selected={isOperator || isSelected}\n              disabled={isOperator}\n            />\n          </TouchableOpacity>\n        );\n      },\n      [channel, renderUser],\n    );\n    return (\n      <UserListModule.Provider\n        headerRight={(selectedUsers) => STRINGS.GROUP_CHANNEL_REGISTER_OPERATOR.HEADER_RIGHT({ selectedUsers })}\n        headerTitle={STRINGS.GROUP_CHANNEL_REGISTER_OPERATOR.HEADER_TITLE}\n      >\n        <UserListModule.Header\n          shouldActivateHeaderRight={(selectedUsers) => selectedUsers.length > 0}\n          onPressHeaderLeft={onPressHeaderLeft}\n          onPressHeaderRight={async (users) => {\n            await channel.addOperators(users.map((it) => it.userId));\n            onPressHeaderRight(channel);\n          }}\n        />\n        <StatusComposition\n          loading={loading}\n          error={Boolean(error)}\n          LoadingComponent={<UserListModule.StatusLoading />}\n          ErrorComponent={<UserListModule.StatusError onPressRetry={() => refresh()} />}\n        >\n          <UserListModule.List\n            onLoadNext={next}\n            users={users}\n            renderUser={_renderUser}\n            onRefresh={refresh}\n            refreshing={refreshing}\n            ListEmptyComponent={<UserListModule.StatusEmpty />}\n          />\n        </StatusComposition>\n      </UserListModule.Provider>\n    );\n  };\n};\n\nexport default createGroupChannelRegisterOperatorFragment;\n"],"mappings":"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"}