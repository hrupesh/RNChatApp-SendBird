{"version":3,"names":["React","useCallback","useContext","useReducer","useRef","useState","NOOP","ReactionBottomSheets","LocalizationContext","SendbirdChatContext","UserProfileContext","ReactionContext","createContext","ReactionProvider","children","chatCtx","localizationCtx","userProfileCtx","Error","state","setState","prev","next","reactionListVisible","setReactionListVisible","reactionUserListVisible","setReactionUserListVisible","reactionUserListFocusIndex","setReactionUserListFocusIndex","closeResolver","openReactionList","params","openReactionUserList","channel","message","focusIndex","updateReactionFocusedItem","createOnCloseWithResolver","callback","Promise","resolve","current","reactionCtx","sheetProps","onDismiss"],"sources":["ReactionCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useReducer, useRef, useState } from 'react';\n\nimport type { SendbirdBaseChannel, SendbirdBaseMessage } from '@sendbird/uikit-utils';\nimport { NOOP } from '@sendbird/uikit-utils';\n\nimport { ReactionBottomSheets } from '../components/ReactionBottomSheets';\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\nimport { UserProfileContext } from '../contexts/UserProfileCtx';\n\ntype State = {\n  message?: SendbirdBaseMessage;\n  channel?: SendbirdBaseChannel;\n};\nexport type ReactionContextType = {\n  openReactionList(param: Required<State>): void;\n  openReactionUserList(param: Required<State> & { focusIndex?: number }): void;\n  updateReactionFocusedItem(param?: State): void;\n  focusIndex: number;\n} & State;\n\ntype Props = React.PropsWithChildren<{}>;\n\nexport const ReactionContext = React.createContext<ReactionContextType | null>(null);\nexport const ReactionProvider = ({ children }: Props) => {\n  const chatCtx = useContext(SendbirdChatContext);\n  const localizationCtx = useContext(LocalizationContext);\n  const userProfileCtx = useContext(UserProfileContext);\n  if (!chatCtx) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationCtx) throw new Error('LocalizationContext is not provided');\n  if (!userProfileCtx) throw new Error('UserProfileContext is not provided');\n\n  const [state, setState] = useReducer((prev: State, next: State) => ({ ...prev, ...next }), {});\n  const [reactionListVisible, setReactionListVisible] = useState(false);\n  const [reactionUserListVisible, setReactionUserListVisible] = useState(false);\n  const [reactionUserListFocusIndex, setReactionUserListFocusIndex] = useState(0);\n\n  const closeResolver = useRef<() => void>(NOOP);\n\n  const openReactionList: ReactionContextType['openReactionList'] = useCallback((params) => {\n    setState(params);\n    setReactionListVisible(true);\n  }, []);\n\n  const openReactionUserList: ReactionContextType['openReactionUserList'] = useCallback(\n    ({ channel, message, focusIndex = 0 }) => {\n      setState({ channel, message });\n      setReactionUserListFocusIndex(focusIndex);\n      setReactionUserListVisible(true);\n    },\n    [],\n  );\n\n  const updateReactionFocusedItem: ReactionContextType['updateReactionFocusedItem'] = useCallback((params) => {\n    if (params) setState(params);\n    else setState({});\n  }, []);\n\n  const createOnCloseWithResolver = (callback: () => void) => {\n    return () => {\n      return new Promise<void>((resolve) => {\n        closeResolver.current = resolve;\n        callback();\n      });\n    };\n  };\n\n  const reactionCtx = {\n    ...state,\n    openReactionList,\n    openReactionUserList,\n    updateReactionFocusedItem,\n    focusIndex: reactionUserListFocusIndex,\n  };\n\n  const sheetProps = {\n    chatCtx,\n    reactionCtx,\n    localizationCtx,\n    userProfileCtx,\n    onDismiss: () => {\n      setState({});\n      closeResolver.current?.();\n    },\n  };\n\n  return (\n    <ReactionContext.Provider value={reactionCtx}>\n      {children}\n      <ReactionBottomSheets.UserList\n        {...sheetProps}\n        visible={reactionUserListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionUserListVisible(false))}\n      />\n      <ReactionBottomSheets.ReactionList\n        {...sheetProps}\n        visible={reactionListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionListVisible(false))}\n      />\n    </ReactionContext.Provider>\n  );\n};\n"],"mappings":"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"}