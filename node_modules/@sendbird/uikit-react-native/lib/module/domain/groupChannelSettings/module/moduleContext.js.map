{"version":3,"names":["React","createContext","useCallback","useChannelHandler","useActionMenu","useAlert","useBottomSheet","usePrompt","useToast","NOOP","isDifferentChannel","useForceUpdate","useUniqId","ProviderLayout","useLocalization","usePlatformService","useSendbirdChat","SBUError","SBUUtils","GroupChannelSettingsContexts","Fragment","channel","headerTitle","headerRight","onPressHeaderRight","HOOK_NAME","GroupChannelSettingsContextsProvider","children","uniqId","forceUpdate","STRINGS","sdk","fileService","alert","onChannelChanged","eventChannel","onChannelFrozen","onChannelUnfrozen","onUserBanned","toast","openSheet","openPrompt","openMenu","updateChannel","params","changeChannelName","title","GROUP_CHANNEL_SETTINGS","DIALOG_CHANGE_NAME_PROMPT_TITLE","submitLabel","DIALOG_CHANGE_NAME_PROMPT_OK","placeholder","DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER","defaultValue","name","onSubmit","channelName","changeChannelImage","DIALOG_CHANGE_IMAGE_MENU_TITLE","menuItems","DIALOG_CHANGE_IMAGE_MENU_CAMERA","onPress","file","openCamera","mediaType","onOpenFailure","error","code","CODE","ERR_PERMISSIONS_DENIED","DIALOG","ALERT_PERMISSIONS_TITLE","message","ALERT_PERMISSIONS_MESSAGE","LABELS","PERMISSION_CAMERA","PERMISSION_APP_NAME","buttons","text","ALERT_PERMISSIONS_OK","openSettings","show","TOAST","OPEN_CAMERA_ERROR","coverImage","DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY","files","openMediaLibrary","selectionLimit","PERMISSION_DEVICE_STORAGE","OPEN_PHOTO_LIBRARY_ERROR","sheetItems","DIALOG_CHANGE_NAME","DIALOG_CHANGE_IMAGE","HEADER_TITLE","HEADER_RIGHT"],"sources":["moduleContext.tsx"],"sourcesContent":["import React, { createContext, useCallback } from 'react';\n\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu, useAlert, useBottomSheet, usePrompt, useToast } from '@sendbird/uikit-react-native-foundation';\nimport {\n  NOOP,\n  SendbirdBaseChannel,\n  SendbirdGroupChannel,\n  SendbirdGroupChannelUpdateParams,\n  isDifferentChannel,\n  useForceUpdate,\n  useUniqId,\n} from '@sendbird/uikit-utils';\n\nimport ProviderLayout from '../../../components/ProviderLayout';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../../hooks/useContext';\nimport SBUError from '../../../libs/SBUError';\nimport SBUUtils from '../../../libs/SBUUtils';\nimport type { GroupChannelSettingsContextsType, GroupChannelSettingsModule } from '../types';\n\nexport const GroupChannelSettingsContexts: GroupChannelSettingsContextsType = {\n  Fragment: createContext({\n    channel: {} as SendbirdGroupChannel,\n    headerTitle: '',\n    headerRight: '',\n    onPressHeaderRight: NOOP,\n  }),\n};\n\nconst HOOK_NAME = 'GroupChannelSettingsContextsProvider';\nexport const GroupChannelSettingsContextsProvider: GroupChannelSettingsModule['Provider'] = ({ children, channel }) => {\n  const uniqId = useUniqId(HOOK_NAME);\n  const forceUpdate = useForceUpdate();\n  const { STRINGS } = useLocalization();\n  const { sdk } = useSendbirdChat();\n  const { fileService } = usePlatformService();\n  const { alert } = useAlert();\n\n  const onChannelChanged = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel)) return;\n    forceUpdate();\n  };\n\n  useChannelHandler(sdk, `${HOOK_NAME}_${uniqId}`, {\n    onChannelChanged: onChannelChanged,\n    onChannelFrozen: onChannelChanged,\n    onChannelUnfrozen: onChannelChanged,\n    onUserBanned: onChannelChanged,\n  });\n\n  const toast = useToast();\n  const { openSheet } = useBottomSheet();\n  const { openPrompt } = usePrompt();\n  const { openMenu } = useActionMenu();\n\n  const updateChannel = useCallback(\n    async (params: SendbirdGroupChannelUpdateParams) => {\n      await channel.updateChannel(params);\n      forceUpdate();\n    },\n    [channel],\n  );\n\n  const changeChannelName = useCallback(() => {\n    openPrompt({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_TITLE,\n      submitLabel: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_OK,\n      placeholder: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER,\n      defaultValue: channel.name,\n      onSubmit: (channelName) => updateChannel({ name: channelName }),\n    });\n  }, [STRINGS, updateChannel, channel.name]);\n\n  const changeChannelImage = useCallback(() => {\n    openMenu({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_TITLE,\n      menuItems: [\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_CAMERA,\n          onPress: async () => {\n            const file = await fileService.openCamera({\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_CAMERA,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_CAMERA_ERROR, 'error');\n                }\n              },\n            });\n            if (!file) return;\n\n            await updateChannel({ coverImage: file });\n          },\n        },\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY,\n          onPress: async () => {\n            const files = await fileService.openMediaLibrary({\n              selectionLimit: 1,\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_PHOTO_LIBRARY_ERROR, 'error');\n                }\n              },\n            });\n            if (!files || !files[0]) return;\n\n            await updateChannel({ coverImage: files[0] });\n          },\n        },\n      ],\n    });\n  }, [STRINGS, updateChannel]);\n\n  const onPressHeaderRight = useCallback(() => {\n    openSheet({\n      sheetItems: [\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME, onPress: changeChannelName },\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE, onPress: changeChannelImage },\n      ],\n    });\n  }, [STRINGS, changeChannelImage, changeChannelName]);\n\n  return (\n    <ProviderLayout>\n      <GroupChannelSettingsContexts.Fragment.Provider\n        value={{\n          channel,\n          headerTitle: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_TITLE,\n          headerRight: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_RIGHT,\n          onPressHeaderRight,\n        }}\n      >\n        {children}\n      </GroupChannelSettingsContexts.Fragment.Provider>\n    </ProviderLayout>\n  );\n};\n"],"mappings":"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"}