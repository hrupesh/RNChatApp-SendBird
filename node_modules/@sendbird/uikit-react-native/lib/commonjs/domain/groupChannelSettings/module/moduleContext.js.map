{"version":3,"names":["GroupChannelSettingsContexts","Fragment","createContext","channel","headerTitle","headerRight","onPressHeaderRight","NOOP","HOOK_NAME","GroupChannelSettingsContextsProvider","children","uniqId","useUniqId","forceUpdate","useForceUpdate","STRINGS","useLocalization","sdk","useSendbirdChat","fileService","usePlatformService","alert","useAlert","onChannelChanged","eventChannel","isDifferentChannel","useChannelHandler","onChannelFrozen","onChannelUnfrozen","onUserBanned","toast","useToast","openSheet","useBottomSheet","openPrompt","usePrompt","openMenu","useActionMenu","updateChannel","useCallback","params","changeChannelName","title","GROUP_CHANNEL_SETTINGS","DIALOG_CHANGE_NAME_PROMPT_TITLE","submitLabel","DIALOG_CHANGE_NAME_PROMPT_OK","placeholder","DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER","defaultValue","name","onSubmit","channelName","changeChannelImage","DIALOG_CHANGE_IMAGE_MENU_TITLE","menuItems","DIALOG_CHANGE_IMAGE_MENU_CAMERA","onPress","file","openCamera","mediaType","onOpenFailure","error","code","SBUError","CODE","ERR_PERMISSIONS_DENIED","DIALOG","ALERT_PERMISSIONS_TITLE","message","ALERT_PERMISSIONS_MESSAGE","LABELS","PERMISSION_CAMERA","PERMISSION_APP_NAME","buttons","text","ALERT_PERMISSIONS_OK","SBUUtils","openSettings","show","TOAST","OPEN_CAMERA_ERROR","coverImage","DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY","files","openMediaLibrary","selectionLimit","PERMISSION_DEVICE_STORAGE","OPEN_PHOTO_LIBRARY_ERROR","sheetItems","DIALOG_CHANGE_NAME","DIALOG_CHANGE_IMAGE","HEADER_TITLE","HEADER_RIGHT"],"sources":["moduleContext.tsx"],"sourcesContent":["import React, { createContext, useCallback } from 'react';\n\nimport { useChannelHandler } from '@sendbird/uikit-chat-hooks';\nimport { useActionMenu, useAlert, useBottomSheet, usePrompt, useToast } from '@sendbird/uikit-react-native-foundation';\nimport {\n  NOOP,\n  SendbirdBaseChannel,\n  SendbirdGroupChannel,\n  SendbirdGroupChannelUpdateParams,\n  isDifferentChannel,\n  useForceUpdate,\n  useUniqId,\n} from '@sendbird/uikit-utils';\n\nimport ProviderLayout from '../../../components/ProviderLayout';\nimport { useLocalization, usePlatformService, useSendbirdChat } from '../../../hooks/useContext';\nimport SBUError from '../../../libs/SBUError';\nimport SBUUtils from '../../../libs/SBUUtils';\nimport type { GroupChannelSettingsContextsType, GroupChannelSettingsModule } from '../types';\n\nexport const GroupChannelSettingsContexts: GroupChannelSettingsContextsType = {\n  Fragment: createContext({\n    channel: {} as SendbirdGroupChannel,\n    headerTitle: '',\n    headerRight: '',\n    onPressHeaderRight: NOOP,\n  }),\n};\n\nconst HOOK_NAME = 'GroupChannelSettingsContextsProvider';\nexport const GroupChannelSettingsContextsProvider: GroupChannelSettingsModule['Provider'] = ({ children, channel }) => {\n  const uniqId = useUniqId(HOOK_NAME);\n  const forceUpdate = useForceUpdate();\n  const { STRINGS } = useLocalization();\n  const { sdk } = useSendbirdChat();\n  const { fileService } = usePlatformService();\n  const { alert } = useAlert();\n\n  const onChannelChanged = (eventChannel: SendbirdBaseChannel) => {\n    if (isDifferentChannel(eventChannel, channel)) return;\n    forceUpdate();\n  };\n\n  useChannelHandler(sdk, `${HOOK_NAME}_${uniqId}`, {\n    onChannelChanged: onChannelChanged,\n    onChannelFrozen: onChannelChanged,\n    onChannelUnfrozen: onChannelChanged,\n    onUserBanned: onChannelChanged,\n  });\n\n  const toast = useToast();\n  const { openSheet } = useBottomSheet();\n  const { openPrompt } = usePrompt();\n  const { openMenu } = useActionMenu();\n\n  const updateChannel = useCallback(\n    async (params: SendbirdGroupChannelUpdateParams) => {\n      await channel.updateChannel(params);\n      forceUpdate();\n    },\n    [channel],\n  );\n\n  const changeChannelName = useCallback(() => {\n    openPrompt({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_TITLE,\n      submitLabel: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_OK,\n      placeholder: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME_PROMPT_PLACEHOLDER,\n      defaultValue: channel.name,\n      onSubmit: (channelName) => updateChannel({ name: channelName }),\n    });\n  }, [STRINGS, updateChannel, channel.name]);\n\n  const changeChannelImage = useCallback(() => {\n    openMenu({\n      title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_TITLE,\n      menuItems: [\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_CAMERA,\n          onPress: async () => {\n            const file = await fileService.openCamera({\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_CAMERA,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_CAMERA_ERROR, 'error');\n                }\n              },\n            });\n            if (!file) return;\n\n            await updateChannel({ coverImage: file });\n          },\n        },\n        {\n          title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE_MENU_PHOTO_LIBRARY,\n          onPress: async () => {\n            const files = await fileService.openMediaLibrary({\n              selectionLimit: 1,\n              mediaType: 'photo',\n              onOpenFailure: (error) => {\n                if (error.code === SBUError.CODE.ERR_PERMISSIONS_DENIED) {\n                  alert({\n                    title: STRINGS.DIALOG.ALERT_PERMISSIONS_TITLE,\n                    message: STRINGS.DIALOG.ALERT_PERMISSIONS_MESSAGE(\n                      STRINGS.LABELS.PERMISSION_DEVICE_STORAGE,\n                      STRINGS.LABELS.PERMISSION_APP_NAME,\n                    ),\n                    buttons: [{ text: STRINGS.DIALOG.ALERT_PERMISSIONS_OK, onPress: () => SBUUtils.openSettings() }],\n                  });\n                } else {\n                  toast.show(STRINGS.TOAST.OPEN_PHOTO_LIBRARY_ERROR, 'error');\n                }\n              },\n            });\n            if (!files || !files[0]) return;\n\n            await updateChannel({ coverImage: files[0] });\n          },\n        },\n      ],\n    });\n  }, [STRINGS, updateChannel]);\n\n  const onPressHeaderRight = useCallback(() => {\n    openSheet({\n      sheetItems: [\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_NAME, onPress: changeChannelName },\n        { title: STRINGS.GROUP_CHANNEL_SETTINGS.DIALOG_CHANGE_IMAGE, onPress: changeChannelImage },\n      ],\n    });\n  }, [STRINGS, changeChannelImage, changeChannelName]);\n\n  return (\n    <ProviderLayout>\n      <GroupChannelSettingsContexts.Fragment.Provider\n        value={{\n          channel,\n          headerTitle: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_TITLE,\n          headerRight: STRINGS.GROUP_CHANNEL_SETTINGS.HEADER_RIGHT,\n          onPressHeaderRight,\n        }}\n      >\n        {children}\n      </GroupChannelSettingsContexts.Fragment.Provider>\n    </ProviderLayout>\n  );\n};\n"],"mappings":"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"}