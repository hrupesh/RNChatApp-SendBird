{"version":3,"names":["WARN_onCreateChannel","UserProfileContext","React","createContext","UserProfileProvider","children","onCreateChannel","onBeforeCreateChannel","PASS","chatContext","useContext","SendbirdChatContext","localizationContext","LocalizationContext","Error","__DEV__","Logger","warn","bottom","left","right","useSafeAreaInsets","user","setUser","useState","visible","setVisible","show","useCallback","hide","userProfileButton","useIIFE","isMe","currentUser","userId","undefined","onPressMessageButton","params","invitedUserIds","name","coverUrl","isDistinct","operatorUserIds","processedParams","channel","sdk","groupChannel","createChannel","STRINGS","PROFILE_CARD","BUTTON_MESSAGE","Boolean","styles","modal","profileCardContainer","paddingLeft","paddingRight","paddingBottom","profileUrl","nickname","LABELS","USER_NO_NAME","BODY_LABEL","BODY","createStyleSheet","justifyContent","borderTopLeftRadius","borderTopRightRadius"],"sources":["UserProfileCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useState } from 'react';\nimport { useSafeAreaInsets } from 'react-native-safe-area-context';\n\nimport { Modal, OutlinedButton, ProfileCard, createStyleSheet } from '@sendbird/uikit-react-native-foundation';\nimport type {\n  SendbirdGroupChannel,\n  SendbirdGroupChannelCreateParams,\n  SendbirdMember,\n  SendbirdUser,\n} from '@sendbird/uikit-utils';\nimport { Logger, PASS, useIIFE } from '@sendbird/uikit-utils';\n\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\n\ntype OnCreateChannel = (channel: SendbirdGroupChannel) => void;\ntype OnBeforeCreateChannel = (\n  channelParams: SendbirdGroupChannelCreateParams,\n  users: SendbirdUser[] | SendbirdMember[],\n) => SendbirdGroupChannelCreateParams | Promise<SendbirdGroupChannelCreateParams>;\n\nexport type UserProfileContextType = {\n  show(user: SendbirdUser | SendbirdMember): void;\n  hide(): void;\n};\n\ntype Props = React.PropsWithChildren<{\n  onCreateChannel?: OnCreateChannel;\n  onBeforeCreateChannel?: OnBeforeCreateChannel;\n}>;\n\nlet WARN_onCreateChannel = false;\n\nexport const UserProfileContext = React.createContext<UserProfileContextType | null>(null);\nexport const UserProfileProvider = ({ children, onCreateChannel, onBeforeCreateChannel = PASS }: Props) => {\n  const chatContext = useContext(SendbirdChatContext);\n  const localizationContext = useContext(LocalizationContext);\n\n  if (!chatContext) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationContext) throw new Error('LocalizationContext is not provided');\n\n  if (__DEV__ && !WARN_onCreateChannel && !onCreateChannel) {\n    Logger.warn(\n      'You should pass `userProfile.onCreateChannel` prop to SendbirdUIKitContainer if want to use message in a user profile',\n    );\n    WARN_onCreateChannel = true;\n  }\n\n  const { bottom, left, right } = useSafeAreaInsets();\n\n  const [user, setUser] = useState<SendbirdUser | SendbirdMember>();\n  const [visible, setVisible] = useState(false);\n\n  const show: UserProfileContextType['show'] = useCallback((user) => {\n    setUser(user);\n    setVisible(true);\n  }, []);\n\n  const hide: UserProfileContextType['hide'] = useCallback(() => {\n    setVisible(false);\n  }, []);\n\n  const userProfileButton = useIIFE(() => {\n    const isMe = chatContext.currentUser && user?.userId === chatContext.currentUser.userId;\n    if (isMe) return undefined;\n\n    const onPressMessageButton = async () => {\n      if (user) {\n        const params: SendbirdGroupChannelCreateParams = {\n          invitedUserIds: [user.userId],\n          name: '',\n          coverUrl: '',\n          isDistinct: false,\n        };\n\n        if (chatContext.currentUser) params.operatorUserIds = [chatContext.currentUser.userId];\n        const processedParams = await onBeforeCreateChannel(params, [user]);\n\n        hide();\n        const channel = await chatContext.sdk.groupChannel.createChannel(processedParams);\n\n        if (onCreateChannel) {\n          onCreateChannel(channel);\n        } else {\n          Logger.warn(\n            'Please set `onCreateChannel` before message to user from profile card, see `userProfile` prop in the `SendbirdUIKitContainer` props',\n          );\n        }\n      }\n    };\n\n    return (\n      <OutlinedButton onPress={onPressMessageButton}>\n        {localizationContext.STRINGS.PROFILE_CARD.BUTTON_MESSAGE}\n      </OutlinedButton>\n    );\n  });\n\n  return (\n    <UserProfileContext.Provider value={{ show, hide }}>\n      {children}\n      <Modal\n        type={'slide'}\n        onClose={hide}\n        onDismiss={() => setUser(undefined)}\n        visible={visible && Boolean(user)}\n        backgroundStyle={styles.modal}\n      >\n        {user && (\n          <ProfileCard\n            containerStyle={[\n              styles.profileCardContainer,\n              { paddingLeft: left, paddingRight: right, paddingBottom: bottom },\n            ]}\n            uri={user.profileUrl}\n            username={user.nickname || localizationContext.STRINGS.LABELS.USER_NO_NAME}\n            bodyLabel={localizationContext.STRINGS.PROFILE_CARD.BODY_LABEL}\n            body={localizationContext.STRINGS.PROFILE_CARD.BODY(user)}\n            button={userProfileButton}\n          />\n        )}\n      </Modal>\n    </UserProfileContext.Provider>\n  );\n};\n\nconst styles = createStyleSheet({\n  modal: {\n    justifyContent: 'flex-end',\n  },\n  profileCardContainer: {\n    borderTopLeftRadius: 8,\n    borderTopRightRadius: 8,\n  },\n});\n"],"mappings":"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"}