{"version":3,"names":["ReactionContext","React","createContext","ReactionProvider","children","chatCtx","useContext","SendbirdChatContext","localizationCtx","LocalizationContext","userProfileCtx","UserProfileContext","Error","state","setState","useReducer","prev","next","reactionListVisible","setReactionListVisible","useState","reactionUserListVisible","setReactionUserListVisible","reactionUserListFocusIndex","setReactionUserListFocusIndex","closeResolver","useRef","NOOP","openReactionList","useCallback","params","openReactionUserList","channel","message","focusIndex","updateReactionFocusedItem","createOnCloseWithResolver","callback","Promise","resolve","current","reactionCtx","sheetProps","onDismiss"],"sources":["ReactionCtx.tsx"],"sourcesContent":["import React, { useCallback, useContext, useReducer, useRef, useState } from 'react';\n\nimport type { SendbirdBaseChannel, SendbirdBaseMessage } from '@sendbird/uikit-utils';\nimport { NOOP } from '@sendbird/uikit-utils';\n\nimport { ReactionBottomSheets } from '../components/ReactionBottomSheets';\nimport { LocalizationContext } from '../contexts/LocalizationCtx';\nimport { SendbirdChatContext } from '../contexts/SendbirdChatCtx';\nimport { UserProfileContext } from '../contexts/UserProfileCtx';\n\ntype State = {\n  message?: SendbirdBaseMessage;\n  channel?: SendbirdBaseChannel;\n};\nexport type ReactionContextType = {\n  openReactionList(param: Required<State>): void;\n  openReactionUserList(param: Required<State> & { focusIndex?: number }): void;\n  updateReactionFocusedItem(param?: State): void;\n  focusIndex: number;\n} & State;\n\ntype Props = React.PropsWithChildren<{}>;\n\nexport const ReactionContext = React.createContext<ReactionContextType | null>(null);\nexport const ReactionProvider = ({ children }: Props) => {\n  const chatCtx = useContext(SendbirdChatContext);\n  const localizationCtx = useContext(LocalizationContext);\n  const userProfileCtx = useContext(UserProfileContext);\n  if (!chatCtx) throw new Error('SendbirdChatContext is not provided');\n  if (!localizationCtx) throw new Error('LocalizationContext is not provided');\n  if (!userProfileCtx) throw new Error('UserProfileContext is not provided');\n\n  const [state, setState] = useReducer((prev: State, next: State) => ({ ...prev, ...next }), {});\n  const [reactionListVisible, setReactionListVisible] = useState(false);\n  const [reactionUserListVisible, setReactionUserListVisible] = useState(false);\n  const [reactionUserListFocusIndex, setReactionUserListFocusIndex] = useState(0);\n\n  const closeResolver = useRef<() => void>(NOOP);\n\n  const openReactionList: ReactionContextType['openReactionList'] = useCallback((params) => {\n    setState(params);\n    setReactionListVisible(true);\n  }, []);\n\n  const openReactionUserList: ReactionContextType['openReactionUserList'] = useCallback(\n    ({ channel, message, focusIndex = 0 }) => {\n      setState({ channel, message });\n      setReactionUserListFocusIndex(focusIndex);\n      setReactionUserListVisible(true);\n    },\n    [],\n  );\n\n  const updateReactionFocusedItem: ReactionContextType['updateReactionFocusedItem'] = useCallback((params) => {\n    if (params) setState(params);\n    else setState({});\n  }, []);\n\n  const createOnCloseWithResolver = (callback: () => void) => {\n    return () => {\n      return new Promise<void>((resolve) => {\n        closeResolver.current = resolve;\n        callback();\n      });\n    };\n  };\n\n  const reactionCtx = {\n    ...state,\n    openReactionList,\n    openReactionUserList,\n    updateReactionFocusedItem,\n    focusIndex: reactionUserListFocusIndex,\n  };\n\n  const sheetProps = {\n    chatCtx,\n    reactionCtx,\n    localizationCtx,\n    userProfileCtx,\n    onDismiss: () => {\n      setState({});\n      closeResolver.current?.();\n    },\n  };\n\n  return (\n    <ReactionContext.Provider value={reactionCtx}>\n      {children}\n      <ReactionBottomSheets.UserList\n        {...sheetProps}\n        visible={reactionUserListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionUserListVisible(false))}\n      />\n      <ReactionBottomSheets.ReactionList\n        {...sheetProps}\n        visible={reactionListVisible}\n        onClose={createOnCloseWithResolver(() => setReactionListVisible(false))}\n      />\n    </ReactionContext.Provider>\n  );\n};\n"],"mappings":"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"}